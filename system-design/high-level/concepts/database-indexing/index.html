
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://abhishekghoshh.github.io/system-design-helper/system-design/high-level/concepts/database-indexing/">
      
      
        <link rel="prev" href="../cqrs/">
      
      
        <link rel="next" href="../distributed-caches-and-caching-strategies/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Database Indexing - System Design Helper</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="Database Indexing - System Design Helper" />
<meta property="og:image" content="https://abhishekghoshh.github.io/system-design-helper/assets/images/social/system-design/high-level/concepts/database-indexing.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://abhishekghoshh.github.io/system-design-helper/system-design/high-level/concepts/database-indexing/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="Database Indexing - System Design Helper" />
<meta property="twitter:image" content="https://abhishekghoshh.github.io/system-design-helper/assets/images/social/system-design/high-level/concepts/database-indexing.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dbms-indexing-to-improve-search-query-performance" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="System Design Helper" class="md-header__button md-logo" aria-label="System Design Helper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            System Design Helper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Database Indexing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../ai-tools/" class="md-tabs__link">
        
  
  
    
  
  AI Tools

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../behavioural/" class="md-tabs__link">
        
  
  
    
  
  Behavioural

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../developer-experiences/" class="md-tabs__link">
        
  
  
    
  
  Developer Experiences

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../open-source-tools/" class="md-tabs__link">
        
  
  
    
  
  Open Source Tools

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../software-architect/" class="md-tabs__link">
        
  
  
    
  
  Software Architect

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../wisdom/" class="md-tabs__link">
        
  
  
    
  
  Wisdom

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../ai/ai/" class="md-tabs__link">
          
  
  
  AI

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../devops/" class="md-tabs__link">
          
  
  
  DevOps

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../security/introduction/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../courses/" class="md-tabs__link">
          
  
  
  System Design

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="System Design Helper" class="md-nav__button md-logo" aria-label="System Design Helper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    System Design Helper
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Tools
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../behavioural/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Behavioural
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer-experiences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Experiences
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../open-source-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Open Source Tools
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../software-architect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Architect
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../wisdom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wisdom
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/ai-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/gen-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gen AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/langchain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangChain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/langgraph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangGraph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/MCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ai/RAG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DevOps
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    DevOps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/authentication-and-authorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication & Authorization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/oauth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OAuth
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/rbac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RBAC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SSO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/ssl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SSL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/devsecops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DevSecOps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/firewall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Firewall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Certificate
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Certificate
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/certificate/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/certificate/certificate-authority/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Certificate Authority
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/certificate/client-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client Certificates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/certificate/server-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Server Certificates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/certificate/self-signed-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Signed Certificates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/certificate/links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Links
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reverse Proxy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reverse Proxy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/reverse-proxy/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/reverse-proxy/haproxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HAProxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../security/reverse-proxy/nginx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nginx
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    System Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    System Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Courses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" checked>
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    High Level Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    High Level Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_11_2_2" id="__nav_11_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adaptive-bitrate-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adaptive Bitrate Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../asynchronus-communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asynchronous Communication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../back-of-envelope-calculation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Back of Envelope Calculation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bloom-filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bloom Filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cap-theorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CAP Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CDC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cdn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CDN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../clean-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clean Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../code-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../consistent-hashing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Consistent Hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cqrs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CQRS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Database Indexing
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Indexing
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#youtube" class="md-nav__link">
    <span class="md-ellipsis">
      
        Youtube
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#theory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Theory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-database-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is Database Indexing?
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#question-1-how-is-table-data-rows-actually-stored" class="md-nav__link">
    <span class="md-ellipsis">
      
        Question 1: How is Table Data (Rows) Actually Stored?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 1: How is Table Data (Rows) Actually Stored?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#answer" class="md-nav__link">
    <span class="md-ellipsis">
      
        Answer:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-pages-database-pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Pages (Database Pages)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#row-offset-array-why-its-critical" class="md-nav__link">
    <span class="md-ellipsis">
      
        Row Offset Array: Why It's Critical
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Blocks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-storage-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Storage Hierarchy
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#question-2-what-types-of-indexing-are-present" class="md-nav__link">
    <span class="md-ellipsis">
      
        Question 2: What Types of Indexing are Present?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 2: What Types of Indexing are Present?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#answer_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Answer:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      
        What is Indexing?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advantages-of-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advantages of Indexing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disadvantages-of-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Disadvantages of Indexing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#types-of-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Types of Indexes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Types of Indexes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-clustered-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Clustered Index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-non-clustered-index-secondary-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Non-Clustered Index (Secondary Index)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clustered-vs-non-clustered-index-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clustered vs Non-Clustered Index Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-index-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other Index Types
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Other Index Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-unique-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Unique Index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-composite-index-multi-column-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Composite Index (Multi-Column Index)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-covering-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Covering Index
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-filtered-index-partial-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Filtered Index (Partial Index)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-full-text-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Full-Text Index
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#question-3-understanding-data-structures-used-for-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Question 3: Understanding Data Structures Used for Indexing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Question 3: Understanding Data Structures Used for Indexing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#answer_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Answer:
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-b-trees-and-b-trees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why B-Trees and B+ Trees?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tree-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        B-Tree Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tree-structure_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        B+ Tree Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-tree-vs-b-tree-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        B-Tree vs B+ Tree Comparison
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-databases-prefer-b-trees" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Databases Prefer B+ Trees
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-implementation-complete-production-ready-code" class="md-nav__link">
    <span class="md-ellipsis">
      
        C Implementation (Complete Production-Ready Code)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="C Implementation (Complete Production-Ready Code)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-b-tree-implementation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete B-Tree Implementation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-b-tree-implementation_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete B+ Tree Implementation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advantages-and-disadvantages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advantages and Disadvantages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#additional-important-questions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Additional Important Questions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Additional Important Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#q4-when-should-you-create-an-index" class="md-nav__link">
    <span class="md-ellipsis">
      
        Q4: When Should You Create an Index?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q5-how-does-the-query-optimizer-use-indexes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Q5: How Does the Query Optimizer Use Indexes?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q6-what-is-index-fragmentation-and-maintenance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Q6: What is Index Fragmentation and Maintenance?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../distributed-caches-and-caching-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Caches & Caching Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ditributed-transaction-and-concurrency-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Transaction & Concurrency Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../event-sourcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Sourcing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hashing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../load-balancer-and-proxy-server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Load Balancer & Proxy Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microservices-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microservices Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../passwords/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Passwords
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../raft-consensus-algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Raft Consensus Algorithm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../restfull-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RESTful Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    S3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scaling-to-one-million/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaling to One Million
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sockets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sockets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../webrtc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WebRTC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2_3" >
        
          
          <label class="md-nav__link" for="__nav_11_2_3" id="__nav_11_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Designing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Designing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/app-store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/authentication-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/chat-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chat System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/chess-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chess Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/data-warehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Warehouse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/distributed-geospatial-data-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Geospatial Data Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/distributed-messaging-queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Messaging Queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/dns-server.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/e-commerce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Commerce
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/ecommerce-checkout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Commerce Checkout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/email-automation-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Email Automation Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/food-delivery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Food Delivery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/google-drive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Google Drive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/hashtag-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hashtag Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/how-to-host-your-own-x/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to Host Your Own X
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/Image-Optimisation-on-the-fly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image Optimisation On The Fly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/key-value-store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Key Value Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/large-language-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Large Language Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/leetcode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LeetCode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/live-comments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Live Comments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/log-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Log System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/multiplayer-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiplayer Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/netflix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Netflix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/notification-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notification System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/products/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Products
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/rate-limiter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rate Limiter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/recomendation-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recommendation Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/redis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/search-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/social-media/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Social Media
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/spotify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spotify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/stock-broker-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stock Broker System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/tiny-url/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiny URL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/twitter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Twitter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/uber/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Uber
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/upi-payments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UPI Payments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/video-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Video Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/vpn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VPN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/webhook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Webhook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../desgining/yelp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Yelp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2_4" >
        
          
          <label class="md-nav__link" for="__nav_11_2_4" id="__nav_11_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Links
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Links
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../links/udemy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Udemy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../links/websites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Websites
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../links/youtube/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YouTube
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Low Level Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Low Level Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_2" >
        
          
          <label class="md-nav__link" for="__nav_11_3_2" id="__nav_11_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/concepts/hashmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HashMap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/concepts/solid-principles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID Principles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/concepts/technical-debt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Technical Debt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3_3" id="__nav_11_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Design Patterns
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Design Patterns
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/design-pattern/design-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_11_3_3_2" id="__nav_11_3_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Others
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_11_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Others
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/design-pattern/others/null-object-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Null Object Pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_4" >
        
          
          <label class="md-nav__link" for="__nav_11_3_4" id="__nav_11_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Designing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Designing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/access-management-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Access Management System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/account-balance-tracker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Account Balance Tracker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/air-traffic-controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Air Traffic Controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/atm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ATM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/cache-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cache System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/car-rental-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Car Rental Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/chess-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chess Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/elevator-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Elevator System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/locker-allocation-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Locker Allocation System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/parking-lot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parking Lot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/snake-and-ladder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snake and Ladder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/stock-exchange-book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stock Exchange Book
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/tic-tac-toe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tic Tac Toe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../low-level/designing/vending-machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vending Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="dbms-indexing-to-improve-search-query-performance">DBMS Indexing to improve search query performance</h1>
<h2 id="youtube">Youtube</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=6ZquiVH8AGU">21. Database Indexing: How DBMS Indexing done to improve search query performance? Explained</a></li>
</ul>
<h2 id="theory">Theory</h2>
<h3 id="what-is-database-indexing">What is Database Indexing?</h3>
<p><strong>Database indexing</strong> is a data structure technique used to quickly locate and access data in a database without scanning every row. An index creates a separate data structure (usually a B-Tree or B+ Tree) that stores a subset of columns with pointers to the actual rows, dramatically improving query performance.</p>
<p><strong>Analogy</strong>: Think of an index like the index at the back of a textbook. Instead of flipping through every page to find a topic, you look it up in the index which tells you exactly which page to go to.</p>
<p><strong>Key Benefits:</strong>
-  <strong>Faster Query Performance</strong>: Reduces query time from O(n) to O(log n)
-  <strong>Efficient Data Retrieval</strong>: Avoids full table scans
-  <strong>Better Sort Performance</strong>: Pre-sorted index structure
-  <strong>Optimized Searches</strong>: Especially for WHERE, JOIN, ORDER BY clauses</p>
<p><strong>Trade-offs:</strong>
-  <strong>Extra Storage</strong>: Indexes consume additional disk space
-  <strong>Slower Writes</strong>: INSERT, UPDATE, DELETE operations must update indexes
-  <strong>Maintenance Overhead</strong>: Indexes need to be rebuilt/reorganized periodically</p>
<hr />
<h2 id="question-1-how-is-table-data-rows-actually-stored">Question 1: How is Table Data (Rows) Actually Stored?</h2>
<h3 id="answer">Answer:</h3>
<p>Database tables store data in fixed-size blocks called <strong>pages</strong> or <strong>blocks</strong>. Understanding this storage mechanism is crucial for understanding how indexing improves performance.</p>
<h3 id="data-pages-database-pages">Data Pages (Database Pages)</h3>
<p><strong>What are Data Pages?</strong></p>
<p>A <strong>data page</strong> (also called a database page or disk page) is the smallest unit of storage that a database management system uses to read from or write to disk. It's a fixed-size block of contiguous memory, typically 4KB, 8KB, or 16KB depending on the database system.</p>
<p><strong>Page Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>                    DATA PAGE (8KB)                      
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>  Page Header (96 bytes)                                 
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>       
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>   Page ID: 1001                                      
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>   Page Type: DATA_PAGE                               
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>   Previous Page: 1000                                
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>   Next Page: 1002                                    
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>   Free Space Start: 7800                             
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>   Free Space End: 8000                               
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>   Number of Records: 45                              
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>   Checksum: 0xABCD1234                               
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>   LSN (Log Sequence Number): 12345678                
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>       
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>  Row Offset Array (90 bytes)                            
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>       
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>   Offset[0]: 200   (points to first row)            
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>   Offset[1]: 350   (points to second row)           
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>   Offset[2]: 520   (points to third row)            
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>   ...                                                
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>   Offset[44]: 7650 (points to 45th row)             
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>       
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>                                                          
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>  WHY OFFSET ARRAY IS NEEDED:                            
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>   Variable-length rows: Rows can be different sizes    
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>   Direct access: Jump to any row without scanning      
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>   Update efficiency: Relocate rows without affecting   
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    other rows&#39; positions                                
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>   Deletion handling: Mark slots as deleted, reuse      
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    space without shifting all rows                      
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>                                                          
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>  Data Records (7814 bytes)                              
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>       
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>   Record 1: [id=1, name=&#39;John&#39;, age=30, ...]         
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>   Record 2: [id=2, name=&#39;Jane&#39;, age=25, ...]         
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>   Record 3: [id=3, name=&#39;Bob&#39;, age=35, ...]          
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>   ...                                                
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>   Record 45: [id=45, name=&#39;Alice&#39;, ...]              
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>       
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>  Free Space (200 bytes)                                 
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>  [Available for new records or updates]                 
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>
</code></pre></div>
<p><strong>Page Header Components (Detailed):</strong></p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Page ID</strong></td>
<td>4 bytes</td>
<td>Unique identifier for this page</td>
</tr>
<tr>
<td><strong>Page Type</strong></td>
<td>1 byte</td>
<td>Type: DATA_PAGE, INDEX_PAGE, etc.</td>
</tr>
<tr>
<td><strong>Previous Page</strong></td>
<td>4 bytes</td>
<td>Pointer to previous page (doubly-linked list)</td>
</tr>
<tr>
<td><strong>Next Page</strong></td>
<td>4 bytes</td>
<td>Pointer to next page</td>
</tr>
<tr>
<td><strong>Free Space Start</strong></td>
<td>2 bytes</td>
<td>Byte offset where free space begins</td>
</tr>
<tr>
<td><strong>Free Space End</strong></td>
<td>2 bytes</td>
<td>Byte offset where free space ends</td>
</tr>
<tr>
<td><strong>Number of Records</strong></td>
<td>2 bytes</td>
<td>Count of records in this page</td>
</tr>
<tr>
<td><strong>Checksum</strong></td>
<td>4 bytes</td>
<td>For data integrity verification</td>
</tr>
<tr>
<td><strong>LSN</strong></td>
<td>8 bytes</td>
<td>Log Sequence Number (for recovery)</td>
</tr>
<tr>
<td><strong>Page Level</strong></td>
<td>2 bytes</td>
<td>Level in B-Tree (0 for leaf)</td>
</tr>
<tr>
<td><strong>Flags</strong></td>
<td>2 bytes</td>
<td>Status flags (dirty, compressed, etc.)</td>
</tr>
<tr>
<td><strong>Reserved</strong></td>
<td>~60 bytes</td>
<td>Database-specific metadata</td>
</tr>
</tbody>
</table>
<p><strong>Who Controls Data Pages?</strong></p>
<p>The <strong>Buffer Manager</strong> (part of the database storage engine) controls data pages:
- Manages page cache (buffer pool) in memory
- Handles page reads from disk
- Handles page writes to disk
- Implements page replacement algorithms (LRU, Clock)
- Ensures page consistency and integrity</p>
<h3 id="row-offset-array-why-its-critical">Row Offset Array: Why It's Critical</h3>
<p><strong>The Problem: Variable-Length Rows</strong></p>
<p>Database rows are <strong>not fixed-size</strong> because of:
- VARCHAR columns (variable-length strings)
- NULL values (may occupy no space)
- TEXT/BLOB columns
- Different character encodings (UTF-8 can use 1-4 bytes per character)</p>
<p><strong>Example Problem Without Offset Array:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Fixed-size approach (DOESN&#39;T WORK):
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a> Row 1 (150 bytes) | Row 2 (80 bytes)   
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a> Row 3 (200 bytes) | ...                
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a> Problem: How to find Row 3 quickly?
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>   - Can&#39;t calculate: Position = row_number  row_size
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>   - Must scan: Row 1  Row 2  Row 3
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>   - O(n) time to access any row!
</code></pre></div>
<p><strong>Solution: Row Offset Array</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>With Offset Array:
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a> Header                                  
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>                 
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  Offset[0] = 200        Points to Row 1 at byte 200
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>  Offset[1] = 350        Points to Row 2 at byte 350
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>  Offset[2] = 430        Points to Row 3 at byte 430
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>  Offset[3] = 630        Points to Row 4 at byte 630
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>                 
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>                                          
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a> Data Area:                               
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a> [byte 200] Row 1 (150 bytes)            
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a> [byte 350] Row 2 (80 bytes)             
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a> [byte 430] Row 3 (200 bytes)            
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a> [byte 630] Row 4 (...)                  
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a> Advantage: Direct access to Row 3 in O(1):
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>   1. Read Offset[2] = 430
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>   2. Jump to byte 430
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>   3. Read row
</code></pre></div>
<p><strong>Why Row Offset Array is Needed:</strong></p>
<ol>
<li>
<p><strong>Variable-Length Row Support</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Without offsets: Must scan from start
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>With offsets: Direct jump to any row
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>Example with VARCHAR:
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>Row 1: id=1, name=&quot;Jo&quot; (short)
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>Row 2: id=2, name=&quot;Christopher Alexander&quot; (long)
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>Row 3: id=3, name=&quot;Li&quot; (short)
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>Offset[0] = 200  (Row 1 starts)
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>Offset[1] = 220  (Row 2 starts, 20 bytes after)
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>Offset[2] = 265  (Row 3 starts, 45 bytes after)
</code></pre></div></p>
</li>
<li>
<p><strong>Fast Random Access</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Access row #5:
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>- WITHOUT offset array: O(n) - scan rows 012345
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>- WITH offset array: O(1) - read Offset[5], jump directly
</code></pre></div></p>
</li>
<li>
<p><strong>Efficient Updates (Row Relocation)</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>UPDATE users SET name = &#39;Very Long Name Here&#39; WHERE id = 2;
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>Old Row 2: 80 bytes
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>New Row 2: 150 bytes (doesn&#39;t fit in original location!)
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>Solution:
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>1. Move Row 2 to end of page (new location)
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>2. Update Offset[1] to new location
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>3. Other rows&#39; offsets unchanged!
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a> Offset[0] = 200  (unchanged)           
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a> Offset[1] = 7800 (updated!)            
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a> Offset[2] = 430  (unchanged)           
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>No need to shift Row 3, Row 4, Row 5... in memory!
</code></pre></div></p>
</li>
<li>
<p><strong>Efficient Deletion (Slot Reuse)</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>DELETE FROM users WHERE id = 2;
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>Method 1 - WITHOUT offset array:
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>- Shift all following rows backward
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>- Expensive for large pages (thousands of bytes moved)
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>Method 2 - WITH offset array:
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>- Mark Offset[1] as NULL/deleted (-1)
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>- Don&#39;t move any data
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>- Reuse slot for future inserts
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a> Offset[0] = 200                        
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a> Offset[1] = -1     (deleted!)          
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a> Offset[2] = 430                        
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a> Offset[3] = 630                        
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>Space at old Row 2 location becomes free space!
</code></pre></div></p>
</li>
<li>
<p><strong>Maintains Row Order Without Physical Order</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Logical order (by primary key):
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>Row 0: id=1
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>Row 1: id=2
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>Row 2: id=3
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>Physical storage (after updates):
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>[byte 200] id=1 (original)
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>[byte 350] id=3 (inserted later)
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>[byte 430] id=2 (updated, relocated)
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>Offset array maintains logical order:
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>Offset[0] = 200   id=1
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>Offset[1] = 430   id=2 (points to relocated position)
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>Offset[2] = 350   id=3
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>Queries still return rows in correct order!
</code></pre></div></p>
</li>
</ol>
<p><strong>Advantages of Row Offset Array:</strong></p>
<table>
<thead>
<tr>
<th>Advantage</th>
<th>Description</th>
<th>Performance Impact</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>O(1) Row Access</strong></td>
<td>Direct jump to any row without scanning</td>
<td>100x faster for large pages</td>
</tr>
<tr>
<td><strong>No Data Movement on Update</strong></td>
<td>Just update offset pointer when row relocates</td>
<td>Saves thousands of memory copies</td>
</tr>
<tr>
<td><strong>Fast Deletion</strong></td>
<td>Mark offset as deleted, don't shift data</td>
<td>O(1) instead of O(n)</td>
</tr>
<tr>
<td><strong>Space Reuse</strong></td>
<td>Deleted slots can be reused by new inserts</td>
<td>Better space utilization</td>
</tr>
<tr>
<td><strong>Logical vs Physical Separation</strong></td>
<td>Rows can be physically scattered but logically ordered</td>
<td>Flexibility in storage</td>
</tr>
<tr>
<td><strong>Update-in-Place Optimization</strong></td>
<td>If new data fits in old location, no relocation needed</td>
<td>Minimal overhead</td>
</tr>
<tr>
<td><strong>Compact Array</strong></td>
<td>Offsets are small (2-4 bytes each)</td>
<td>Minimal space overhead (~0.1% of page)</td>
</tr>
</tbody>
</table>
<p><strong>Real-World Performance Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Scenario: Page with 100 rows, access row #87
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>WITHOUT Offset Array:
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>1. Start at byte 96 (after header)
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>2. Read row 0 length  skip row 0
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>3. Read row 1 length  skip row 1
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>...
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>87. Read row 86 length  skip row 86
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>88. Finally read row 87
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>Time: ~87 reads  10s = 870s
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>WITH Offset Array:
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>1. Read Offset[87] = 6543
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>2. Jump to byte 6543
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>3. Read row 87
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>Time: ~2 reads  10s = 20s
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>Result: 43x faster!
</code></pre></div>
<p><strong>Memory Overhead Calculation:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Page size: 8KB (8192 bytes)
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Average row size: 100 bytes
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Rows per page: ~80 rows
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>Offset Array Size:
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>- 2 bytes per offset  80 rows = 160 bytes
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>- Overhead: 160 / 8192 = 1.95% of page
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>Trade-off:
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>- Cost: ~2% storage overhead
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>- Benefit: O(n)  O(1) access, massively faster updates/deletes
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>Conclusion: Worth it! 2% overhead for 10-100x performance gain
</code></pre></div>
<p><strong>How Databases Use Offset Arrays:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>PostgreSQL:
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>- Array at start of page
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>- 4-byte offsets (ItemIdData)
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>- Format: [offset, length, flags]
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>MySQL InnoDB:
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>- &quot;Record directory&quot; at end of page
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>- 2-byte offsets
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>- Grows backward from page end
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>SQL Server:
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>- &quot;Slot array&quot; after page header
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>- 2-byte offsets
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>- Supports row versioning
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>Oracle:
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>- &quot;Row directory&quot; in page header
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>- Variable-size offsets
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>- Supports row chaining
</code></pre></div>
<h3 id="data-blocks">Data Blocks</h3>
<p><strong>What are Data Blocks?</strong></p>
<p>A <strong>data block</strong> is the physical storage unit on disk, typically managed by the operating system or file system. In many contexts, "block" and "page" are used interchangeably, but there's a subtle difference:</p>
<ul>
<li><strong>Data Block</strong>: Physical storage unit on disk (OS level)</li>
<li><strong>Data Page</strong>: Logical storage unit in database (DBMS level)</li>
</ul>
<p><strong>Data Block Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Physical Disk Layout:
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>                    DISK (Hard Drive / SSD)                  
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  Block 0    Block 1    Block 2    Block 3    Block 4   
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>  (4KB)      (4KB)      (4KB)      (4KB)      (4KB)     
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>            Database maps pages to blocks                   
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>  Page 1     Page 2     Page 3     Index      Page 5    
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>  (8KB)      (8KB)      (8KB)      Page       (8KB)     
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>  2 blocks   2 blocks   2 blocks   (8KB)      2 blocks  
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>Mapping: Database Page  Physical Blocks
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>- Page size: 8KB
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>- Block size: 4KB
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>- Each page occupies 2 contiguous blocks
</code></pre></div>
<p><strong>Who Controls Data Blocks?</strong></p>
<p>The <strong>Operating System</strong> and <strong>File System</strong> control data blocks:
- Allocates disk blocks to files
- Manages block I/O operations
- Handles block caching at OS level
- Ensures data persistence</p>
<p><strong>How Pages Map to Blocks:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>Database File: users.dbf
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a> Page 0  Blocks 0-1   (Header page)         
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a> Page 1  Blocks 2-3   (Data page)           
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a> Page 2  Blocks 4-5   (Data page)           
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a> Page 3  Blocks 6-7   (Index page)          
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a> ...                                          
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>Mapping maintained by: Storage Manager / File Manager
</code></pre></div>
<h3 id="complete-storage-hierarchy">Complete Storage Hierarchy</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>         APPLICATION LAYER                              
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>         SQL Query: SELECT * FROM users WHERE id = 5    
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>                 
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>         QUERY OPTIMIZER                                
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>         Decides: Use index or full table scan?         
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>                 
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>         BUFFER MANAGER                                 
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>                     
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>           Buffer Pool (Memory Cache)                
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>                           
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>           Page 1 Page 5 Page 9     Hot pages
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>                           
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>                     
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>         If page not in buffer  Read from disk        
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>                 
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a>         STORAGE MANAGER                                
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>         Translates: Page ID  Disk Block Address       
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>         Page 5  File: users.dbf, Offset: 40960 bytes 
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>                 
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>         FILE SYSTEM (OS)                               
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a>         Reads blocks from disk file                    
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a>                 
<a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a>
<a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a>         PHYSICAL DISK                                  
<a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a>         Hard Drive / SSD                               
<a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a>         Block 80-81  Contains Page 5 data             
<a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a>
</code></pre></div>
<p><strong>Example: Reading a Row</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
</code></pre></div>
<p><strong>Step-by-step process:</strong></p>
<ol>
<li><strong>Query Parser</strong>: Parses SQL query</li>
<li><strong>Query Optimizer</strong>: Checks if index exists on <code>id</code> column</li>
<li>If YES: Use index to find page number</li>
<li>If NO: Full table scan (read all pages)</li>
<li><strong>Buffer Manager</strong>: Check if page is in memory</li>
<li>Cache HIT: Return page from buffer pool (fast!)</li>
<li>Cache MISS: Read page from disk</li>
<li><strong>Storage Manager</strong>: Translate page ID to disk location</li>
<li>Page 5  File offset: 40960 bytes (5  8KB)</li>
<li><strong>File System</strong>: Read 8KB from disk at offset 40960</li>
<li><strong>Buffer Manager</strong>: Store page in buffer pool, return data</li>
<li><strong>Query Executor</strong>: Scan page for record with id=5, return result</li>
</ol>
<p><strong>Without Index:</strong>
- Must read ALL pages (e.g., 10,000 pages = 80MB of data)
- Time: ~100-500ms for large tables</p>
<p><strong>With Index:</strong>
- Index lookup finds page number instantly
- Read only 1-3 pages (8-24KB of data)
- Time: ~1-10ms</p>
<hr />
<h2 id="question-2-what-types-of-indexing-are-present">Question 2: What Types of Indexing are Present?</h2>
<h3 id="answer_1">Answer:</h3>
<h3 id="what-is-indexing">What is Indexing?</h3>
<p><strong>Indexing</strong> is the process of creating a data structure (index) that improves the speed of data retrieval operations on a database table. An index stores a sorted copy of selected columns along with pointers to the actual rows.</p>
<h3 id="advantages-of-indexing">Advantages of Indexing</h3>
<p> <strong>Faster Query Performance</strong>
- Reduces query execution time from seconds to milliseconds
- Especially beneficial for large tables (millions of rows)</p>
<p> <strong>Efficient Searching</strong>
- WHERE clause queries execute faster
- Range queries (BETWEEN, &gt;, &lt;) are optimized</p>
<p> <strong>Faster Sorting</strong>
- ORDER BY operations use pre-sorted index
- No need to sort entire table</p>
<p> <strong>Improved JOIN Performance</strong>
- Indexed foreign keys speed up JOIN operations</p>
<p> <strong>Uniqueness Enforcement</strong>
- UNIQUE indexes prevent duplicate values</p>
<h3 id="disadvantages-of-indexing">Disadvantages of Indexing</h3>
<p> <strong>Extra Storage Space</strong>
- Each index requires additional disk space (10-20% of table size)</p>
<p> <strong>Slower Write Operations</strong>
- INSERT: Must add entry to all indexes
- UPDATE: Must update indexes if indexed columns change
- DELETE: Must remove entry from all indexes</p>
<p> <strong>Maintenance Overhead</strong>
- Indexes become fragmented over time
- Need periodic rebuilding/reorganization</p>
<p> <strong>Index Selection Complexity</strong>
- Too many indexes slow down writes significantly
- Wrong indexes waste space without helping queries</p>
<h3 id="types-of-indexes">Types of Indexes</h3>
<h4 id="1-clustered-index">1. Clustered Index</h4>
<p><strong>Definition</strong>: A clustered index determines the <strong>physical order</strong> of data rows in a table. The table data is sorted and stored in the order of the clustered index key.</p>
<p><strong>Key Characteristics:</strong>
-  <strong>One per table</strong>: Only one clustered index allowed (because physical order is unique)
-  <strong>Table is the index</strong>: Leaf nodes contain actual data rows, not pointers
-  <strong>Physical ordering</strong>: Rows are stored in sorted order on disk
-  <strong>Fast range queries</strong>: Sequential disk reads</p>
<p><strong>Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>Clustered Index B+ Tree:
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>                    [Root Node]
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>                        50
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>                    /        \
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>                   /          \
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>          [Internal Node]   [Internal Node]
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>             20    35           65    80
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>            /  |   |  \         /  |   |  \
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>           /   |   |   \       /   |   |   \
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>    [Leaf: Actual Data Rows - Stored in sorted order]
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>    [10,John,30]  [15,Jane,25]  [20,Bob,35]  [25,Alice,28] 
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>    [35,Tom,40]   [40,Sara,22]  [50,Mike,33]  [60,Lisa,29]  
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>    [65,Dave,45]  [70,Emma,31]  [80,Paul,27]  [90,Kate,38]
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>     Leaf nodes contain the ACTUAL table data, sorted by index key
</code></pre></div>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1">-- Create clustered index on primary key</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w">  </span><span class="c1">-- Automatically creates clustered index</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">    </span><span class="n">age</span><span class="w"> </span><span class="nb">INT</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="p">);</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="c1">-- Data is physically stored sorted by id:</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c1">-- Page 1: id 1-100</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="c1">-- Page 2: id 101-200</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="c1">-- Page 3: id 201-300</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c1">-- ...</span>
</code></pre></div>
<p><strong>Advantages:</strong>
-  Extremely fast for range queries (e.g., <code>WHERE id BETWEEN 100 AND 200</code>)
-  Data is already sorted (no sorting needed for ORDER BY on indexed column)
-  Faster for queries returning large result sets</p>
<p><strong>Disadvantages:</strong>
-  Only one per table
-  Slower INSERT/UPDATE if data isn't inserted in index order
-  Page splits occur when inserting into middle of sorted data</p>
<h4 id="2-non-clustered-index-secondary-index">2. Non-Clustered Index (Secondary Index)</h4>
<p><strong>Definition</strong>: A non-clustered index creates a <strong>separate structure</strong> from the table data. It contains index keys and pointers (row locators) to the actual data rows.</p>
<p><strong>Key Characteristics:</strong>
-  <strong>Multiple per table</strong>: Can have many non-clustered indexes
-  <strong>Separate structure</strong>: Index stored separately from table data
-  <strong>Contains pointers</strong>: Leaf nodes contain row pointers, not actual data
-  <strong>Flexible</strong>: Can index any column(s)</p>
<p><strong>Structure:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Non-Clustered Index B+ Tree (on &#39;name&#39; column):
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>                    [Root Node]
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>                       &#39;Jane&#39;
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>                    /          \
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>                   /            \
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>          [Internal Node]    [Internal Node]
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>           &#39;Alice&#39; &#39;Dave&#39;      &#39;Mike&#39; &#39;Tom&#39;
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>           /   |    |   \      /   |   |   \
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>          /    |    |    \    /    |   |    \
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    [Leaf: Index Keys + Pointers to Actual Rows]
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>    [&#39;Alice&#39;, ptrRow3]  [&#39;Bob&#39;, ptrRow1]    [&#39;Dave&#39;, ptrRow4]  
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>    [&#39;Emma&#39;, ptrRow7]   [&#39;Jane&#39;, ptrRow2]   [&#39;John&#39;, ptrRow5]  
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>    [&#39;Kate&#39;, ptrRow9]   [&#39;Lisa&#39;, ptrRow8]   [&#39;Mike&#39;, ptrRow6]  
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>    [&#39;Paul&#39;, ptrRow10]  [&#39;Sara&#39;, ptrRow11]  [&#39;Tom&#39;, ptrRow12]
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>     Leaf nodes contain index key + pointer to actual row location
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>    Actual Table Data (stored in clustered index or heap order):
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a>    Row1: [20, &#39;Bob&#39;,   35]
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>    Row2: [15, &#39;Jane&#39;,  25]
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>    Row3: [25, &#39;Alice&#39;, 28]
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>    Row4: [65, &#39;Dave&#39;,  45]
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>    ...
</code></pre></div>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1">-- Create non-clustered index on name column</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_name</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="c1">-- Index is separate from table data</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="c1">-- When querying: SELECT * FROM users WHERE name = &#39;Alice&#39;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1">-- 1. Search index for &#39;Alice&#39;  Get pointer to Row3</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="c1">-- 2. Use pointer to fetch actual row data</span>
</code></pre></div>
<p><strong>Advantages:</strong>
-  Multiple indexes possible on same table
-  Can optimize different query patterns
-  Doesn't affect physical data ordering</p>
<p><strong>Disadvantages:</strong>
-  Requires extra disk space (separate structure)
-  Two lookups: Index lookup + data fetch (bookmark lookup)
-  Slower than clustered index for range queries</p>
<h3 id="clustered-vs-non-clustered-index-comparison">Clustered vs Non-Clustered Index Comparison</h3>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Clustered Index</th>
<th>Non-Clustered Index</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Number per table</strong></td>
<td>One only</td>
<td>Multiple (typically up to 999)</td>
</tr>
<tr>
<td><strong>Data storage</strong></td>
<td>Leaf nodes contain actual rows</td>
<td>Leaf nodes contain pointers to rows</td>
</tr>
<tr>
<td><strong>Physical order</strong></td>
<td>Determines row order on disk</td>
<td>Doesn't affect row order</td>
</tr>
<tr>
<td><strong>Space</strong></td>
<td>No extra space (table itself)</td>
<td>Extra space for separate structure</td>
</tr>
<tr>
<td><strong>Speed</strong></td>
<td>Faster for range queries</td>
<td>Faster for specific lookups</td>
</tr>
<tr>
<td><strong>INSERT impact</strong></td>
<td>Can cause page splits</td>
<td>Less impact on inserts</td>
</tr>
<tr>
<td><strong>Common use</strong></td>
<td>Primary key</td>
<td>Foreign keys, search columns</td>
</tr>
</tbody>
</table>
<h3 id="other-index-types">Other Index Types</h3>
<h4 id="3-unique-index">3. Unique Index</h4>
<p>Ensures all values in the indexed column(s) are distinct.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_email</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">email</span><span class="p">);</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="c1">-- Prevents duplicate emails</span>
</code></pre></div>
<h4 id="4-composite-index-multi-column-index">4. Composite Index (Multi-Column Index)</h4>
<p>Index on multiple columns, useful for queries filtering on multiple fields.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_name_age</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">);</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="c1">-- Optimizes: WHERE name = &#39;John&#39; AND age = 30</span>
</code></pre></div>
<p><strong>Column Order Matters:</strong>
- Index on (name, age) helps: <code>WHERE name = 'John'</code> or <code>WHERE name = 'John' AND age = 30</code>
- Does NOT help: <code>WHERE age = 30</code> (first column not used)</p>
<h4 id="5-covering-index">5. Covering Index</h4>
<p>Index that includes all columns needed by a query, avoiding table lookup.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_covering</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="n">INCLUDE</span><span class="w"> </span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">);</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c1">-- Query: SELECT name, age, email WHERE name = &#39;John&#39;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="c1">-- All data retrieved from index, no table access needed!</span>
</code></pre></div>
<h4 id="6-filtered-index-partial-index">6. Filtered Index (Partial Index)</h4>
<p>Index on subset of rows matching a condition.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_active_users</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;active&#39;</span><span class="p">;</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="c1">-- Only indexes active users, smaller and faster</span>
</code></pre></div>
<h4 id="7-full-text-index">7. Full-Text Index</h4>
<p>Specialized index for text search operations.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">FULLTEXT</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_description</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">products</span><span class="p">(</span><span class="n">description</span><span class="p">);</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c1">-- Enables: WHERE MATCH(description) AGAINST (&#39;wireless mouse&#39;)</span>
</code></pre></div>
<hr />
<h2 id="question-3-understanding-data-structures-used-for-indexing">Question 3: Understanding Data Structures Used for Indexing</h2>
<h3 id="answer_2">Answer:</h3>
<h3 id="why-b-trees-and-b-trees">Why B-Trees and B+ Trees?</h3>
<p>Database indexes need a data structure that:
-  Supports fast search (O(log n))
-  Supports fast insert/delete
-  Works efficiently with disk I/O (minimizes disk reads)
-  Maintains sorted order
-  Handles large datasets</p>
<p><strong>B-Trees and B+ Trees</strong> are specifically designed for disk-based storage systems and are the industry standard for database indexing.</p>
<h3 id="b-tree-structure">B-Tree Structure</h3>
<p><strong>What is a B-Tree?</strong></p>
<p>A <strong>B-Tree</strong> (Balanced Tree) is a self-balancing, multi-way tree data structure designed specifically for storage systems that read and write large blocks of data. Invented by Rudolf Bayer and Ed McCreight in 1972 at Boeing Research Labs, B-Trees revolutionized database and file system design.</p>
<p><strong>Core Concept:</strong></p>
<p>Unlike binary trees (which have max 2 children), B-Trees can have <strong>many children per node</strong> (hundreds or even thousands). This "bushy" structure reduces tree height dramatically, which is crucial for disk-based systems where each level traversal requires a disk read.</p>
<p><strong>Why "B" in B-Tree?</strong></p>
<p>The "B" stands for <strong>"Balanced"</strong>, though some attribute it to "Boeing" (where it was invented) or "Bayer" (one of the inventors). The key insight is keeping the tree balanced at all times.</p>
<p><strong>Fundamental Characteristics:</strong></p>
<p>A B-Tree is a self-balancing tree data structure that maintains sorted data and allows searches, insertions, and deletions in O(log n) time. It's optimized for systems that read and write large blocks of data (like databases, file systems).</p>
<p><strong>What Makes B-Trees Special for Databases:</strong></p>
<ol>
<li><strong>Block-Oriented Design</strong>: Each node = one disk page/block (typically 4KB-16KB)</li>
<li>Minimizes expensive disk I/O operations</li>
<li>
<p>One disk read loads an entire node (with many keys)</p>
</li>
<li>
<p><strong>High Fan-out</strong>: Each node can have dozens to hundreds of children</p>
</li>
<li>Reduces tree height: log_base_M(N) where M is large</li>
<li>
<p>Example: 1 million records in a tree of height 3 with fan-out 100</p>
</li>
<li>
<p><strong>Self-Balancing</strong>: Automatically maintains balance on insert/delete</p>
</li>
<li>All leaf nodes always at same depth</li>
<li>Ensures consistent O(log n) performance</li>
</ol>
<p><strong>B-Tree Properties (Formal Definition):</strong></p>
<p>For a B-Tree of <strong>order m</strong> (maximum number of children):</p>
<ol>
<li><strong>Node Capacity:</strong></li>
<li>Each node contains at most <strong>m-1 keys</strong></li>
<li>Each node (except root) contains at least <strong>m/2 - 1 keys</strong></li>
<li>
<p>Root has at least 1 key (unless tree is empty)</p>
</li>
<li>
<p><strong>Children:</strong></p>
</li>
<li>Each internal node with k keys has <strong>k+1 children</strong></li>
<li>Each node (except root) has at least <strong>m/2 children</strong></li>
<li>
<p>All leaves are at the same level</p>
</li>
<li>
<p><strong>Ordering:</strong></p>
</li>
<li>Keys within a node are sorted: K &lt; K &lt; ... &lt; K</li>
<li>All keys in subtree[i] are less than K[i]</li>
<li>
<p>All keys in subtree[i+1] are greater than K[i]</p>
</li>
<li>
<p><strong>Data Storage:</strong></p>
</li>
<li><strong>Keys and data stored in ALL nodes</strong> (internal + leaf)</li>
<li>
<p>Each key has associated data (or pointer to data)</p>
</li>
<li>
<p><strong>Balance:</strong></p>
</li>
<li>All leaf nodes are at the same depth</li>
<li>Tree is always perfectly balanced</li>
</ol>
<p><strong>B-Tree Order Examples:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>Order 3 (minimum degree = 2):
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>- Max keys per node: 2
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>- Min keys per node: 1 (except root)
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>- Max children: 3
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>- Min children: 2 (except root)
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>Order 5 (minimum degree = 3):
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>- Max keys per node: 4
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>- Min keys per node: 2 (except root)
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>- Max children: 5
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>- Min children: 3 (except root)
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>Order 100 (common in databases):
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>- Max keys per node: 99
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>- Min keys per node: 49 (except root)
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>- Max children: 100
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>- Min children: 50 (except root)
</code></pre></div>
<p><strong>Why Order Matters:</strong></p>
<p>Higher order = bushier tree = fewer levels = fewer disk reads!</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Storing 1 million records:
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>Order 3 (binary-like):
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>- Height: ~20 levels
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>- Disk reads for search: 20
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>Order 100 (database typical):
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>- Height: ~3 levels
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>- Disk reads for search: 3
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>Result: 6-7x fewer disk reads!
</code></pre></div>
<p><strong>B-Tree Structure Diagram:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>B-Tree of order 3 (max 3 children per node):
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>                        [40, 70]   Root: Contains data
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>                     /      |      \
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>                    /       |       \
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>                   /        |        \
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>          [10, 20, 30]  [50, 60]  [80, 90, 100]
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>                                       
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>         Contains data  Contains data  Contains data
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>Keys: 10, 20, 30, 40, 50, 60, 70, 80, 90, 100
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>All keys stored in tree nodes (internal + leaf)
</code></pre></div>
<p><strong>Detailed B-Tree Node:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>            B-Tree Node                     
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a> n: 2  (number of keys)                     
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a> keys: [40, 70]                             
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a> data: [ptr_to_row_40, ptr_to_row_70]      
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a> children: [child_0, child_1, child_2]      
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>                                            
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a> child_0: all keys &lt; 40                     
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a> child_1: all keys between 40 and 70       
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a> child_2: all keys &gt; 70                     
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a>
</code></pre></div>
<p><strong>B-Tree Search Process:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>Search for key = 60:
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>Step 1: Start at root [40, 70]
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>        60 &gt; 40 and 60 &lt; 70
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>         Go to middle child
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>Step 2: At node [50, 60]
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>        Found 60!
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>         Return data associated with 60
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>Total disk reads: 2 nodes
</code></pre></div>
<h3 id="b-tree-structure_1">B+ Tree Structure</h3>
<p><strong>What is a B+ Tree?</strong></p>
<p>A <strong>B+ Tree</strong> is an evolution of the B-Tree, specifically optimized for database systems and file systems. It was developed in the late 1970s as an improvement over B-Trees for disk-based indexing. Nearly <strong>all modern databases</strong> (MySQL InnoDB, PostgreSQL, Oracle, SQL Server, MongoDB) use B+ Trees for their indexes.</p>
<p><strong>The Key Innovation:</strong></p>
<p>B+ Trees make a <strong>critical architectural change</strong>: they <strong>separate index navigation from data storage</strong>.</p>
<ul>
<li><strong>Internal nodes</strong>: Only store keys (for navigation)</li>
<li><strong>Leaf nodes</strong>: Store both keys AND data (or pointers to data)</li>
<li><strong>Leaf nodes are linked</strong>: Form a doubly-linked list</li>
</ul>
<p>This seemingly simple change provides massive benefits for database operations.</p>
<p><strong>Why B+ Trees Dominate Databases:</strong></p>
<ol>
<li>
<p><strong>Range Queries are Lightning Fast:</strong>
   <div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>B-Tree: For range query [20, 80], must:
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>- Tree traversal for 20
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>- Tree traversal for 25
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>- Tree traversal for 30
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>- ... (separate traversal for EACH value)
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>B+ Tree: For range query [20, 80], must:
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>- Tree traversal to find 20 (once)
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>- Linear scan through linked leaf nodes
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>- Stop when reaching value &gt; 80
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>Result: 1 tree traversal + sequential reads vs N tree traversals!
</code></pre></div></p>
</li>
<li>
<p><strong>Sequential Scans are Free:</strong></p>
</li>
<li>Linked leaves allow full table scans without tree traversal</li>
<li>
<p>Perfect for <code>SELECT *</code> or <code>WHERE date BETWEEN '2024-01-01' AND '2024-12-31'</code></p>
</li>
<li>
<p><strong>Internal Nodes are Compact:</strong></p>
</li>
<li>No data in internal nodes = more keys fit per node</li>
<li>More keys per node = higher fan-out = shorter tree</li>
<li>Example: If data is 100 bytes and key is 8 bytes:<ul>
<li>B-Tree node (4KB): ~37 entries</li>
<li>B+ Tree internal node (4KB): ~500 entries</li>
</ul>
</li>
<li>
<p>Result: <strong>B+ Tree can be significantly shorter!</strong></p>
</li>
<li>
<p><strong>Better Caching:</strong></p>
</li>
<li>Internal nodes (frequently accessed) are smaller  fit better in memory cache</li>
<li>Leaf nodes (less frequently accessed) stay on disk</li>
</ol>
<p><strong>B+ Tree Properties (Formal Definition):</strong></p>
<p>For a B+ Tree of <strong>order m</strong>:</p>
<ol>
<li><strong>Internal Nodes:</strong></li>
<li>Contain <strong>only keys</strong> (no data/values)</li>
<li>Each internal node has at most <strong>m children</strong></li>
<li>Each internal node (except root) has at least <strong>m/2 children</strong></li>
<li>Internal node with k keys has <strong>k children</strong> (different from B-Tree!)</li>
<li>
<p>Keys act as "signposts" to navigate to correct child</p>
</li>
<li>
<p><strong>Leaf Nodes:</strong></p>
</li>
<li>Contain <strong>both keys and data</strong> (or pointers to data records)</li>
<li>Each leaf node contains at most <strong>m-1 key-value pairs</strong></li>
<li>Each leaf node (except root) contains at least <strong>(m-1)/2 key-value pairs</strong></li>
<li>All leaf nodes are at the <strong>same level</strong> (balanced)</li>
<li>
<p>Leaf nodes form a <strong>doubly-linked list</strong> (crucial for range queries!)</p>
</li>
<li>
<p><strong>Key Distribution:</strong></p>
</li>
<li>A key in internal node represents the <strong>minimum key in its right subtree</strong></li>
<li>Keys in leaf nodes are the actual searchable keys</li>
<li>
<p><strong>Keys may be duplicated</strong> (appear in both internal and leaf nodes)</p>
</li>
<li>
<p><strong>Data Storage:</strong></p>
</li>
<li><strong>ALL data is in leaf nodes</strong></li>
<li>Internal nodes are purely for navigation</li>
<li>
<p>This is the fundamental difference from B-Tree</p>
</li>
<li>
<p><strong>Ordering:</strong></p>
</li>
<li>Keys within each node are sorted</li>
<li>Leaf nodes maintain sorted order left-to-right</li>
<li>Linked list of leaves can be traversed in sorted order</li>
</ol>
<p><strong>Structural Comparison - Same Data:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>B-Tree (Order 3):
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>                [50]
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>              /      \
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>         [30,40]    [60,70]
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>        /  |  \     /  |  \
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>     data data data ...
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>All nodes contain data!
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>B+ Tree (Order 3):
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>                [30, 50]               Internal: only keys
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>              /    |     \
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>            /      |      \
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>      [10,20]  [30,40]  [50,60,70]  Leaves: keys + data, linked!
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>       data      data       data
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>Only leaves contain data!
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>Leaves are linked () for range scans!
</code></pre></div>
<p><strong>Why Databases Choose B+ Trees:</strong></p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>B-Tree</th>
<th>B+ Tree</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Point Search</strong></td>
<td>O(log n) - Same</td>
<td>O(log n) - Same</td>
</tr>
<tr>
<td><strong>Range Query</strong></td>
<td>O(k  log n) - Multiple traversals</td>
<td>O(log n + k) - One traversal + linear scan </td>
</tr>
<tr>
<td><strong>Full Scan</strong></td>
<td>O(n  log n) - Must visit all nodes</td>
<td>O(n) - Just traverse leaves </td>
</tr>
<tr>
<td><strong>Cache Efficiency</strong></td>
<td>Lower - Data in all nodes</td>
<td>Higher - Compact internal nodes </td>
</tr>
<tr>
<td><strong>Fan-out</strong></td>
<td>Lower - Data takes space</td>
<td>Higher - Only keys in internal nodes </td>
</tr>
<tr>
<td><strong>Concurrency</strong></td>
<td>Lower - Data scattered</td>
<td>Higher - Leaf-level locking </td>
</tr>
</tbody>
</table>
<p><strong>Real-World Database Example:</strong></p>
<p><strong>MySQL InnoDB (B+ Tree Order ~1200):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>Assumptions:
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>- Page size: 16KB (InnoDB default)
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>- Key size: 8 bytes (BIGINT)
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>- Pointer size: 6 bytes
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>- Data row: ~100 bytes
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>Internal Node:
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>- ~1200 keys fit per page
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>- Fan-out: 1200
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>Leaf Node:
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>- ~100 rows fit per page
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>- Contains actual table data
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>Tree Height for 1 Billion Rows:
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>- Level 1 (root): 1 node = 1200 pointers
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>- Level 2: 1200 nodes = 1.44M pointers
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>- Level 3 (leaves): 1.44M nodes = 1B+ rows
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>Result: 3 disk reads to find ANY row in 1 billion records!
</code></pre></div>
<p><strong>B+ Tree Order Configuration:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>Order 4 (minimum practical):
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>- Internal: Max 4 children, 3 keys
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>- Leaf: Max 3 key-value pairs
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>- Good for: Teaching, small datasets
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>Order 100 (typical database):
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>- Internal: Max 100 children, 99 keys
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>- Leaf: Max 99 key-value pairs
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>- Good for: Production databases, 4KB pages
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>Order 1200 (InnoDB on 16KB pages):
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>- Internal: Max 1200 children, 1199 keys
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>- Leaf: Max ~100 rows (depends on row size)
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>- Good for: Large-scale databases, optimal I/O
</code></pre></div>
<p><strong>When Leaf Nodes Fill Up - The Linked List Saves The Day:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>Original:
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>[10,20]  [30,40]  [50,60]
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>After inserting 35:
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>[10,20]  [30]  [35,40]  [50,60]
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>             split!  
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>Parent gets updated with new separator key,
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>but linked list maintains sequential access!
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>Range query [25, 45] still works perfectly!
</code></pre></div>
<p><strong>B+ Tree Structure Diagram:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>B+ Tree of order 3:
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>                        [40, 70]   Root: Keys only (no data)
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>                     /      |      \
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>                    /       |       \
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>                   /        |        \
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>              [10, 20, 30] [50, 60] [80, 90, 100]   Internal: Keys only
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>              /  |  |  \    /   \     /   |   |  \
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>             /   |  |   \  /     \   /    |   |   \
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>    [10,d] [20,d] [30,d] [40,d] [50,d] [60,d] [70,d] [80,d] [90,d] [100,d]
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>                                                   
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>    Leaf nodes with data, linked together           
</code></pre></div>
<p><strong>Detailed B+ Tree Node:</strong></p>
<p><strong>Internal Node:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>        B+ Tree Internal Node               
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a> n: 2  (number of keys)                     
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a> keys: [40, 70]                             
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a> children: [child_0, child_1, child_2]      
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>                                            
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a> NO DATA - keys used for navigation only    
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>                                            
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a> child_0: all keys &lt; 40                     
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a> child_1: all keys between 40 and 70       
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a> child_2: all keys &gt;= 70                    
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>
</code></pre></div></p>
<p><strong>Leaf Node:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>        B+ Tree Leaf Node                   
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a> n: 3  (number of keys)                     
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a> keys: [50, 60, 70]                         
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a> data: [ptr_row_50, ptr_row_60, ptr_row_70] 
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a> next: pointer to next leaf node          
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a> prev: pointer to prev leaf node          
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>                                            
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a> ALL DATA stored here!                      
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>
</code></pre></div></p>
<p><strong>B+ Tree Search Process:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>Search for key = 60:
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>Step 1: Start at root [40, 70]
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>        60 &gt; 40 and 60 &lt; 70
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>         Go to middle child
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>Step 2: At internal node [50, 60]
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>        60 &gt;= 60
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>         Go to right child
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>Step 3: At leaf node [60, 70, 80]
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>        Found 60!
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a>         Return data associated with 60
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>Total disk reads: 3 nodes (but leaf has all data)
</code></pre></div>
<h3 id="b-tree-vs-b-tree-comparison">B-Tree vs B+ Tree Comparison</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>B-Tree</th>
<th>B+ Tree</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data location</strong></td>
<td>All nodes (internal + leaf)</td>
<td>Leaf nodes only</td>
</tr>
<tr>
<td><strong>Internal nodes</strong></td>
<td>Store keys + data</td>
<td>Store keys only (no data)</td>
</tr>
<tr>
<td><strong>Leaf nodes</strong></td>
<td>Not linked</td>
<td>Linked (doubly-linked list)</td>
</tr>
<tr>
<td><strong>Keys per node</strong></td>
<td>Fewer (data takes space)</td>
<td>More (only keys in internal)</td>
</tr>
<tr>
<td><strong>Tree height</strong></td>
<td>Slightly shorter</td>
<td>Slightly taller</td>
</tr>
<tr>
<td><strong>Range queries</strong></td>
<td>Requires tree traversal</td>
<td>Fast (follow leaf links)</td>
</tr>
<tr>
<td><strong>Search time</strong></td>
<td>O(log n)</td>
<td>O(log n)</td>
</tr>
<tr>
<td><strong>Use case</strong></td>
<td>General purpose</td>
<td>Databases, filesystems</td>
</tr>
</tbody>
</table>
<h3 id="why-databases-prefer-b-trees">Why Databases Prefer B+ Trees</h3>
<ol>
<li><strong> Better for Range Queries</strong></li>
<li>Leaf nodes are linked  Sequential scan without tree traversal</li>
<li>
<p>Example: <code>WHERE age BETWEEN 20 AND 30</code>  Find 20, then follow links</p>
</li>
<li>
<p><strong> More Keys in Internal Nodes</strong></p>
</li>
<li>No data in internal nodes  More keys fit per node</li>
<li>
<p>Shorter tree  Fewer disk reads</p>
</li>
<li>
<p><strong> Better for Full Scan</strong></p>
</li>
<li>Scan all data: Just traverse leaf level</li>
<li>
<p>B-Tree: Must traverse entire tree</p>
</li>
<li>
<p><strong> Consistent Search Time</strong></p>
</li>
<li>Always go to leaf level  Predictable performance</li>
<li>B-Tree: May find data at any level  Unpredictable</li>
</ol>
<h3 id="c-implementation-complete-production-ready-code">C Implementation (Complete Production-Ready Code)</h3>
<h4 id="complete-b-tree-implementation">Complete B-Tree Implementation</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="cp">#define ORDER 5  </span><span class="c1">// Maximum children per node (minimum degree t = 3)</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="cp">#define MAX_KEYS (ORDER - 1)</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="cp">#define MIN_KEYS ((ORDER / 2) - 1)</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="c1">// B-Tree node structure</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">BTreeNode</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">isLeaf</span><span class="p">;</span><span class="w">                          </span><span class="c1">// 1 if leaf, 0 if internal</span>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">numKeys</span><span class="p">;</span><span class="w">                         </span><span class="c1">// Current number of keys</span>
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">keys</span><span class="p">[</span><span class="n">MAX_KEYS</span><span class="p">];</span><span class="w">                  </span><span class="c1">// Keys array</span>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">MAX_KEYS</span><span class="p">];</span><span class="w">                </span><span class="c1">// Data pointers (in all nodes)</span>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">children</span><span class="p">[</span><span class="n">ORDER</span><span class="p">];</span><span class="w">   </span><span class="c1">// Child pointers</span>
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="p">}</span><span class="w"> </span><span class="n">BTreeNode</span><span class="p">;</span>
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="c1">// Create a new B-Tree node</span>
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="n">BTreeNode</span><span class="o">*</span><span class="w"> </span><span class="nf">createBTreeNode</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BTreeNode</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">BTreeNode</span><span class="p">));</span>
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isLeaf</span><span class="p">;</span>
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ORDER</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MAX_KEYS</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a><span class="p">}</span>
<a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a>
<a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a><span class="c1">// Search for a key in B-Tree</span>
<a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">bTreeSearch</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a>
<a id="__codelineno-38-36" name="__codelineno-38-36" href="#__codelineno-38-36"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-38-37" name="__codelineno-38-37" href="#__codelineno-38-37"></a><span class="w">    </span><span class="c1">// Find first key &gt;= search key</span>
<a id="__codelineno-38-38" name="__codelineno-38-38" href="#__codelineno-38-38"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-39" name="__codelineno-38-39" href="#__codelineno-38-39"></a><span class="w">        </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-40" name="__codelineno-38-40" href="#__codelineno-38-40"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-41" name="__codelineno-38-41" href="#__codelineno-38-41"></a>
<a id="__codelineno-38-42" name="__codelineno-38-42" href="#__codelineno-38-42"></a><span class="w">    </span><span class="c1">// Key found in this node (data can be at ANY level)</span>
<a id="__codelineno-38-43" name="__codelineno-38-43" href="#__codelineno-38-43"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-44" name="__codelineno-38-44" href="#__codelineno-38-44"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-45" name="__codelineno-38-45" href="#__codelineno-38-45"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-46" name="__codelineno-38-46" href="#__codelineno-38-46"></a>
<a id="__codelineno-38-47" name="__codelineno-38-47" href="#__codelineno-38-47"></a><span class="w">    </span><span class="c1">// If leaf, key not found</span>
<a id="__codelineno-38-48" name="__codelineno-38-48" href="#__codelineno-38-48"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-49" name="__codelineno-38-49" href="#__codelineno-38-49"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-38-50" name="__codelineno-38-50" href="#__codelineno-38-50"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-51" name="__codelineno-38-51" href="#__codelineno-38-51"></a>
<a id="__codelineno-38-52" name="__codelineno-38-52" href="#__codelineno-38-52"></a><span class="w">    </span><span class="c1">// Recurse to appropriate child</span>
<a id="__codelineno-38-53" name="__codelineno-38-53" href="#__codelineno-38-53"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">bTreeSearch</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-38-54" name="__codelineno-38-54" href="#__codelineno-38-54"></a><span class="p">}</span>
<a id="__codelineno-38-55" name="__codelineno-38-55" href="#__codelineno-38-55"></a>
<a id="__codelineno-38-56" name="__codelineno-38-56" href="#__codelineno-38-56"></a><span class="c1">// Split a full child of node at index i</span>
<a id="__codelineno-38-57" name="__codelineno-38-57" href="#__codelineno-38-57"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeSplitChild</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-58" name="__codelineno-38-58" href="#__codelineno-38-58"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">fullChild</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-59" name="__codelineno-38-59" href="#__codelineno-38-59"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">newChild</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBTreeNode</span><span class="p">(</span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">);</span>
<a id="__codelineno-38-60" name="__codelineno-38-60" href="#__codelineno-38-60"></a>
<a id="__codelineno-38-61" name="__codelineno-38-61" href="#__codelineno-38-61"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">midIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">;</span>
<a id="__codelineno-38-62" name="__codelineno-38-62" href="#__codelineno-38-62"></a><span class="w">    </span><span class="n">newChild</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">;</span>
<a id="__codelineno-38-63" name="__codelineno-38-63" href="#__codelineno-38-63"></a>
<a id="__codelineno-38-64" name="__codelineno-38-64" href="#__codelineno-38-64"></a><span class="w">    </span><span class="c1">// Copy upper half keys and data to new node</span>
<a id="__codelineno-38-65" name="__codelineno-38-65" href="#__codelineno-38-65"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-66" name="__codelineno-38-66" href="#__codelineno-38-66"></a><span class="w">        </span><span class="n">newChild</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">midIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-67" name="__codelineno-38-67" href="#__codelineno-38-67"></a><span class="w">        </span><span class="n">newChild</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">midIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-68" name="__codelineno-38-68" href="#__codelineno-38-68"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-69" name="__codelineno-38-69" href="#__codelineno-38-69"></a>
<a id="__codelineno-38-70" name="__codelineno-38-70" href="#__codelineno-38-70"></a><span class="w">    </span><span class="c1">// If not leaf, copy children pointers</span>
<a id="__codelineno-38-71" name="__codelineno-38-71" href="#__codelineno-38-71"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-72" name="__codelineno-38-72" href="#__codelineno-38-72"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-73" name="__codelineno-38-73" href="#__codelineno-38-73"></a><span class="w">            </span><span class="n">newChild</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">midIndex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-74" name="__codelineno-38-74" href="#__codelineno-38-74"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-75" name="__codelineno-38-75" href="#__codelineno-38-75"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-76" name="__codelineno-38-76" href="#__codelineno-38-76"></a>
<a id="__codelineno-38-77" name="__codelineno-38-77" href="#__codelineno-38-77"></a><span class="w">    </span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">;</span>
<a id="__codelineno-38-78" name="__codelineno-38-78" href="#__codelineno-38-78"></a>
<a id="__codelineno-38-79" name="__codelineno-38-79" href="#__codelineno-38-79"></a><span class="w">    </span><span class="c1">// Shift parent&#39;s children to make space</span>
<a id="__codelineno-38-80" name="__codelineno-38-80" href="#__codelineno-38-80"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-81" name="__codelineno-38-81" href="#__codelineno-38-81"></a><span class="w">        </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<a id="__codelineno-38-82" name="__codelineno-38-82" href="#__codelineno-38-82"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-83" name="__codelineno-38-83" href="#__codelineno-38-83"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newChild</span><span class="p">;</span>
<a id="__codelineno-38-84" name="__codelineno-38-84" href="#__codelineno-38-84"></a>
<a id="__codelineno-38-85" name="__codelineno-38-85" href="#__codelineno-38-85"></a><span class="w">    </span><span class="c1">// Move middle key up to parent</span>
<a id="__codelineno-38-86" name="__codelineno-38-86" href="#__codelineno-38-86"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-87" name="__codelineno-38-87" href="#__codelineno-38-87"></a><span class="w">        </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<a id="__codelineno-38-88" name="__codelineno-38-88" href="#__codelineno-38-88"></a><span class="w">        </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<a id="__codelineno-38-89" name="__codelineno-38-89" href="#__codelineno-38-89"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-90" name="__codelineno-38-90" href="#__codelineno-38-90"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">midIndex</span><span class="p">];</span>
<a id="__codelineno-38-91" name="__codelineno-38-91" href="#__codelineno-38-91"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fullChild</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">midIndex</span><span class="p">];</span>
<a id="__codelineno-38-92" name="__codelineno-38-92" href="#__codelineno-38-92"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-93" name="__codelineno-38-93" href="#__codelineno-38-93"></a><span class="p">}</span>
<a id="__codelineno-38-94" name="__codelineno-38-94" href="#__codelineno-38-94"></a>
<a id="__codelineno-38-95" name="__codelineno-38-95" href="#__codelineno-38-95"></a><span class="c1">// Insert into a non-full node</span>
<a id="__codelineno-38-96" name="__codelineno-38-96" href="#__codelineno-38-96"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeInsertNonFull</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-97" name="__codelineno-38-97" href="#__codelineno-38-97"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-38-98" name="__codelineno-38-98" href="#__codelineno-38-98"></a>
<a id="__codelineno-38-99" name="__codelineno-38-99" href="#__codelineno-38-99"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-100" name="__codelineno-38-100" href="#__codelineno-38-100"></a><span class="w">        </span><span class="c1">// Shift keys to make space</span>
<a id="__codelineno-38-101" name="__codelineno-38-101" href="#__codelineno-38-101"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-102" name="__codelineno-38-102" href="#__codelineno-38-102"></a><span class="w">            </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-103" name="__codelineno-38-103" href="#__codelineno-38-103"></a><span class="w">            </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-104" name="__codelineno-38-104" href="#__codelineno-38-104"></a><span class="w">            </span><span class="n">i</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-38-105" name="__codelineno-38-105" href="#__codelineno-38-105"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-106" name="__codelineno-38-106" href="#__codelineno-38-106"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-38-107" name="__codelineno-38-107" href="#__codelineno-38-107"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="__codelineno-38-108" name="__codelineno-38-108" href="#__codelineno-38-108"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-109" name="__codelineno-38-109" href="#__codelineno-38-109"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-110" name="__codelineno-38-110" href="#__codelineno-38-110"></a><span class="w">        </span><span class="c1">// Find child to insert into</span>
<a id="__codelineno-38-111" name="__codelineno-38-111" href="#__codelineno-38-111"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-112" name="__codelineno-38-112" href="#__codelineno-38-112"></a><span class="w">            </span><span class="n">i</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-38-113" name="__codelineno-38-113" href="#__codelineno-38-113"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-114" name="__codelineno-38-114" href="#__codelineno-38-114"></a><span class="w">        </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-115" name="__codelineno-38-115" href="#__codelineno-38-115"></a>
<a id="__codelineno-38-116" name="__codelineno-38-116" href="#__codelineno-38-116"></a><span class="w">        </span><span class="c1">// If child is full, split it</span>
<a id="__codelineno-38-117" name="__codelineno-38-117" href="#__codelineno-38-117"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MAX_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-118" name="__codelineno-38-118" href="#__codelineno-38-118"></a><span class="w">            </span><span class="n">bTreeSplitChild</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">);</span>
<a id="__codelineno-38-119" name="__codelineno-38-119" href="#__codelineno-38-119"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-120" name="__codelineno-38-120" href="#__codelineno-38-120"></a><span class="w">                </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-121" name="__codelineno-38-121" href="#__codelineno-38-121"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-38-122" name="__codelineno-38-122" href="#__codelineno-38-122"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-123" name="__codelineno-38-123" href="#__codelineno-38-123"></a><span class="w">        </span><span class="n">bTreeInsertNonFull</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<a id="__codelineno-38-124" name="__codelineno-38-124" href="#__codelineno-38-124"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-125" name="__codelineno-38-125" href="#__codelineno-38-125"></a><span class="p">}</span>
<a id="__codelineno-38-126" name="__codelineno-38-126" href="#__codelineno-38-126"></a>
<a id="__codelineno-38-127" name="__codelineno-38-127" href="#__codelineno-38-127"></a><span class="c1">// Insert a key into B-Tree</span>
<a id="__codelineno-38-128" name="__codelineno-38-128" href="#__codelineno-38-128"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeInsert</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">**</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-129" name="__codelineno-38-129" href="#__codelineno-38-129"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-130" name="__codelineno-38-130" href="#__codelineno-38-130"></a><span class="w">        </span><span class="o">*</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBTreeNode</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-38-131" name="__codelineno-38-131" href="#__codelineno-38-131"></a><span class="w">        </span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-38-132" name="__codelineno-38-132" href="#__codelineno-38-132"></a><span class="w">        </span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="__codelineno-38-133" name="__codelineno-38-133" href="#__codelineno-38-133"></a><span class="w">        </span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-38-134" name="__codelineno-38-134" href="#__codelineno-38-134"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-38-135" name="__codelineno-38-135" href="#__codelineno-38-135"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-136" name="__codelineno-38-136" href="#__codelineno-38-136"></a>
<a id="__codelineno-38-137" name="__codelineno-38-137" href="#__codelineno-38-137"></a><span class="w">    </span><span class="c1">// If root is full, split it</span>
<a id="__codelineno-38-138" name="__codelineno-38-138" href="#__codelineno-38-138"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MAX_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-139" name="__codelineno-38-139" href="#__codelineno-38-139"></a><span class="w">        </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">newRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBTreeNode</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-38-140" name="__codelineno-38-140" href="#__codelineno-38-140"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-38-141" name="__codelineno-38-141" href="#__codelineno-38-141"></a><span class="w">        </span><span class="n">bTreeSplitChild</span><span class="p">(</span><span class="n">newRoot</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-38-142" name="__codelineno-38-142" href="#__codelineno-38-142"></a><span class="w">        </span><span class="o">*</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-38-143" name="__codelineno-38-143" href="#__codelineno-38-143"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-144" name="__codelineno-38-144" href="#__codelineno-38-144"></a>
<a id="__codelineno-38-145" name="__codelineno-38-145" href="#__codelineno-38-145"></a><span class="w">    </span><span class="n">bTreeInsertNonFull</span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<a id="__codelineno-38-146" name="__codelineno-38-146" href="#__codelineno-38-146"></a><span class="p">}</span>
<a id="__codelineno-38-147" name="__codelineno-38-147" href="#__codelineno-38-147"></a>
<a id="__codelineno-38-148" name="__codelineno-38-148" href="#__codelineno-38-148"></a><span class="c1">// Find predecessor key (largest key in left subtree)</span>
<a id="__codelineno-38-149" name="__codelineno-38-149" href="#__codelineno-38-149"></a><span class="kt">int</span><span class="w"> </span><span class="nf">bTreeGetPredecessor</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-150" name="__codelineno-38-150" href="#__codelineno-38-150"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-151" name="__codelineno-38-151" href="#__codelineno-38-151"></a><span class="w">        </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">];</span>
<a id="__codelineno-38-152" name="__codelineno-38-152" href="#__codelineno-38-152"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-153" name="__codelineno-38-153" href="#__codelineno-38-153"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-154" name="__codelineno-38-154" href="#__codelineno-38-154"></a><span class="p">}</span>
<a id="__codelineno-38-155" name="__codelineno-38-155" href="#__codelineno-38-155"></a>
<a id="__codelineno-38-156" name="__codelineno-38-156" href="#__codelineno-38-156"></a><span class="c1">// Find successor key (smallest key in right subtree)</span>
<a id="__codelineno-38-157" name="__codelineno-38-157" href="#__codelineno-38-157"></a><span class="kt">int</span><span class="w"> </span><span class="nf">bTreeGetSuccessor</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-158" name="__codelineno-38-158" href="#__codelineno-38-158"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-159" name="__codelineno-38-159" href="#__codelineno-38-159"></a><span class="w">        </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-38-160" name="__codelineno-38-160" href="#__codelineno-38-160"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-161" name="__codelineno-38-161" href="#__codelineno-38-161"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-38-162" name="__codelineno-38-162" href="#__codelineno-38-162"></a><span class="p">}</span>
<a id="__codelineno-38-163" name="__codelineno-38-163" href="#__codelineno-38-163"></a>
<a id="__codelineno-38-164" name="__codelineno-38-164" href="#__codelineno-38-164"></a><span class="c1">// Merge a child with its sibling</span>
<a id="__codelineno-38-165" name="__codelineno-38-165" href="#__codelineno-38-165"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeMerge</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-166" name="__codelineno-38-166" href="#__codelineno-38-166"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-167" name="__codelineno-38-167" href="#__codelineno-38-167"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">sibling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-168" name="__codelineno-38-168" href="#__codelineno-38-168"></a>
<a id="__codelineno-38-169" name="__codelineno-38-169" href="#__codelineno-38-169"></a><span class="w">    </span><span class="c1">// Pull key from current node and merge with right sibling</span>
<a id="__codelineno-38-170" name="__codelineno-38-170" href="#__codelineno-38-170"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">MIN_KEYS</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-171" name="__codelineno-38-171" href="#__codelineno-38-171"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">MIN_KEYS</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-172" name="__codelineno-38-172" href="#__codelineno-38-172"></a>
<a id="__codelineno-38-173" name="__codelineno-38-173" href="#__codelineno-38-173"></a><span class="w">    </span><span class="c1">// Copy keys from sibling</span>
<a id="__codelineno-38-174" name="__codelineno-38-174" href="#__codelineno-38-174"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-175" name="__codelineno-38-175" href="#__codelineno-38-175"></a><span class="w">        </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-176" name="__codelineno-38-176" href="#__codelineno-38-176"></a><span class="w">        </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-177" name="__codelineno-38-177" href="#__codelineno-38-177"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-178" name="__codelineno-38-178" href="#__codelineno-38-178"></a>
<a id="__codelineno-38-179" name="__codelineno-38-179" href="#__codelineno-38-179"></a><span class="w">    </span><span class="c1">// Copy child pointers if not leaf</span>
<a id="__codelineno-38-180" name="__codelineno-38-180" href="#__codelineno-38-180"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-181" name="__codelineno-38-181" href="#__codelineno-38-181"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-182" name="__codelineno-38-182" href="#__codelineno-38-182"></a><span class="w">            </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-183" name="__codelineno-38-183" href="#__codelineno-38-183"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-184" name="__codelineno-38-184" href="#__codelineno-38-184"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-185" name="__codelineno-38-185" href="#__codelineno-38-185"></a>
<a id="__codelineno-38-186" name="__codelineno-38-186" href="#__codelineno-38-186"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-38-187" name="__codelineno-38-187" href="#__codelineno-38-187"></a>
<a id="__codelineno-38-188" name="__codelineno-38-188" href="#__codelineno-38-188"></a><span class="w">    </span><span class="c1">// Move keys in parent</span>
<a id="__codelineno-38-189" name="__codelineno-38-189" href="#__codelineno-38-189"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-190" name="__codelineno-38-190" href="#__codelineno-38-190"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-191" name="__codelineno-38-191" href="#__codelineno-38-191"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-192" name="__codelineno-38-192" href="#__codelineno-38-192"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-193" name="__codelineno-38-193" href="#__codelineno-38-193"></a>
<a id="__codelineno-38-194" name="__codelineno-38-194" href="#__codelineno-38-194"></a><span class="w">    </span><span class="c1">// Move child pointers in parent</span>
<a id="__codelineno-38-195" name="__codelineno-38-195" href="#__codelineno-38-195"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-196" name="__codelineno-38-196" href="#__codelineno-38-196"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-197" name="__codelineno-38-197" href="#__codelineno-38-197"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-198" name="__codelineno-38-198" href="#__codelineno-38-198"></a>
<a id="__codelineno-38-199" name="__codelineno-38-199" href="#__codelineno-38-199"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-38-200" name="__codelineno-38-200" href="#__codelineno-38-200"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">sibling</span><span class="p">);</span>
<a id="__codelineno-38-201" name="__codelineno-38-201" href="#__codelineno-38-201"></a><span class="p">}</span>
<a id="__codelineno-38-202" name="__codelineno-38-202" href="#__codelineno-38-202"></a>
<a id="__codelineno-38-203" name="__codelineno-38-203" href="#__codelineno-38-203"></a><span class="c1">// Borrow from previous sibling</span>
<a id="__codelineno-38-204" name="__codelineno-38-204" href="#__codelineno-38-204"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeBorrowFromPrev</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-205" name="__codelineno-38-205" href="#__codelineno-38-205"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-206" name="__codelineno-38-206" href="#__codelineno-38-206"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">sibling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-207" name="__codelineno-38-207" href="#__codelineno-38-207"></a>
<a id="__codelineno-38-208" name="__codelineno-38-208" href="#__codelineno-38-208"></a><span class="w">    </span><span class="c1">// Move all keys in child forward</span>
<a id="__codelineno-38-209" name="__codelineno-38-209" href="#__codelineno-38-209"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-210" name="__codelineno-38-210" href="#__codelineno-38-210"></a><span class="w">        </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-211" name="__codelineno-38-211" href="#__codelineno-38-211"></a><span class="w">        </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-212" name="__codelineno-38-212" href="#__codelineno-38-212"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-213" name="__codelineno-38-213" href="#__codelineno-38-213"></a>
<a id="__codelineno-38-214" name="__codelineno-38-214" href="#__codelineno-38-214"></a><span class="w">    </span><span class="c1">// Move child pointers</span>
<a id="__codelineno-38-215" name="__codelineno-38-215" href="#__codelineno-38-215"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-216" name="__codelineno-38-216" href="#__codelineno-38-216"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-217" name="__codelineno-38-217" href="#__codelineno-38-217"></a><span class="w">            </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-218" name="__codelineno-38-218" href="#__codelineno-38-218"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-219" name="__codelineno-38-219" href="#__codelineno-38-219"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-220" name="__codelineno-38-220" href="#__codelineno-38-220"></a>
<a id="__codelineno-38-221" name="__codelineno-38-221" href="#__codelineno-38-221"></a><span class="w">    </span><span class="c1">// Move key from parent to child</span>
<a id="__codelineno-38-222" name="__codelineno-38-222" href="#__codelineno-38-222"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-223" name="__codelineno-38-223" href="#__codelineno-38-223"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-224" name="__codelineno-38-224" href="#__codelineno-38-224"></a>
<a id="__codelineno-38-225" name="__codelineno-38-225" href="#__codelineno-38-225"></a><span class="w">    </span><span class="c1">// Move key from sibling to parent</span>
<a id="__codelineno-38-226" name="__codelineno-38-226" href="#__codelineno-38-226"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-227" name="__codelineno-38-227" href="#__codelineno-38-227"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-228" name="__codelineno-38-228" href="#__codelineno-38-228"></a>
<a id="__codelineno-38-229" name="__codelineno-38-229" href="#__codelineno-38-229"></a><span class="w">    </span><span class="c1">// Move child pointer</span>
<a id="__codelineno-38-230" name="__codelineno-38-230" href="#__codelineno-38-230"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-231" name="__codelineno-38-231" href="#__codelineno-38-231"></a><span class="w">        </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">];</span>
<a id="__codelineno-38-232" name="__codelineno-38-232" href="#__codelineno-38-232"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-233" name="__codelineno-38-233" href="#__codelineno-38-233"></a>
<a id="__codelineno-38-234" name="__codelineno-38-234" href="#__codelineno-38-234"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-235" name="__codelineno-38-235" href="#__codelineno-38-235"></a><span class="w">    </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-38-236" name="__codelineno-38-236" href="#__codelineno-38-236"></a><span class="p">}</span>
<a id="__codelineno-38-237" name="__codelineno-38-237" href="#__codelineno-38-237"></a>
<a id="__codelineno-38-238" name="__codelineno-38-238" href="#__codelineno-38-238"></a><span class="c1">// Borrow from next sibling</span>
<a id="__codelineno-38-239" name="__codelineno-38-239" href="#__codelineno-38-239"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeBorrowFromNext</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-240" name="__codelineno-38-240" href="#__codelineno-38-240"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-241" name="__codelineno-38-241" href="#__codelineno-38-241"></a><span class="w">    </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">sibling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-38-242" name="__codelineno-38-242" href="#__codelineno-38-242"></a>
<a id="__codelineno-38-243" name="__codelineno-38-243" href="#__codelineno-38-243"></a><span class="w">    </span><span class="c1">// Move key from parent to child</span>
<a id="__codelineno-38-244" name="__codelineno-38-244" href="#__codelineno-38-244"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-245" name="__codelineno-38-245" href="#__codelineno-38-245"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-246" name="__codelineno-38-246" href="#__codelineno-38-246"></a>
<a id="__codelineno-38-247" name="__codelineno-38-247" href="#__codelineno-38-247"></a><span class="w">    </span><span class="c1">// Move child pointer</span>
<a id="__codelineno-38-248" name="__codelineno-38-248" href="#__codelineno-38-248"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-249" name="__codelineno-38-249" href="#__codelineno-38-249"></a><span class="w">        </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-38-250" name="__codelineno-38-250" href="#__codelineno-38-250"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-251" name="__codelineno-38-251" href="#__codelineno-38-251"></a>
<a id="__codelineno-38-252" name="__codelineno-38-252" href="#__codelineno-38-252"></a><span class="w">    </span><span class="c1">// Move key from sibling to parent</span>
<a id="__codelineno-38-253" name="__codelineno-38-253" href="#__codelineno-38-253"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-38-254" name="__codelineno-38-254" href="#__codelineno-38-254"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-38-255" name="__codelineno-38-255" href="#__codelineno-38-255"></a>
<a id="__codelineno-38-256" name="__codelineno-38-256" href="#__codelineno-38-256"></a><span class="w">    </span><span class="c1">// Shift keys in sibling</span>
<a id="__codelineno-38-257" name="__codelineno-38-257" href="#__codelineno-38-257"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-258" name="__codelineno-38-258" href="#__codelineno-38-258"></a><span class="w">        </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-259" name="__codelineno-38-259" href="#__codelineno-38-259"></a><span class="w">        </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-260" name="__codelineno-38-260" href="#__codelineno-38-260"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-261" name="__codelineno-38-261" href="#__codelineno-38-261"></a>
<a id="__codelineno-38-262" name="__codelineno-38-262" href="#__codelineno-38-262"></a><span class="w">    </span><span class="c1">// Shift child pointers in sibling</span>
<a id="__codelineno-38-263" name="__codelineno-38-263" href="#__codelineno-38-263"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-264" name="__codelineno-38-264" href="#__codelineno-38-264"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-265" name="__codelineno-38-265" href="#__codelineno-38-265"></a><span class="w">            </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-266" name="__codelineno-38-266" href="#__codelineno-38-266"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-267" name="__codelineno-38-267" href="#__codelineno-38-267"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-268" name="__codelineno-38-268" href="#__codelineno-38-268"></a>
<a id="__codelineno-38-269" name="__codelineno-38-269" href="#__codelineno-38-269"></a><span class="w">    </span><span class="n">child</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-270" name="__codelineno-38-270" href="#__codelineno-38-270"></a><span class="w">    </span><span class="n">sibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-38-271" name="__codelineno-38-271" href="#__codelineno-38-271"></a><span class="p">}</span>
<a id="__codelineno-38-272" name="__codelineno-38-272" href="#__codelineno-38-272"></a>
<a id="__codelineno-38-273" name="__codelineno-38-273" href="#__codelineno-38-273"></a><span class="c1">// Fill child at idx if it has fewer than MIN_KEYS</span>
<a id="__codelineno-38-274" name="__codelineno-38-274" href="#__codelineno-38-274"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeFill</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-275" name="__codelineno-38-275" href="#__codelineno-38-275"></a><span class="w">    </span><span class="c1">// If previous sibling has more than MIN_KEYS, borrow from it</span>
<a id="__codelineno-38-276" name="__codelineno-38-276" href="#__codelineno-38-276"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-277" name="__codelineno-38-277" href="#__codelineno-38-277"></a><span class="w">        </span><span class="n">bTreeBorrowFromPrev</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-278" name="__codelineno-38-278" href="#__codelineno-38-278"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-279" name="__codelineno-38-279" href="#__codelineno-38-279"></a><span class="w">    </span><span class="c1">// If next sibling has more than MIN_KEYS, borrow from it</span>
<a id="__codelineno-38-280" name="__codelineno-38-280" href="#__codelineno-38-280"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-281" name="__codelineno-38-281" href="#__codelineno-38-281"></a><span class="w">        </span><span class="n">bTreeBorrowFromNext</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-282" name="__codelineno-38-282" href="#__codelineno-38-282"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-283" name="__codelineno-38-283" href="#__codelineno-38-283"></a><span class="w">    </span><span class="c1">// Merge with sibling</span>
<a id="__codelineno-38-284" name="__codelineno-38-284" href="#__codelineno-38-284"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-285" name="__codelineno-38-285" href="#__codelineno-38-285"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-286" name="__codelineno-38-286" href="#__codelineno-38-286"></a><span class="w">            </span><span class="n">bTreeMerge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-287" name="__codelineno-38-287" href="#__codelineno-38-287"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-288" name="__codelineno-38-288" href="#__codelineno-38-288"></a><span class="w">            </span><span class="n">bTreeMerge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-38-289" name="__codelineno-38-289" href="#__codelineno-38-289"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-290" name="__codelineno-38-290" href="#__codelineno-38-290"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-291" name="__codelineno-38-291" href="#__codelineno-38-291"></a><span class="p">}</span>
<a id="__codelineno-38-292" name="__codelineno-38-292" href="#__codelineno-38-292"></a>
<a id="__codelineno-38-293" name="__codelineno-38-293" href="#__codelineno-38-293"></a><span class="c1">// Delete key from leaf node</span>
<a id="__codelineno-38-294" name="__codelineno-38-294" href="#__codelineno-38-294"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeRemoveFromLeaf</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-295" name="__codelineno-38-295" href="#__codelineno-38-295"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-296" name="__codelineno-38-296" href="#__codelineno-38-296"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-297" name="__codelineno-38-297" href="#__codelineno-38-297"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-38-298" name="__codelineno-38-298" href="#__codelineno-38-298"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-299" name="__codelineno-38-299" href="#__codelineno-38-299"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-38-300" name="__codelineno-38-300" href="#__codelineno-38-300"></a><span class="p">}</span>
<a id="__codelineno-38-301" name="__codelineno-38-301" href="#__codelineno-38-301"></a>
<a id="__codelineno-38-302" name="__codelineno-38-302" href="#__codelineno-38-302"></a><span class="c1">// Delete key from internal node</span>
<a id="__codelineno-38-303" name="__codelineno-38-303" href="#__codelineno-38-303"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeRemoveFromNonLeaf</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-304" name="__codelineno-38-304" href="#__codelineno-38-304"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
<a id="__codelineno-38-305" name="__codelineno-38-305" href="#__codelineno-38-305"></a>
<a id="__codelineno-38-306" name="__codelineno-38-306" href="#__codelineno-38-306"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-307" name="__codelineno-38-307" href="#__codelineno-38-307"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">pred</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bTreeGetPredecessor</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]);</span>
<a id="__codelineno-38-308" name="__codelineno-38-308" href="#__codelineno-38-308"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pred</span><span class="p">;</span>
<a id="__codelineno-38-309" name="__codelineno-38-309" href="#__codelineno-38-309"></a><span class="w">        </span><span class="n">bTreeDeleteInternal</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">pred</span><span class="p">);</span>
<a id="__codelineno-38-310" name="__codelineno-38-310" href="#__codelineno-38-310"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-311" name="__codelineno-38-311" href="#__codelineno-38-311"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-312" name="__codelineno-38-312" href="#__codelineno-38-312"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">succ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bTreeGetSuccessor</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]);</span>
<a id="__codelineno-38-313" name="__codelineno-38-313" href="#__codelineno-38-313"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">succ</span><span class="p">;</span>
<a id="__codelineno-38-314" name="__codelineno-38-314" href="#__codelineno-38-314"></a><span class="w">        </span><span class="n">bTreeDeleteInternal</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">succ</span><span class="p">);</span>
<a id="__codelineno-38-315" name="__codelineno-38-315" href="#__codelineno-38-315"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-316" name="__codelineno-38-316" href="#__codelineno-38-316"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-317" name="__codelineno-38-317" href="#__codelineno-38-317"></a><span class="w">        </span><span class="n">bTreeMerge</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-318" name="__codelineno-38-318" href="#__codelineno-38-318"></a><span class="w">        </span><span class="n">bTreeDeleteInternal</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-38-319" name="__codelineno-38-319" href="#__codelineno-38-319"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-320" name="__codelineno-38-320" href="#__codelineno-38-320"></a><span class="p">}</span>
<a id="__codelineno-38-321" name="__codelineno-38-321" href="#__codelineno-38-321"></a>
<a id="__codelineno-38-322" name="__codelineno-38-322" href="#__codelineno-38-322"></a><span class="c1">// Internal delete helper</span>
<a id="__codelineno-38-323" name="__codelineno-38-323" href="#__codelineno-38-323"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeDeleteInternal</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-324" name="__codelineno-38-324" href="#__codelineno-38-324"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-38-325" name="__codelineno-38-325" href="#__codelineno-38-325"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-326" name="__codelineno-38-326" href="#__codelineno-38-326"></a><span class="w">        </span><span class="n">idx</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-38-327" name="__codelineno-38-327" href="#__codelineno-38-327"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-328" name="__codelineno-38-328" href="#__codelineno-38-328"></a>
<a id="__codelineno-38-329" name="__codelineno-38-329" href="#__codelineno-38-329"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-330" name="__codelineno-38-330" href="#__codelineno-38-330"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-331" name="__codelineno-38-331" href="#__codelineno-38-331"></a><span class="w">            </span><span class="n">bTreeRemoveFromLeaf</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-332" name="__codelineno-38-332" href="#__codelineno-38-332"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-333" name="__codelineno-38-333" href="#__codelineno-38-333"></a><span class="w">            </span><span class="n">bTreeRemoveFromNonLeaf</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-334" name="__codelineno-38-334" href="#__codelineno-38-334"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-335" name="__codelineno-38-335" href="#__codelineno-38-335"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-336" name="__codelineno-38-336" href="#__codelineno-38-336"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">isInSubtree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">);</span>
<a id="__codelineno-38-337" name="__codelineno-38-337" href="#__codelineno-38-337"></a>
<a id="__codelineno-38-338" name="__codelineno-38-338" href="#__codelineno-38-338"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-339" name="__codelineno-38-339" href="#__codelineno-38-339"></a><span class="w">            </span><span class="n">bTreeFill</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-38-340" name="__codelineno-38-340" href="#__codelineno-38-340"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-341" name="__codelineno-38-341" href="#__codelineno-38-341"></a>
<a id="__codelineno-38-342" name="__codelineno-38-342" href="#__codelineno-38-342"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isInSubtree</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-343" name="__codelineno-38-343" href="#__codelineno-38-343"></a><span class="w">            </span><span class="n">bTreeDeleteInternal</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-38-344" name="__codelineno-38-344" href="#__codelineno-38-344"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-345" name="__codelineno-38-345" href="#__codelineno-38-345"></a><span class="w">            </span><span class="n">bTreeDeleteInternal</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-38-346" name="__codelineno-38-346" href="#__codelineno-38-346"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-347" name="__codelineno-38-347" href="#__codelineno-38-347"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-348" name="__codelineno-38-348" href="#__codelineno-38-348"></a><span class="p">}</span>
<a id="__codelineno-38-349" name="__codelineno-38-349" href="#__codelineno-38-349"></a>
<a id="__codelineno-38-350" name="__codelineno-38-350" href="#__codelineno-38-350"></a><span class="c1">// Delete a key from B-Tree</span>
<a id="__codelineno-38-351" name="__codelineno-38-351" href="#__codelineno-38-351"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreeDelete</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">**</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-352" name="__codelineno-38-352" href="#__codelineno-38-352"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-38-353" name="__codelineno-38-353" href="#__codelineno-38-353"></a>
<a id="__codelineno-38-354" name="__codelineno-38-354" href="#__codelineno-38-354"></a><span class="w">    </span><span class="n">bTreeDeleteInternal</span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-38-355" name="__codelineno-38-355" href="#__codelineno-38-355"></a>
<a id="__codelineno-38-356" name="__codelineno-38-356" href="#__codelineno-38-356"></a><span class="w">    </span><span class="c1">// If root is empty after deletion, make its only child the new root</span>
<a id="__codelineno-38-357" name="__codelineno-38-357" href="#__codelineno-38-357"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-358" name="__codelineno-38-358" href="#__codelineno-38-358"></a><span class="w">        </span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-38-359" name="__codelineno-38-359" href="#__codelineno-38-359"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-360" name="__codelineno-38-360" href="#__codelineno-38-360"></a><span class="w">            </span><span class="o">*</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-38-361" name="__codelineno-38-361" href="#__codelineno-38-361"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-362" name="__codelineno-38-362" href="#__codelineno-38-362"></a><span class="w">            </span><span class="o">*</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">root</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-38-363" name="__codelineno-38-363" href="#__codelineno-38-363"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-364" name="__codelineno-38-364" href="#__codelineno-38-364"></a><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
<a id="__codelineno-38-365" name="__codelineno-38-365" href="#__codelineno-38-365"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-366" name="__codelineno-38-366" href="#__codelineno-38-366"></a><span class="p">}</span>
<a id="__codelineno-38-367" name="__codelineno-38-367" href="#__codelineno-38-367"></a>
<a id="__codelineno-38-368" name="__codelineno-38-368" href="#__codelineno-38-368"></a><span class="c1">// Print B-Tree (in-order traversal)</span>
<a id="__codelineno-38-369" name="__codelineno-38-369" href="#__codelineno-38-369"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bTreePrint</span><span class="p">(</span><span class="n">BTreeNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-370" name="__codelineno-38-370" href="#__codelineno-38-370"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-38-371" name="__codelineno-38-371" href="#__codelineno-38-371"></a>
<a id="__codelineno-38-372" name="__codelineno-38-372" href="#__codelineno-38-372"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<a id="__codelineno-38-373" name="__codelineno-38-373" href="#__codelineno-38-373"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-374" name="__codelineno-38-374" href="#__codelineno-38-374"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-375" name="__codelineno-38-375" href="#__codelineno-38-375"></a><span class="w">            </span><span class="n">bTreePrint</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-38-376" name="__codelineno-38-376" href="#__codelineno-38-376"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-38-377" name="__codelineno-38-377" href="#__codelineno-38-377"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">level</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;  &quot;</span><span class="p">);</span>
<a id="__codelineno-38-378" name="__codelineno-38-378" href="#__codelineno-38-378"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="__codelineno-38-379" name="__codelineno-38-379" href="#__codelineno-38-379"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-380" name="__codelineno-38-380" href="#__codelineno-38-380"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-38-381" name="__codelineno-38-381" href="#__codelineno-38-381"></a><span class="w">        </span><span class="n">bTreePrint</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-38-382" name="__codelineno-38-382" href="#__codelineno-38-382"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-38-383" name="__codelineno-38-383" href="#__codelineno-38-383"></a><span class="p">}</span>
</code></pre></div>
<h4 id="complete-b-tree-implementation_1">Complete B+ Tree Implementation</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="cp">#define ORDER 4  </span><span class="c1">// Maximum children per node</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="cp">#define MAX_KEYS (ORDER - 1)</span>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="cp">#define MIN_KEYS (ORDER / 2)</span>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="c1">// B+ Tree node structure</span>
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">BPlusNode</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">isLeaf</span><span class="p">;</span><span class="w">                          </span><span class="c1">// 1 if leaf, 0 if internal</span>
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">numKeys</span><span class="p">;</span><span class="w">                         </span><span class="c1">// Current number of keys</span>
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">keys</span><span class="p">[</span><span class="n">MAX_KEYS</span><span class="p">];</span><span class="w">                  </span><span class="c1">// Keys array</span>
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">[</span><span class="n">MAX_KEYS</span><span class="p">];</span><span class="w">                </span><span class="c1">// Data (only in leaf nodes)</span>
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">children</span><span class="p">[</span><span class="n">ORDER</span><span class="p">];</span><span class="w">   </span><span class="c1">// Children (only in internal nodes)</span>
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">next</span><span class="p">;</span><span class="w">              </span><span class="c1">// Next leaf (linked list)</span>
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">prev</span><span class="p">;</span><span class="w">              </span><span class="c1">// Previous leaf (doubly-linked)</span>
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a><span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">;</span><span class="w">            </span><span class="c1">// Parent pointer (for splits)</span>
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="p">}</span><span class="w"> </span><span class="n">BPlusNode</span><span class="p">;</span>
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a>
<a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a><span class="c1">// B+ Tree structure</span>
<a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">BPlusTree</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">firstLeaf</span><span class="p">;</span><span class="w">  </span><span class="c1">// Pointer to leftmost leaf for sequential scan</span>
<a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a><span class="p">}</span><span class="w"> </span><span class="n">BPlusTree</span><span class="p">;</span>
<a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a>
<a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a><span class="c1">// Create a new B+ Tree node</span>
<a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a><span class="n">BPlusNode</span><span class="o">*</span><span class="w"> </span><span class="nf">createBPlusNode</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-29" name="__codelineno-39-29" href="#__codelineno-39-29"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BPlusNode</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">BPlusNode</span><span class="p">));</span>
<a id="__codelineno-39-30" name="__codelineno-39-30" href="#__codelineno-39-30"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isLeaf</span><span class="p">;</span>
<a id="__codelineno-39-31" name="__codelineno-39-31" href="#__codelineno-39-31"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-32" name="__codelineno-39-32" href="#__codelineno-39-32"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-33" name="__codelineno-39-33" href="#__codelineno-39-33"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-34" name="__codelineno-39-34" href="#__codelineno-39-34"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-35" name="__codelineno-39-35" href="#__codelineno-39-35"></a>
<a id="__codelineno-39-36" name="__codelineno-39-36" href="#__codelineno-39-36"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ORDER</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-37" name="__codelineno-39-37" href="#__codelineno-39-37"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-38" name="__codelineno-39-38" href="#__codelineno-39-38"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-39" name="__codelineno-39-39" href="#__codelineno-39-39"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MAX_KEYS</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-40" name="__codelineno-39-40" href="#__codelineno-39-40"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-41" name="__codelineno-39-41" href="#__codelineno-39-41"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-42" name="__codelineno-39-42" href="#__codelineno-39-42"></a>
<a id="__codelineno-39-43" name="__codelineno-39-43" href="#__codelineno-39-43"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-39-44" name="__codelineno-39-44" href="#__codelineno-39-44"></a><span class="p">}</span>
<a id="__codelineno-39-45" name="__codelineno-39-45" href="#__codelineno-39-45"></a>
<a id="__codelineno-39-46" name="__codelineno-39-46" href="#__codelineno-39-46"></a><span class="c1">// Create a new B+ Tree</span>
<a id="__codelineno-39-47" name="__codelineno-39-47" href="#__codelineno-39-47"></a><span class="n">BPlusTree</span><span class="o">*</span><span class="w"> </span><span class="nf">createBPlusTree</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-48" name="__codelineno-39-48" href="#__codelineno-39-48"></a><span class="w">    </span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BPlusTree</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">BPlusTree</span><span class="p">));</span>
<a id="__codelineno-39-49" name="__codelineno-39-49" href="#__codelineno-39-49"></a><span class="w">    </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-50" name="__codelineno-39-50" href="#__codelineno-39-50"></a><span class="w">    </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">firstLeaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-51" name="__codelineno-39-51" href="#__codelineno-39-51"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<a id="__codelineno-39-52" name="__codelineno-39-52" href="#__codelineno-39-52"></a><span class="p">}</span>
<a id="__codelineno-39-53" name="__codelineno-39-53" href="#__codelineno-39-53"></a>
<a id="__codelineno-39-54" name="__codelineno-39-54" href="#__codelineno-39-54"></a><span class="c1">// Search for a key in B+ Tree (always goes to leaf)</span>
<a id="__codelineno-39-55" name="__codelineno-39-55" href="#__codelineno-39-55"></a><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="nf">bPlusSearch</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-56" name="__codelineno-39-56" href="#__codelineno-39-56"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-57" name="__codelineno-39-57" href="#__codelineno-39-57"></a>
<a id="__codelineno-39-58" name="__codelineno-39-58" href="#__codelineno-39-58"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-39-59" name="__codelineno-39-59" href="#__codelineno-39-59"></a>
<a id="__codelineno-39-60" name="__codelineno-39-60" href="#__codelineno-39-60"></a><span class="w">    </span><span class="c1">// Traverse down to leaf level</span>
<a id="__codelineno-39-61" name="__codelineno-39-61" href="#__codelineno-39-61"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-62" name="__codelineno-39-62" href="#__codelineno-39-62"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-63" name="__codelineno-39-63" href="#__codelineno-39-63"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-64" name="__codelineno-39-64" href="#__codelineno-39-64"></a><span class="w">            </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-65" name="__codelineno-39-65" href="#__codelineno-39-65"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-66" name="__codelineno-39-66" href="#__codelineno-39-66"></a><span class="w">        </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-67" name="__codelineno-39-67" href="#__codelineno-39-67"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-68" name="__codelineno-39-68" href="#__codelineno-39-68"></a>
<a id="__codelineno-39-69" name="__codelineno-39-69" href="#__codelineno-39-69"></a><span class="w">    </span><span class="c1">// Search in leaf node</span>
<a id="__codelineno-39-70" name="__codelineno-39-70" href="#__codelineno-39-70"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-71" name="__codelineno-39-71" href="#__codelineno-39-71"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-72" name="__codelineno-39-72" href="#__codelineno-39-72"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-73" name="__codelineno-39-73" href="#__codelineno-39-73"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-74" name="__codelineno-39-74" href="#__codelineno-39-74"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-75" name="__codelineno-39-75" href="#__codelineno-39-75"></a>
<a id="__codelineno-39-76" name="__codelineno-39-76" href="#__codelineno-39-76"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w">  </span><span class="c1">// Not found</span>
<a id="__codelineno-39-77" name="__codelineno-39-77" href="#__codelineno-39-77"></a><span class="p">}</span>
<a id="__codelineno-39-78" name="__codelineno-39-78" href="#__codelineno-39-78"></a>
<a id="__codelineno-39-79" name="__codelineno-39-79" href="#__codelineno-39-79"></a><span class="c1">// Range query: Returns all keys between keyStart and keyEnd</span>
<a id="__codelineno-39-80" name="__codelineno-39-80" href="#__codelineno-39-80"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusRangeQuery</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">keyStart</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">keyEnd</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-39-81" name="__codelineno-39-81" href="#__codelineno-39-81"></a><span class="w">                     </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">callback</span><span class="p">)(</span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-82" name="__codelineno-39-82" href="#__codelineno-39-82"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-39-83" name="__codelineno-39-83" href="#__codelineno-39-83"></a>
<a id="__codelineno-39-84" name="__codelineno-39-84" href="#__codelineno-39-84"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-39-85" name="__codelineno-39-85" href="#__codelineno-39-85"></a>
<a id="__codelineno-39-86" name="__codelineno-39-86" href="#__codelineno-39-86"></a><span class="w">    </span><span class="c1">// Find starting leaf</span>
<a id="__codelineno-39-87" name="__codelineno-39-87" href="#__codelineno-39-87"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-88" name="__codelineno-39-88" href="#__codelineno-39-88"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-89" name="__codelineno-39-89" href="#__codelineno-39-89"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">keyStart</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-90" name="__codelineno-39-90" href="#__codelineno-39-90"></a><span class="w">            </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-91" name="__codelineno-39-91" href="#__codelineno-39-91"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-92" name="__codelineno-39-92" href="#__codelineno-39-92"></a><span class="w">        </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-93" name="__codelineno-39-93" href="#__codelineno-39-93"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-94" name="__codelineno-39-94" href="#__codelineno-39-94"></a>
<a id="__codelineno-39-95" name="__codelineno-39-95" href="#__codelineno-39-95"></a><span class="w">    </span><span class="c1">// Scan leaf nodes using linked list</span>
<a id="__codelineno-39-96" name="__codelineno-39-96" href="#__codelineno-39-96"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">current</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-97" name="__codelineno-39-97" href="#__codelineno-39-97"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-98" name="__codelineno-39-98" href="#__codelineno-39-98"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">keyStart</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">keyEnd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-99" name="__codelineno-39-99" href="#__codelineno-39-99"></a><span class="w">                </span><span class="n">callback</span><span class="p">(</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="__codelineno-39-100" name="__codelineno-39-100" href="#__codelineno-39-100"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-39-101" name="__codelineno-39-101" href="#__codelineno-39-101"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">keyEnd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-102" name="__codelineno-39-102" href="#__codelineno-39-102"></a><span class="w">                </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-39-103" name="__codelineno-39-103" href="#__codelineno-39-103"></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-39-104" name="__codelineno-39-104" href="#__codelineno-39-104"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-105" name="__codelineno-39-105" href="#__codelineno-39-105"></a><span class="w">        </span><span class="n">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">current</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span><span class="w">  </span><span class="c1">// Follow leaf link</span>
<a id="__codelineno-39-106" name="__codelineno-39-106" href="#__codelineno-39-106"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-107" name="__codelineno-39-107" href="#__codelineno-39-107"></a><span class="p">}</span>
<a id="__codelineno-39-108" name="__codelineno-39-108" href="#__codelineno-39-108"></a>
<a id="__codelineno-39-109" name="__codelineno-39-109" href="#__codelineno-39-109"></a><span class="c1">// Find leaf node where key should be inserted</span>
<a id="__codelineno-39-110" name="__codelineno-39-110" href="#__codelineno-39-110"></a><span class="n">BPlusNode</span><span class="o">*</span><span class="w"> </span><span class="nf">bPlusFindLeaf</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-111" name="__codelineno-39-111" href="#__codelineno-39-111"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-112" name="__codelineno-39-112" href="#__codelineno-39-112"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-39-113" name="__codelineno-39-113" href="#__codelineno-39-113"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-114" name="__codelineno-39-114" href="#__codelineno-39-114"></a>
<a id="__codelineno-39-115" name="__codelineno-39-115" href="#__codelineno-39-115"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-116" name="__codelineno-39-116" href="#__codelineno-39-116"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-117" name="__codelineno-39-117" href="#__codelineno-39-117"></a><span class="w">        </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-118" name="__codelineno-39-118" href="#__codelineno-39-118"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-119" name="__codelineno-39-119" href="#__codelineno-39-119"></a>
<a id="__codelineno-39-120" name="__codelineno-39-120" href="#__codelineno-39-120"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">bPlusFindLeaf</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-39-121" name="__codelineno-39-121" href="#__codelineno-39-121"></a><span class="p">}</span>
<a id="__codelineno-39-122" name="__codelineno-39-122" href="#__codelineno-39-122"></a>
<a id="__codelineno-39-123" name="__codelineno-39-123" href="#__codelineno-39-123"></a><span class="c1">// Insert into a leaf node</span>
<a id="__codelineno-39-124" name="__codelineno-39-124" href="#__codelineno-39-124"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusInsertIntoLeaf</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-125" name="__codelineno-39-125" href="#__codelineno-39-125"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-39-126" name="__codelineno-39-126" href="#__codelineno-39-126"></a>
<a id="__codelineno-39-127" name="__codelineno-39-127" href="#__codelineno-39-127"></a><span class="w">    </span><span class="c1">// Shift keys and data to make space</span>
<a id="__codelineno-39-128" name="__codelineno-39-128" href="#__codelineno-39-128"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-129" name="__codelineno-39-129" href="#__codelineno-39-129"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-130" name="__codelineno-39-130" href="#__codelineno-39-130"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-131" name="__codelineno-39-131" href="#__codelineno-39-131"></a><span class="w">        </span><span class="n">i</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-39-132" name="__codelineno-39-132" href="#__codelineno-39-132"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-133" name="__codelineno-39-133" href="#__codelineno-39-133"></a>
<a id="__codelineno-39-134" name="__codelineno-39-134" href="#__codelineno-39-134"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-135" name="__codelineno-39-135" href="#__codelineno-39-135"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="__codelineno-39-136" name="__codelineno-39-136" href="#__codelineno-39-136"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-137" name="__codelineno-39-137" href="#__codelineno-39-137"></a><span class="p">}</span>
<a id="__codelineno-39-138" name="__codelineno-39-138" href="#__codelineno-39-138"></a>
<a id="__codelineno-39-139" name="__codelineno-39-139" href="#__codelineno-39-139"></a><span class="c1">// Split a leaf node</span>
<a id="__codelineno-39-140" name="__codelineno-39-140" href="#__codelineno-39-140"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusSplitLeaf</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-141" name="__codelineno-39-141" href="#__codelineno-39-141"></a><span class="w">    </span><span class="c1">// Create new leaf</span>
<a id="__codelineno-39-142" name="__codelineno-39-142" href="#__codelineno-39-142"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">newLeaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBPlusNode</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-39-143" name="__codelineno-39-143" href="#__codelineno-39-143"></a>
<a id="__codelineno-39-144" name="__codelineno-39-144" href="#__codelineno-39-144"></a><span class="w">    </span><span class="c1">// Temporary arrays for sorting</span>
<a id="__codelineno-39-145" name="__codelineno-39-145" href="#__codelineno-39-145"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">ORDER</span><span class="p">];</span>
<a id="__codelineno-39-146" name="__codelineno-39-146" href="#__codelineno-39-146"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">tempData</span><span class="p">[</span><span class="n">ORDER</span><span class="p">];</span>
<a id="__codelineno-39-147" name="__codelineno-39-147" href="#__codelineno-39-147"></a>
<a id="__codelineno-39-148" name="__codelineno-39-148" href="#__codelineno-39-148"></a><span class="w">    </span><span class="c1">// Copy existing keys and insert new key in sorted order</span>
<a id="__codelineno-39-149" name="__codelineno-39-149" href="#__codelineno-39-149"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-150" name="__codelineno-39-150" href="#__codelineno-39-150"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-151" name="__codelineno-39-151" href="#__codelineno-39-151"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-152" name="__codelineno-39-152" href="#__codelineno-39-152"></a><span class="w">            </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-153" name="__codelineno-39-153" href="#__codelineno-39-153"></a><span class="w">            </span><span class="n">tempData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="__codelineno-39-154" name="__codelineno-39-154" href="#__codelineno-39-154"></a><span class="w">            </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-155" name="__codelineno-39-155" href="#__codelineno-39-155"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-156" name="__codelineno-39-156" href="#__codelineno-39-156"></a><span class="w">        </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<a id="__codelineno-39-157" name="__codelineno-39-157" href="#__codelineno-39-157"></a><span class="w">        </span><span class="n">tempData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<a id="__codelineno-39-158" name="__codelineno-39-158" href="#__codelineno-39-158"></a><span class="w">        </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-159" name="__codelineno-39-159" href="#__codelineno-39-159"></a><span class="w">        </span><span class="n">j</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-160" name="__codelineno-39-160" href="#__codelineno-39-160"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-161" name="__codelineno-39-161" href="#__codelineno-39-161"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-162" name="__codelineno-39-162" href="#__codelineno-39-162"></a><span class="w">        </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-163" name="__codelineno-39-163" href="#__codelineno-39-163"></a><span class="w">        </span><span class="n">tempData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="__codelineno-39-164" name="__codelineno-39-164" href="#__codelineno-39-164"></a><span class="w">        </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-165" name="__codelineno-39-165" href="#__codelineno-39-165"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-166" name="__codelineno-39-166" href="#__codelineno-39-166"></a>
<a id="__codelineno-39-167" name="__codelineno-39-167" href="#__codelineno-39-167"></a><span class="w">    </span><span class="c1">// Split point</span>
<a id="__codelineno-39-168" name="__codelineno-39-168" href="#__codelineno-39-168"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ORDER</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<a id="__codelineno-39-169" name="__codelineno-39-169" href="#__codelineno-39-169"></a>
<a id="__codelineno-39-170" name="__codelineno-39-170" href="#__codelineno-39-170"></a><span class="w">    </span><span class="c1">// First half stays in original leaf</span>
<a id="__codelineno-39-171" name="__codelineno-39-171" href="#__codelineno-39-171"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">;</span>
<a id="__codelineno-39-172" name="__codelineno-39-172" href="#__codelineno-39-172"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">split</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-173" name="__codelineno-39-173" href="#__codelineno-39-173"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-174" name="__codelineno-39-174" href="#__codelineno-39-174"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempData</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-175" name="__codelineno-39-175" href="#__codelineno-39-175"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-176" name="__codelineno-39-176" href="#__codelineno-39-176"></a>
<a id="__codelineno-39-177" name="__codelineno-39-177" href="#__codelineno-39-177"></a><span class="w">    </span><span class="c1">// Second half goes to new leaf</span>
<a id="__codelineno-39-178" name="__codelineno-39-178" href="#__codelineno-39-178"></a><span class="w">    </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ORDER</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">split</span><span class="p">;</span>
<a id="__codelineno-39-179" name="__codelineno-39-179" href="#__codelineno-39-179"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ORDER</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-180" name="__codelineno-39-180" href="#__codelineno-39-180"></a><span class="w">        </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-181" name="__codelineno-39-181" href="#__codelineno-39-181"></a><span class="w">        </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempData</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-182" name="__codelineno-39-182" href="#__codelineno-39-182"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-183" name="__codelineno-39-183" href="#__codelineno-39-183"></a>
<a id="__codelineno-39-184" name="__codelineno-39-184" href="#__codelineno-39-184"></a><span class="w">    </span><span class="c1">// Update leaf links</span>
<a id="__codelineno-39-185" name="__codelineno-39-185" href="#__codelineno-39-185"></a><span class="w">    </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<a id="__codelineno-39-186" name="__codelineno-39-186" href="#__codelineno-39-186"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-187" name="__codelineno-39-187" href="#__codelineno-39-187"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newLeaf</span><span class="p">;</span>
<a id="__codelineno-39-188" name="__codelineno-39-188" href="#__codelineno-39-188"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-189" name="__codelineno-39-189" href="#__codelineno-39-189"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newLeaf</span><span class="p">;</span>
<a id="__codelineno-39-190" name="__codelineno-39-190" href="#__codelineno-39-190"></a><span class="w">    </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="p">;</span>
<a id="__codelineno-39-191" name="__codelineno-39-191" href="#__codelineno-39-191"></a>
<a id="__codelineno-39-192" name="__codelineno-39-192" href="#__codelineno-39-192"></a><span class="w">    </span><span class="c1">// Insert into parent</span>
<a id="__codelineno-39-193" name="__codelineno-39-193" href="#__codelineno-39-193"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">newKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-39-194" name="__codelineno-39-194" href="#__codelineno-39-194"></a>
<a id="__codelineno-39-195" name="__codelineno-39-195" href="#__codelineno-39-195"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-196" name="__codelineno-39-196" href="#__codelineno-39-196"></a><span class="w">        </span><span class="c1">// Create new root</span>
<a id="__codelineno-39-197" name="__codelineno-39-197" href="#__codelineno-39-197"></a><span class="w">        </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">newRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBPlusNode</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-39-198" name="__codelineno-39-198" href="#__codelineno-39-198"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newKey</span><span class="p">;</span>
<a id="__codelineno-39-199" name="__codelineno-39-199" href="#__codelineno-39-199"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="p">;</span>
<a id="__codelineno-39-200" name="__codelineno-39-200" href="#__codelineno-39-200"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newLeaf</span><span class="p">;</span>
<a id="__codelineno-39-201" name="__codelineno-39-201" href="#__codelineno-39-201"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-39-202" name="__codelineno-39-202" href="#__codelineno-39-202"></a>
<a id="__codelineno-39-203" name="__codelineno-39-203" href="#__codelineno-39-203"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-39-204" name="__codelineno-39-204" href="#__codelineno-39-204"></a><span class="w">        </span><span class="n">newLeaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-39-205" name="__codelineno-39-205" href="#__codelineno-39-205"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-39-206" name="__codelineno-39-206" href="#__codelineno-39-206"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-207" name="__codelineno-39-207" href="#__codelineno-39-207"></a><span class="w">        </span><span class="n">bPlusInsertIntoParent</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">newKey</span><span class="p">,</span><span class="w"> </span><span class="n">newLeaf</span><span class="p">);</span>
<a id="__codelineno-39-208" name="__codelineno-39-208" href="#__codelineno-39-208"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-209" name="__codelineno-39-209" href="#__codelineno-39-209"></a><span class="p">}</span>
<a id="__codelineno-39-210" name="__codelineno-39-210" href="#__codelineno-39-210"></a>
<a id="__codelineno-39-211" name="__codelineno-39-211" href="#__codelineno-39-211"></a><span class="c1">// Insert into internal node</span>
<a id="__codelineno-39-212" name="__codelineno-39-212" href="#__codelineno-39-212"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusInsertIntoNode</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">rightChild</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-213" name="__codelineno-39-213" href="#__codelineno-39-213"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-39-214" name="__codelineno-39-214" href="#__codelineno-39-214"></a>
<a id="__codelineno-39-215" name="__codelineno-39-215" href="#__codelineno-39-215"></a><span class="w">    </span><span class="c1">// Shift keys and children to make space</span>
<a id="__codelineno-39-216" name="__codelineno-39-216" href="#__codelineno-39-216"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-217" name="__codelineno-39-217" href="#__codelineno-39-217"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-218" name="__codelineno-39-218" href="#__codelineno-39-218"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-219" name="__codelineno-39-219" href="#__codelineno-39-219"></a><span class="w">        </span><span class="n">i</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-39-220" name="__codelineno-39-220" href="#__codelineno-39-220"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-221" name="__codelineno-39-221" href="#__codelineno-39-221"></a>
<a id="__codelineno-39-222" name="__codelineno-39-222" href="#__codelineno-39-222"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-223" name="__codelineno-39-223" href="#__codelineno-39-223"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightChild</span><span class="p">;</span>
<a id="__codelineno-39-224" name="__codelineno-39-224" href="#__codelineno-39-224"></a><span class="w">    </span><span class="n">rightChild</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-39-225" name="__codelineno-39-225" href="#__codelineno-39-225"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-226" name="__codelineno-39-226" href="#__codelineno-39-226"></a><span class="p">}</span>
<a id="__codelineno-39-227" name="__codelineno-39-227" href="#__codelineno-39-227"></a>
<a id="__codelineno-39-228" name="__codelineno-39-228" href="#__codelineno-39-228"></a><span class="c1">// Split internal node</span>
<a id="__codelineno-39-229" name="__codelineno-39-229" href="#__codelineno-39-229"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusSplitInternal</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">rightChild</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-230" name="__codelineno-39-230" href="#__codelineno-39-230"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">newNode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBPlusNode</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-39-231" name="__codelineno-39-231" href="#__codelineno-39-231"></a>
<a id="__codelineno-39-232" name="__codelineno-39-232" href="#__codelineno-39-232"></a><span class="w">    </span><span class="c1">// Temporary arrays</span>
<a id="__codelineno-39-233" name="__codelineno-39-233" href="#__codelineno-39-233"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">ORDER</span><span class="p">];</span>
<a id="__codelineno-39-234" name="__codelineno-39-234" href="#__codelineno-39-234"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">tempChildren</span><span class="p">[</span><span class="n">ORDER</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-235" name="__codelineno-39-235" href="#__codelineno-39-235"></a>
<a id="__codelineno-39-236" name="__codelineno-39-236" href="#__codelineno-39-236"></a><span class="w">    </span><span class="c1">// Copy existing and insert new in sorted order</span>
<a id="__codelineno-39-237" name="__codelineno-39-237" href="#__codelineno-39-237"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-238" name="__codelineno-39-238" href="#__codelineno-39-238"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-239" name="__codelineno-39-239" href="#__codelineno-39-239"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-240" name="__codelineno-39-240" href="#__codelineno-39-240"></a><span class="w">            </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-241" name="__codelineno-39-241" href="#__codelineno-39-241"></a><span class="w">            </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightChild</span><span class="p">;</span>
<a id="__codelineno-39-242" name="__codelineno-39-242" href="#__codelineno-39-242"></a><span class="w">            </span><span class="n">j</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-243" name="__codelineno-39-243" href="#__codelineno-39-243"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-244" name="__codelineno-39-244" href="#__codelineno-39-244"></a><span class="w">        </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-245" name="__codelineno-39-245" href="#__codelineno-39-245"></a><span class="w">        </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-246" name="__codelineno-39-246" href="#__codelineno-39-246"></a><span class="w">        </span><span class="n">j</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-247" name="__codelineno-39-247" href="#__codelineno-39-247"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-248" name="__codelineno-39-248" href="#__codelineno-39-248"></a><span class="w">    </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-249" name="__codelineno-39-249" href="#__codelineno-39-249"></a>
<a id="__codelineno-39-250" name="__codelineno-39-250" href="#__codelineno-39-250"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-251" name="__codelineno-39-251" href="#__codelineno-39-251"></a><span class="w">        </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-252" name="__codelineno-39-252" href="#__codelineno-39-252"></a><span class="w">        </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightChild</span><span class="p">;</span>
<a id="__codelineno-39-253" name="__codelineno-39-253" href="#__codelineno-39-253"></a><span class="w">        </span><span class="n">j</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-254" name="__codelineno-39-254" href="#__codelineno-39-254"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-255" name="__codelineno-39-255" href="#__codelineno-39-255"></a>
<a id="__codelineno-39-256" name="__codelineno-39-256" href="#__codelineno-39-256"></a><span class="w">    </span><span class="c1">// Split point</span>
<a id="__codelineno-39-257" name="__codelineno-39-257" href="#__codelineno-39-257"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ORDER</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<a id="__codelineno-39-258" name="__codelineno-39-258" href="#__codelineno-39-258"></a>
<a id="__codelineno-39-259" name="__codelineno-39-259" href="#__codelineno-39-259"></a><span class="w">    </span><span class="c1">// First half</span>
<a id="__codelineno-39-260" name="__codelineno-39-260" href="#__codelineno-39-260"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="p">;</span>
<a id="__codelineno-39-261" name="__codelineno-39-261" href="#__codelineno-39-261"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">split</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-262" name="__codelineno-39-262" href="#__codelineno-39-262"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-263" name="__codelineno-39-263" href="#__codelineno-39-263"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-264" name="__codelineno-39-264" href="#__codelineno-39-264"></a><span class="w">        </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-39-265" name="__codelineno-39-265" href="#__codelineno-39-265"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-266" name="__codelineno-39-266" href="#__codelineno-39-266"></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-267" name="__codelineno-39-267" href="#__codelineno-39-267"></a><span class="w">    </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-39-268" name="__codelineno-39-268" href="#__codelineno-39-268"></a>
<a id="__codelineno-39-269" name="__codelineno-39-269" href="#__codelineno-39-269"></a><span class="w">    </span><span class="c1">// Second half</span>
<a id="__codelineno-39-270" name="__codelineno-39-270" href="#__codelineno-39-270"></a><span class="w">    </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ORDER</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-39-271" name="__codelineno-39-271" href="#__codelineno-39-271"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">split</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ORDER</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-272" name="__codelineno-39-272" href="#__codelineno-39-272"></a><span class="w">        </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-273" name="__codelineno-39-273" href="#__codelineno-39-273"></a><span class="w">        </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-274" name="__codelineno-39-274" href="#__codelineno-39-274"></a><span class="w">        </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">;</span>
<a id="__codelineno-39-275" name="__codelineno-39-275" href="#__codelineno-39-275"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-276" name="__codelineno-39-276" href="#__codelineno-39-276"></a><span class="w">    </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-277" name="__codelineno-39-277" href="#__codelineno-39-277"></a><span class="w">    </span><span class="n">tempChildren</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">;</span>
<a id="__codelineno-39-278" name="__codelineno-39-278" href="#__codelineno-39-278"></a>
<a id="__codelineno-39-279" name="__codelineno-39-279" href="#__codelineno-39-279"></a><span class="w">    </span><span class="c1">// Key to move up</span>
<a id="__codelineno-39-280" name="__codelineno-39-280" href="#__codelineno-39-280"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">upKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempKeys</span><span class="p">[</span><span class="n">split</span><span class="p">];</span>
<a id="__codelineno-39-281" name="__codelineno-39-281" href="#__codelineno-39-281"></a>
<a id="__codelineno-39-282" name="__codelineno-39-282" href="#__codelineno-39-282"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-283" name="__codelineno-39-283" href="#__codelineno-39-283"></a><span class="w">        </span><span class="c1">// Create new root</span>
<a id="__codelineno-39-284" name="__codelineno-39-284" href="#__codelineno-39-284"></a><span class="w">        </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">newRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBPlusNode</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-39-285" name="__codelineno-39-285" href="#__codelineno-39-285"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upKey</span><span class="p">;</span>
<a id="__codelineno-39-286" name="__codelineno-39-286" href="#__codelineno-39-286"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-39-287" name="__codelineno-39-287" href="#__codelineno-39-287"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newNode</span><span class="p">;</span>
<a id="__codelineno-39-288" name="__codelineno-39-288" href="#__codelineno-39-288"></a><span class="w">        </span><span class="n">newRoot</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-39-289" name="__codelineno-39-289" href="#__codelineno-39-289"></a>
<a id="__codelineno-39-290" name="__codelineno-39-290" href="#__codelineno-39-290"></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-39-291" name="__codelineno-39-291" href="#__codelineno-39-291"></a><span class="w">        </span><span class="n">newNode</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-39-292" name="__codelineno-39-292" href="#__codelineno-39-292"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newRoot</span><span class="p">;</span>
<a id="__codelineno-39-293" name="__codelineno-39-293" href="#__codelineno-39-293"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-294" name="__codelineno-39-294" href="#__codelineno-39-294"></a><span class="w">        </span><span class="n">bPlusInsertIntoParent</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">upKey</span><span class="p">,</span><span class="w"> </span><span class="n">newNode</span><span class="p">);</span>
<a id="__codelineno-39-295" name="__codelineno-39-295" href="#__codelineno-39-295"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-296" name="__codelineno-39-296" href="#__codelineno-39-296"></a><span class="p">}</span>
<a id="__codelineno-39-297" name="__codelineno-39-297" href="#__codelineno-39-297"></a>
<a id="__codelineno-39-298" name="__codelineno-39-298" href="#__codelineno-39-298"></a><span class="c1">// Insert into parent (handles splits)</span>
<a id="__codelineno-39-299" name="__codelineno-39-299" href="#__codelineno-39-299"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusInsertIntoParent</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">rightChild</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-300" name="__codelineno-39-300" href="#__codelineno-39-300"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MAX_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-301" name="__codelineno-39-301" href="#__codelineno-39-301"></a><span class="w">        </span><span class="n">bPlusInsertIntoNode</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">rightChild</span><span class="p">);</span>
<a id="__codelineno-39-302" name="__codelineno-39-302" href="#__codelineno-39-302"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-303" name="__codelineno-39-303" href="#__codelineno-39-303"></a><span class="w">        </span><span class="n">bPlusSplitInternal</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">rightChild</span><span class="p">);</span>
<a id="__codelineno-39-304" name="__codelineno-39-304" href="#__codelineno-39-304"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-305" name="__codelineno-39-305" href="#__codelineno-39-305"></a><span class="p">}</span>
<a id="__codelineno-39-306" name="__codelineno-39-306" href="#__codelineno-39-306"></a>
<a id="__codelineno-39-307" name="__codelineno-39-307" href="#__codelineno-39-307"></a><span class="c1">// Main insert function</span>
<a id="__codelineno-39-308" name="__codelineno-39-308" href="#__codelineno-39-308"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusInsert</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-309" name="__codelineno-39-309" href="#__codelineno-39-309"></a><span class="w">    </span><span class="c1">// Empty tree</span>
<a id="__codelineno-39-310" name="__codelineno-39-310" href="#__codelineno-39-310"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-311" name="__codelineno-39-311" href="#__codelineno-39-311"></a><span class="w">        </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBPlusNode</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-39-312" name="__codelineno-39-312" href="#__codelineno-39-312"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-39-313" name="__codelineno-39-313" href="#__codelineno-39-313"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<a id="__codelineno-39-314" name="__codelineno-39-314" href="#__codelineno-39-314"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-39-315" name="__codelineno-39-315" href="#__codelineno-39-315"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="p">;</span>
<a id="__codelineno-39-316" name="__codelineno-39-316" href="#__codelineno-39-316"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">firstLeaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="p">;</span>
<a id="__codelineno-39-317" name="__codelineno-39-317" href="#__codelineno-39-317"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-39-318" name="__codelineno-39-318" href="#__codelineno-39-318"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-319" name="__codelineno-39-319" href="#__codelineno-39-319"></a>
<a id="__codelineno-39-320" name="__codelineno-39-320" href="#__codelineno-39-320"></a><span class="w">    </span><span class="c1">// Find leaf to insert</span>
<a id="__codelineno-39-321" name="__codelineno-39-321" href="#__codelineno-39-321"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bPlusFindLeaf</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-39-322" name="__codelineno-39-322" href="#__codelineno-39-322"></a>
<a id="__codelineno-39-323" name="__codelineno-39-323" href="#__codelineno-39-323"></a><span class="w">    </span><span class="c1">// If leaf has space</span>
<a id="__codelineno-39-324" name="__codelineno-39-324" href="#__codelineno-39-324"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MAX_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-325" name="__codelineno-39-325" href="#__codelineno-39-325"></a><span class="w">        </span><span class="n">bPlusInsertIntoLeaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<a id="__codelineno-39-326" name="__codelineno-39-326" href="#__codelineno-39-326"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-327" name="__codelineno-39-327" href="#__codelineno-39-327"></a><span class="w">        </span><span class="c1">// Split leaf</span>
<a id="__codelineno-39-328" name="__codelineno-39-328" href="#__codelineno-39-328"></a><span class="w">        </span><span class="n">bPlusSplitLeaf</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">);</span>
<a id="__codelineno-39-329" name="__codelineno-39-329" href="#__codelineno-39-329"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-330" name="__codelineno-39-330" href="#__codelineno-39-330"></a><span class="p">}</span>
<a id="__codelineno-39-331" name="__codelineno-39-331" href="#__codelineno-39-331"></a>
<a id="__codelineno-39-332" name="__codelineno-39-332" href="#__codelineno-39-332"></a><span class="c1">// Delete from leaf</span>
<a id="__codelineno-39-333" name="__codelineno-39-333" href="#__codelineno-39-333"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusDeleteFromLeaf</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-334" name="__codelineno-39-334" href="#__codelineno-39-334"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-335" name="__codelineno-39-335" href="#__codelineno-39-335"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-336" name="__codelineno-39-336" href="#__codelineno-39-336"></a><span class="w">        </span><span class="n">i</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-337" name="__codelineno-39-337" href="#__codelineno-39-337"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-338" name="__codelineno-39-338" href="#__codelineno-39-338"></a>
<a id="__codelineno-39-339" name="__codelineno-39-339" href="#__codelineno-39-339"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span><span class="w">  </span><span class="c1">// Key not found</span>
<a id="__codelineno-39-340" name="__codelineno-39-340" href="#__codelineno-39-340"></a>
<a id="__codelineno-39-341" name="__codelineno-39-341" href="#__codelineno-39-341"></a><span class="w">    </span><span class="c1">// Shift keys and data</span>
<a id="__codelineno-39-342" name="__codelineno-39-342" href="#__codelineno-39-342"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-343" name="__codelineno-39-343" href="#__codelineno-39-343"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-344" name="__codelineno-39-344" href="#__codelineno-39-344"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-345" name="__codelineno-39-345" href="#__codelineno-39-345"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-346" name="__codelineno-39-346" href="#__codelineno-39-346"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-39-347" name="__codelineno-39-347" href="#__codelineno-39-347"></a><span class="p">}</span>
<a id="__codelineno-39-348" name="__codelineno-39-348" href="#__codelineno-39-348"></a>
<a id="__codelineno-39-349" name="__codelineno-39-349" href="#__codelineno-39-349"></a><span class="c1">// Borrow from left sibling (leaf)</span>
<a id="__codelineno-39-350" name="__codelineno-39-350" href="#__codelineno-39-350"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusBorrowFromLeftLeaf</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leftSibling</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">parentIdx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-351" name="__codelineno-39-351" href="#__codelineno-39-351"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-39-352" name="__codelineno-39-352" href="#__codelineno-39-352"></a>
<a id="__codelineno-39-353" name="__codelineno-39-353" href="#__codelineno-39-353"></a><span class="w">    </span><span class="c1">// Shift all keys in leaf to the right</span>
<a id="__codelineno-39-354" name="__codelineno-39-354" href="#__codelineno-39-354"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-355" name="__codelineno-39-355" href="#__codelineno-39-355"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-356" name="__codelineno-39-356" href="#__codelineno-39-356"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-357" name="__codelineno-39-357" href="#__codelineno-39-357"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-358" name="__codelineno-39-358" href="#__codelineno-39-358"></a>
<a id="__codelineno-39-359" name="__codelineno-39-359" href="#__codelineno-39-359"></a><span class="w">    </span><span class="c1">// Move last key from left sibling to first position of leaf</span>
<a id="__codelineno-39-360" name="__codelineno-39-360" href="#__codelineno-39-360"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-361" name="__codelineno-39-361" href="#__codelineno-39-361"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-362" name="__codelineno-39-362" href="#__codelineno-39-362"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-363" name="__codelineno-39-363" href="#__codelineno-39-363"></a><span class="w">    </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-39-364" name="__codelineno-39-364" href="#__codelineno-39-364"></a>
<a id="__codelineno-39-365" name="__codelineno-39-365" href="#__codelineno-39-365"></a><span class="w">    </span><span class="c1">// Update parent key</span>
<a id="__codelineno-39-366" name="__codelineno-39-366" href="#__codelineno-39-366"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">parentIdx</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-39-367" name="__codelineno-39-367" href="#__codelineno-39-367"></a><span class="p">}</span>
<a id="__codelineno-39-368" name="__codelineno-39-368" href="#__codelineno-39-368"></a>
<a id="__codelineno-39-369" name="__codelineno-39-369" href="#__codelineno-39-369"></a><span class="c1">// Borrow from right sibling (leaf)</span>
<a id="__codelineno-39-370" name="__codelineno-39-370" href="#__codelineno-39-370"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusBorrowFromRightLeaf</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">rightSibling</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">parentIdx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-371" name="__codelineno-39-371" href="#__codelineno-39-371"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-39-372" name="__codelineno-39-372" href="#__codelineno-39-372"></a>
<a id="__codelineno-39-373" name="__codelineno-39-373" href="#__codelineno-39-373"></a><span class="w">    </span><span class="c1">// Move first key from right sibling to last position of leaf</span>
<a id="__codelineno-39-374" name="__codelineno-39-374" href="#__codelineno-39-374"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-39-375" name="__codelineno-39-375" href="#__codelineno-39-375"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-39-376" name="__codelineno-39-376" href="#__codelineno-39-376"></a><span class="w">    </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-377" name="__codelineno-39-377" href="#__codelineno-39-377"></a>
<a id="__codelineno-39-378" name="__codelineno-39-378" href="#__codelineno-39-378"></a><span class="w">    </span><span class="c1">// Shift all keys in right sibling to the left</span>
<a id="__codelineno-39-379" name="__codelineno-39-379" href="#__codelineno-39-379"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-380" name="__codelineno-39-380" href="#__codelineno-39-380"></a><span class="w">        </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-381" name="__codelineno-39-381" href="#__codelineno-39-381"></a><span class="w">        </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-382" name="__codelineno-39-382" href="#__codelineno-39-382"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-383" name="__codelineno-39-383" href="#__codelineno-39-383"></a><span class="w">    </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-39-384" name="__codelineno-39-384" href="#__codelineno-39-384"></a>
<a id="__codelineno-39-385" name="__codelineno-39-385" href="#__codelineno-39-385"></a><span class="w">    </span><span class="c1">// Update parent key</span>
<a id="__codelineno-39-386" name="__codelineno-39-386" href="#__codelineno-39-386"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">parentIdx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rightSibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-39-387" name="__codelineno-39-387" href="#__codelineno-39-387"></a><span class="p">}</span>
<a id="__codelineno-39-388" name="__codelineno-39-388" href="#__codelineno-39-388"></a>
<a id="__codelineno-39-389" name="__codelineno-39-389" href="#__codelineno-39-389"></a><span class="c1">// Merge with left sibling (leaf)</span>
<a id="__codelineno-39-390" name="__codelineno-39-390" href="#__codelineno-39-390"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusMergeWithLeftLeaf</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leftSibling</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">parentIdx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-391" name="__codelineno-39-391" href="#__codelineno-39-391"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-39-392" name="__codelineno-39-392" href="#__codelineno-39-392"></a>
<a id="__codelineno-39-393" name="__codelineno-39-393" href="#__codelineno-39-393"></a><span class="w">    </span><span class="c1">// Copy all keys from leaf to left sibling</span>
<a id="__codelineno-39-394" name="__codelineno-39-394" href="#__codelineno-39-394"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-395" name="__codelineno-39-395" href="#__codelineno-39-395"></a><span class="w">        </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-396" name="__codelineno-39-396" href="#__codelineno-39-396"></a><span class="w">        </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<a id="__codelineno-39-397" name="__codelineno-39-397" href="#__codelineno-39-397"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-398" name="__codelineno-39-398" href="#__codelineno-39-398"></a><span class="w">    </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span>
<a id="__codelineno-39-399" name="__codelineno-39-399" href="#__codelineno-39-399"></a>
<a id="__codelineno-39-400" name="__codelineno-39-400" href="#__codelineno-39-400"></a><span class="w">    </span><span class="c1">// Update leaf links</span>
<a id="__codelineno-39-401" name="__codelineno-39-401" href="#__codelineno-39-401"></a><span class="w">    </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<a id="__codelineno-39-402" name="__codelineno-39-402" href="#__codelineno-39-402"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-403" name="__codelineno-39-403" href="#__codelineno-39-403"></a><span class="w">        </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="o">-&gt;</span><span class="n">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftSibling</span><span class="p">;</span>
<a id="__codelineno-39-404" name="__codelineno-39-404" href="#__codelineno-39-404"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-405" name="__codelineno-39-405" href="#__codelineno-39-405"></a>
<a id="__codelineno-39-406" name="__codelineno-39-406" href="#__codelineno-39-406"></a><span class="w">    </span><span class="c1">// Remove key from parent</span>
<a id="__codelineno-39-407" name="__codelineno-39-407" href="#__codelineno-39-407"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parentIdx</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-408" name="__codelineno-39-408" href="#__codelineno-39-408"></a><span class="w">        </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span>
<a id="__codelineno-39-409" name="__codelineno-39-409" href="#__codelineno-39-409"></a><span class="w">        </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">];</span>
<a id="__codelineno-39-410" name="__codelineno-39-410" href="#__codelineno-39-410"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-411" name="__codelineno-39-411" href="#__codelineno-39-411"></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="o">--</span><span class="p">;</span>
<a id="__codelineno-39-412" name="__codelineno-39-412" href="#__codelineno-39-412"></a>
<a id="__codelineno-39-413" name="__codelineno-39-413" href="#__codelineno-39-413"></a><span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">leaf</span><span class="p">);</span>
<a id="__codelineno-39-414" name="__codelineno-39-414" href="#__codelineno-39-414"></a>
<a id="__codelineno-39-415" name="__codelineno-39-415" href="#__codelineno-39-415"></a><span class="w">    </span><span class="c1">// Handle parent underflow</span>
<a id="__codelineno-39-416" name="__codelineno-39-416" href="#__codelineno-39-416"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-417" name="__codelineno-39-417" href="#__codelineno-39-417"></a><span class="w">        </span><span class="n">bPlusHandleUnderflow</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
<a id="__codelineno-39-418" name="__codelineno-39-418" href="#__codelineno-39-418"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-419" name="__codelineno-39-419" href="#__codelineno-39-419"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftSibling</span><span class="p">;</span>
<a id="__codelineno-39-420" name="__codelineno-39-420" href="#__codelineno-39-420"></a><span class="w">        </span><span class="n">leftSibling</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-421" name="__codelineno-39-421" href="#__codelineno-39-421"></a><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
<a id="__codelineno-39-422" name="__codelineno-39-422" href="#__codelineno-39-422"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-423" name="__codelineno-39-423" href="#__codelineno-39-423"></a><span class="p">}</span>
<a id="__codelineno-39-424" name="__codelineno-39-424" href="#__codelineno-39-424"></a>
<a id="__codelineno-39-425" name="__codelineno-39-425" href="#__codelineno-39-425"></a><span class="c1">// Handle underflow in internal nodes</span>
<a id="__codelineno-39-426" name="__codelineno-39-426" href="#__codelineno-39-426"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusHandleUnderflow</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-427" name="__codelineno-39-427" href="#__codelineno-39-427"></a><span class="w">    </span><span class="c1">// Implementation for internal node underflow handling</span>
<a id="__codelineno-39-428" name="__codelineno-39-428" href="#__codelineno-39-428"></a><span class="w">    </span><span class="c1">// Similar to leaf underflow but for internal nodes</span>
<a id="__codelineno-39-429" name="__codelineno-39-429" href="#__codelineno-39-429"></a><span class="w">    </span><span class="c1">// This would involve borrowing or merging with siblings</span>
<a id="__codelineno-39-430" name="__codelineno-39-430" href="#__codelineno-39-430"></a><span class="p">}</span>
<a id="__codelineno-39-431" name="__codelineno-39-431" href="#__codelineno-39-431"></a>
<a id="__codelineno-39-432" name="__codelineno-39-432" href="#__codelineno-39-432"></a><span class="c1">// Delete a key from B+ Tree</span>
<a id="__codelineno-39-433" name="__codelineno-39-433" href="#__codelineno-39-433"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusDelete</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-434" name="__codelineno-39-434" href="#__codelineno-39-434"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-39-435" name="__codelineno-39-435" href="#__codelineno-39-435"></a>
<a id="__codelineno-39-436" name="__codelineno-39-436" href="#__codelineno-39-436"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bPlusFindLeaf</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-39-437" name="__codelineno-39-437" href="#__codelineno-39-437"></a><span class="w">    </span><span class="n">bPlusDeleteFromLeaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-39-438" name="__codelineno-39-438" href="#__codelineno-39-438"></a>
<a id="__codelineno-39-439" name="__codelineno-39-439" href="#__codelineno-39-439"></a><span class="w">    </span><span class="c1">// Handle underflow if necessary</span>
<a id="__codelineno-39-440" name="__codelineno-39-440" href="#__codelineno-39-440"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">leaf</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-441" name="__codelineno-39-441" href="#__codelineno-39-441"></a><span class="w">        </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-39-442" name="__codelineno-39-442" href="#__codelineno-39-442"></a>
<a id="__codelineno-39-443" name="__codelineno-39-443" href="#__codelineno-39-443"></a><span class="w">        </span><span class="c1">// Find position in parent</span>
<a id="__codelineno-39-444" name="__codelineno-39-444" href="#__codelineno-39-444"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-39-445" name="__codelineno-39-445" href="#__codelineno-39-445"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">leaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-446" name="__codelineno-39-446" href="#__codelineno-39-446"></a><span class="w">            </span><span class="n">idx</span><span class="o">++</span><span class="p">;</span>
<a id="__codelineno-39-447" name="__codelineno-39-447" href="#__codelineno-39-447"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-448" name="__codelineno-39-448" href="#__codelineno-39-448"></a>
<a id="__codelineno-39-449" name="__codelineno-39-449" href="#__codelineno-39-449"></a><span class="w">        </span><span class="c1">// Try to borrow from left sibling</span>
<a id="__codelineno-39-450" name="__codelineno-39-450" href="#__codelineno-39-450"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-451" name="__codelineno-39-451" href="#__codelineno-39-451"></a><span class="w">            </span><span class="n">bPlusBorrowFromLeftLeaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-39-452" name="__codelineno-39-452" href="#__codelineno-39-452"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-453" name="__codelineno-39-453" href="#__codelineno-39-453"></a><span class="w">        </span><span class="c1">// Try to borrow from right sibling</span>
<a id="__codelineno-39-454" name="__codelineno-39-454" href="#__codelineno-39-454"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">MIN_KEYS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-455" name="__codelineno-39-455" href="#__codelineno-39-455"></a><span class="w">            </span><span class="n">bPlusBorrowFromRightLeaf</span><span class="p">(</span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-39-456" name="__codelineno-39-456" href="#__codelineno-39-456"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-457" name="__codelineno-39-457" href="#__codelineno-39-457"></a><span class="w">        </span><span class="c1">// Merge with left sibling</span>
<a id="__codelineno-39-458" name="__codelineno-39-458" href="#__codelineno-39-458"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idx</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-459" name="__codelineno-39-459" href="#__codelineno-39-459"></a><span class="w">            </span><span class="n">bPlusMergeWithLeftLeaf</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-39-460" name="__codelineno-39-460" href="#__codelineno-39-460"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-461" name="__codelineno-39-461" href="#__codelineno-39-461"></a><span class="w">        </span><span class="c1">// Merge with right sibling</span>
<a id="__codelineno-39-462" name="__codelineno-39-462" href="#__codelineno-39-462"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-463" name="__codelineno-39-463" href="#__codelineno-39-463"></a><span class="w">            </span><span class="n">bPlusMergeWithLeftLeaf</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">leaf</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">);</span>
<a id="__codelineno-39-464" name="__codelineno-39-464" href="#__codelineno-39-464"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-465" name="__codelineno-39-465" href="#__codelineno-39-465"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-466" name="__codelineno-39-466" href="#__codelineno-39-466"></a>
<a id="__codelineno-39-467" name="__codelineno-39-467" href="#__codelineno-39-467"></a><span class="w">    </span><span class="c1">// If root is empty, update tree</span>
<a id="__codelineno-39-468" name="__codelineno-39-468" href="#__codelineno-39-468"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-469" name="__codelineno-39-469" href="#__codelineno-39-469"></a><span class="w">        </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">oldRoot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-39-470" name="__codelineno-39-470" href="#__codelineno-39-470"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<a id="__codelineno-39-471" name="__codelineno-39-471" href="#__codelineno-39-471"></a><span class="w">        </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<a id="__codelineno-39-472" name="__codelineno-39-472" href="#__codelineno-39-472"></a><span class="w">        </span><span class="n">free</span><span class="p">(</span><span class="n">oldRoot</span><span class="p">);</span>
<a id="__codelineno-39-473" name="__codelineno-39-473" href="#__codelineno-39-473"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-474" name="__codelineno-39-474" href="#__codelineno-39-474"></a><span class="p">}</span>
<a id="__codelineno-39-475" name="__codelineno-39-475" href="#__codelineno-39-475"></a>
<a id="__codelineno-39-476" name="__codelineno-39-476" href="#__codelineno-39-476"></a><span class="c1">// Print B+ Tree level by level</span>
<a id="__codelineno-39-477" name="__codelineno-39-477" href="#__codelineno-39-477"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusPrint</span><span class="p">(</span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">level</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-478" name="__codelineno-39-478" href="#__codelineno-39-478"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-39-479" name="__codelineno-39-479" href="#__codelineno-39-479"></a>
<a id="__codelineno-39-480" name="__codelineno-39-480" href="#__codelineno-39-480"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">level</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;  &quot;</span><span class="p">);</span>
<a id="__codelineno-39-481" name="__codelineno-39-481" href="#__codelineno-39-481"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Level %d [%s]: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;LEAF&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;INTERNAL&quot;</span><span class="p">);</span>
<a id="__codelineno-39-482" name="__codelineno-39-482" href="#__codelineno-39-482"></a>
<a id="__codelineno-39-483" name="__codelineno-39-483" href="#__codelineno-39-483"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-484" name="__codelineno-39-484" href="#__codelineno-39-484"></a><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="__codelineno-39-485" name="__codelineno-39-485" href="#__codelineno-39-485"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-486" name="__codelineno-39-486" href="#__codelineno-39-486"></a><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<a id="__codelineno-39-487" name="__codelineno-39-487" href="#__codelineno-39-487"></a>
<a id="__codelineno-39-488" name="__codelineno-39-488" href="#__codelineno-39-488"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-489" name="__codelineno-39-489" href="#__codelineno-39-489"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-490" name="__codelineno-39-490" href="#__codelineno-39-490"></a><span class="w">            </span><span class="n">bPlusPrint</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">children</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<a id="__codelineno-39-491" name="__codelineno-39-491" href="#__codelineno-39-491"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-492" name="__codelineno-39-492" href="#__codelineno-39-492"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-493" name="__codelineno-39-493" href="#__codelineno-39-493"></a><span class="p">}</span>
<a id="__codelineno-39-494" name="__codelineno-39-494" href="#__codelineno-39-494"></a>
<a id="__codelineno-39-495" name="__codelineno-39-495" href="#__codelineno-39-495"></a><span class="c1">// Full sequential scan (uses linked leaves)</span>
<a id="__codelineno-39-496" name="__codelineno-39-496" href="#__codelineno-39-496"></a><span class="kt">void</span><span class="w"> </span><span class="nf">bPlusFullScan</span><span class="p">(</span><span class="n">BPlusTree</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">callback</span><span class="p">)(</span><span class="kt">int</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-497" name="__codelineno-39-497" href="#__codelineno-39-497"></a><span class="w">    </span><span class="n">BPlusNode</span><span class="w"> </span><span class="o">*</span><span class="n">leaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">firstLeaf</span><span class="p">;</span>
<a id="__codelineno-39-498" name="__codelineno-39-498" href="#__codelineno-39-498"></a>
<a id="__codelineno-39-499" name="__codelineno-39-499" href="#__codelineno-39-499"></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">leaf</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-500" name="__codelineno-39-500" href="#__codelineno-39-500"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">numKeys</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-39-501" name="__codelineno-39-501" href="#__codelineno-39-501"></a><span class="w">            </span><span class="n">callback</span><span class="p">(</span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<a id="__codelineno-39-502" name="__codelineno-39-502" href="#__codelineno-39-502"></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-39-503" name="__codelineno-39-503" href="#__codelineno-39-503"></a><span class="w">        </span><span class="n">leaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leaf</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">;</span>
<a id="__codelineno-39-504" name="__codelineno-39-504" href="#__codelineno-39-504"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-39-505" name="__codelineno-39-505" href="#__codelineno-39-505"></a><span class="p">}</span>
</code></pre></div>
<h3 id="advantages-and-disadvantages">Advantages and Disadvantages</h3>
<p><strong>B-Tree Advantages:</strong>
-  Data can be found at any level (potentially faster for some searches)
-  Slightly shorter tree height
-  Good for random access patterns</p>
<p><strong>B-Tree Disadvantages:</strong>
-  Poor for range queries (no leaf links)
-  Fewer keys per internal node (data uses space)
-  Inconsistent search time (data at different levels)</p>
<p><strong>B+ Tree Advantages:</strong>
-  Excellent for range queries (linked leaves)
-  More keys per internal node (smaller tree)
-  Faster full scans (just traverse leaf level)
-  Consistent search time (always to leaf)
-  Better cache locality (sequential leaf access)</p>
<p><strong>B+ Tree Disadvantages:</strong>
-  Always must go to leaf (one extra level sometimes)
-  Keys duplicated (in internal + leaf nodes)</p>
<hr />
<h2 id="additional-important-questions">Additional Important Questions</h2>
<h3 id="q4-when-should-you-create-an-index">Q4: When Should You Create an Index?</h3>
<p><strong>Create an index when:</strong></p>
<p> <strong>Column frequently used in WHERE clause</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c1">-- Query: SELECT * FROM users WHERE email = &#39;john@example.com&#39;</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_email</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">users</span><span class="p">(</span><span class="n">email</span><span class="p">);</span>
</code></pre></div></p>
<p> <strong>Column used in JOIN operations</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="c1">-- Query: SELECT * FROM orders JOIN users ON orders.user_id = users.id</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_user_id</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">orders</span><span class="p">(</span><span class="n">user_id</span><span class="p">);</span>
</code></pre></div></p>
<p> <strong>Column used in ORDER BY</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c1">-- Query: SELECT * FROM products ORDER BY price</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_price</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">products</span><span class="p">(</span><span class="n">price</span><span class="p">);</span>
</code></pre></div></p>
<p> <strong>Table is large</strong> (&gt;100,000 rows)
- Small tables: Full scan is often faster than index</p>
<p><strong>Do NOT create index when:</strong></p>
<p> <strong>Table is small</strong> (&lt;1,000 rows)
 <strong>Column has low cardinality</strong> (few distinct values)
   - Example: gender (M/F) - only 2 values, index not helpful
 <strong>Column frequently updated</strong>
   - Every update must update index
 <strong>Table has heavy INSERT/UPDATE workload</strong>
   - Indexes slow down writes</p>
<hr />
<h3 id="q5-how-does-the-query-optimizer-use-indexes">Q5: How Does the Query Optimizer Use Indexes?</h3>
<p><strong>Query Optimization Process:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="c1">-- Query</span>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;NYC&#39;</span><span class="p">;</span>
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="c1">-- Optimizer checks:</span>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="n">Indexes</span><span class="w"> </span><span class="n">available</span><span class="o">?</span>
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">idx_age</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="n">age</span><span class="p">)</span>
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">idx_city</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="n">city</span><span class="p">)</span>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">idx_age_city</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="p">(</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">city</span><span class="p">)</span><span class="w">  </span><span class="err"></span><span class="w"> </span><span class="n">Composite</span>
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="mi">2</span><span class="p">.</span><span class="w"> </span><span class="n">Selectivity</span><span class="w"> </span><span class="n">analysis</span><span class="p">:</span>
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">25</span><span class="p">:</span><span class="w"> </span><span class="k">Returns</span><span class="w"> </span><span class="mi">70</span><span class="o">%</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="k">not</span><span class="w"> </span><span class="n">selective</span><span class="p">)</span>
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;NYC&#39;</span><span class="p">:</span><span class="w"> </span><span class="k">Returns</span><span class="w"> </span><span class="mi">5</span><span class="o">%</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="p">(</span><span class="n">highly</span><span class="w"> </span><span class="n">selective</span><span class="p">)</span>
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="k">Both</span><span class="p">:</span><span class="w"> </span><span class="k">Returns</span><span class="w"> </span><span class="mi">3</span><span class="o">%</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">rows</span>
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="n">Cost</span><span class="w"> </span><span class="n">estimation</span><span class="p">:</span>
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="k">Full</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">scan</span><span class="p">:</span><span class="w"> </span><span class="k">Read</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="w"> </span><span class="n">pages</span>
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">idx_age</span><span class="p">:</span><span class="w"> </span><span class="k">Read</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">fetch</span><span class="w"> </span><span class="mi">700</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="p">(</span><span class="k">not</span><span class="w"> </span><span class="n">good</span><span class="p">)</span>
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">idx_city</span><span class="p">:</span><span class="w"> </span><span class="k">Read</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">fetch</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="p">(</span><span class="n">good</span><span class="o">!</span><span class="p">)</span>
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">idx_age_city</span><span class="p">:</span><span class="w"> </span><span class="k">Read</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">fetch</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="p">(</span><span class="n">best</span><span class="o">!</span><span class="p">)</span>
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>
<a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="n">Decision</span><span class="p">:</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="n">idx_age_city</span><span class="w"> </span><span class="p">(</span><span class="n">lowest</span><span class="w"> </span><span class="n">cost</span><span class="p">)</span>
</code></pre></div>
<p><strong>View optimizer decision:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="k">EXPLAIN</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">city</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;NYC&#39;</span><span class="p">;</span>
</code></pre></div></p>
<hr />
<h3 id="q6-what-is-index-fragmentation-and-maintenance">Q6: What is Index Fragmentation and Maintenance?</h3>
<p><strong>Index Fragmentation:</strong></p>
<p>Over time, indexes become fragmented due to INSERT/UPDATE/DELETE operations:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>Healthy Index Page:
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a> [10] [20] [30] [40] [50] [60]    Full page, sequential
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>Fragmented Index Page (after many operations):
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a> [10] [__] [30] [__] [50] [__]    Gaps, wasted space
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>
</code></pre></div>
<p><strong>Page Splits:</strong></p>
<p>When inserting into a full page:
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>Before (full):
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>Page 1: [10, 20, 30, 40]   Full
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>Insert 25:
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>Page 1: [10, 20]            Split
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>Page 2: [25, 30, 40]        New page
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>Result: Pages not contiguous, poor sequential read performance
</code></pre></div></p>
<p><strong>Maintenance Operations:</strong></p>
<p><strong>1. Rebuild Index:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_name</span><span class="w"> </span><span class="n">REBUILD</span><span class="p">;</span>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="c1">-- Completely recreates index, removes fragmentation</span>
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="c1">-- Offline operation (locks table)</span>
</code></pre></div></p>
<p><strong>2. Reorganize Index:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="k">ALTER</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">idx_name</span><span class="w"> </span><span class="n">REORGANIZE</span><span class="p">;</span>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="c1">-- Defragments leaf level, compacts pages</span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="c1">-- Online operation (minimal locking)</span>
</code></pre></div></p>
<p><strong>3. Update Statistics:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="k">UPDATE</span><span class="w"> </span><span class="k">STATISTICS</span><span class="w"> </span><span class="n">users</span><span class="p">;</span>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="c1">-- Refreshes optimizer statistics</span>
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="c1">-- Helps optimizer make better decisions</span>
</code></pre></div></p>
<hr />
<h3 id="summary">Summary</h3>
<p><strong>Key Takeaways:</strong></p>
<ol>
<li><strong>Data Storage</strong>: Database uses pages (8KB blocks) to store data, managed by buffer manager</li>
<li><strong>Index Types</strong>: Clustered (physical order) vs Non-Clustered (separate structure with pointers)</li>
<li><strong>Data Structures</strong>: B+ Trees are optimal for databases due to linked leaves and range query efficiency</li>
<li><strong>Index Strategy</strong>: Create indexes on frequently queried columns, but balance against write performance</li>
<li><strong>Maintenance</strong>: Regularly rebuild/reorganize indexes to prevent fragmentation</li>
</ol>
<p><strong>Performance Impact:</strong></p>
<table>
<thead>
<tr>
<th>Operation</th>
<th>Without Index</th>
<th>With Index</th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Point query</strong></td>
<td>O(n) - scan all rows</td>
<td>O(log n) - tree search</td>
<td>100-1000x faster</td>
</tr>
<tr>
<td><strong>Range query</strong></td>
<td>O(n) - scan all rows</td>
<td>O(log n + k) - k results</td>
<td>50-500x faster</td>
</tr>
<tr>
<td><strong>Sort</strong></td>
<td>O(n log n) - sort data</td>
<td>O(1) - already sorted</td>
<td>10-100x faster</td>
</tr>
<tr>
<td><strong>INSERT</strong></td>
<td>O(1) - append</td>
<td>O(log n) - update index</td>
<td>2-5x slower</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 <a href="https://github.com/abhishekghoshh"  target="_blank" rel="noopener">Abhishek Ghosh</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abhishekghoshh" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/abhishek_ghoshh" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/abhishek-ghosh-220679132/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>