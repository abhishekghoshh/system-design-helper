
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://abhishekghoshh.github.io/system-design-helper/security/encryption/">
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Symmetric & Asymmetric Encryption - System Design Helper</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  
<meta property="og:type" content="website" />
<meta property="og:title" content="Symmetric &amp; Asymmetric Encryption - System Design Helper" />
<meta property="og:image" content="https://abhishekghoshh.github.io/system-design-helper/assets/images/social/security/encryption.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://abhishekghoshh.github.io/system-design-helper/security/encryption/" />
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:title" content="Symmetric &amp; Asymmetric Encryption - System Design Helper" />
<meta property="twitter:image" content="https://abhishekghoshh.github.io/system-design-helper/assets/images/social/security/encryption.png" />
</head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#symmetric-asymmetric-encryption" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="System Design Helper" class="md-header__button md-logo" aria-label="System Design Helper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            System Design Helper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Symmetric &amp; Asymmetric Encryption
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../ai-tools/" class="md-tabs__link">
        
  
  
    
  
  AI Tools

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../behavioural/" class="md-tabs__link">
        
  
  
    
  
  Behavioural

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../developer-experiences/" class="md-tabs__link">
        
  
  
    
  
  Developer Experiences

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../open-source-tools/" class="md-tabs__link">
        
  
  
    
  
  Open Source Tools

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../software-architect/" class="md-tabs__link">
        
  
  
    
  
  Software Architect

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../wisdom/" class="md-tabs__link">
        
  
  
    
  
  Wisdom

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ai/ai/" class="md-tabs__link">
          
  
  
  AI

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../devops/" class="md-tabs__link">
          
  
  
  DevOps

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../introduction/" class="md-tabs__link">
          
  
  
  Security

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../system-design/courses/" class="md-tabs__link">
          
  
  
  System Design

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="System Design Helper" class="md-nav__button md-logo" aria-label="System Design Helper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    System Design Helper
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Tools
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../behavioural/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Behavioural
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-experiences/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Developer Experiences
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../open-source-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Open Source Tools
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software-architect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Architect
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wisdom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wisdom
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    AI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    AI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/ai-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AI Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/gen-ai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gen AI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/langchain/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangChain
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/langgraph/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LangGraph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/MCP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ai/RAG/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RAG
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    DevOps
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    DevOps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../authentication-and-authorization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication & Authorization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../oauth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OAuth
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rbac/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RBAC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sso/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SSO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SSL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../devsecops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DevSecOps
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../firewall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Firewall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_9" >
        
          
          <label class="md-nav__link" for="__nav_10_9" id="__nav_10_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Certificate
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Certificate
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/certificate-authority/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Certificate Authority
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/client-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client Certificates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/server-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Server Certificates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/self-signed-certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Self-Signed Certificates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/links/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Links
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10_10" >
        
          
          <label class="md-nav__link" for="__nav_10_10" id="__nav_10_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reverse Proxy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_10_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reverse Proxy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse-proxy/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse-proxy/haproxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HAProxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reverse-proxy/nginx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nginx
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    System Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    System Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/courses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Courses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2" id="__nav_11_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    High Level Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    High Level Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2_2" >
        
          
          <label class="md-nav__link" for="__nav_11_2_2" id="__nav_11_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/adaptive-bitrate-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adaptive Bitrate Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/asynchronus-communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Asynchronous Communication
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/back-of-envelope-calculation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Back of Envelope Calculation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/bloom-filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bloom Filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/cap-theorm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CAP Theorem
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/cdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CDC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/cdn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CDN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/clean-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Clean Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/code-documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/consistent-hashing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Consistent Hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/cqrs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CQRS
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/database-indexing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Database Indexing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/distributed-caches-and-caching-strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Caches & Caching Strategies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/ditributed-transaction-and-concurrency-control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Transaction & Concurrency Control
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/event-sourcing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Sourcing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/hashing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hashing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/load-balancer-and-proxy-server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Load Balancer & Proxy Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/microservices-patterns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Microservices Patterns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Networking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/passwords/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Passwords
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/raft-consensus-algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Raft Consensus Algorithm
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/restfull-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RESTful Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/s3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    S3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/scaling-to-one-million/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scaling to One Million
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/sockets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sockets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Storage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/concepts/webrtc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    WebRTC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2_3" >
        
          
          <label class="md-nav__link" for="__nav_11_2_3" id="__nav_11_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Designing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Designing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/app-store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/authentication-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/chat-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chat System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/chess-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chess Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/data-warehouse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Warehouse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/distributed-geospatial-data-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Geospatial Data Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/distributed-messaging-queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Distributed Messaging Queue
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/dns-server.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DNS Server
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/e-commerce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Commerce
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/ecommerce-checkout/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    E-Commerce Checkout
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/email-automation-platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Email Automation Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/food-delivery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Food Delivery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/google-drive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Google Drive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/hashtag-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hashtag Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/how-to-host-your-own-x/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to Host Your Own X
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/Image-Optimisation-on-the-fly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Image Optimisation On The Fly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/key-value-store/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Key Value Store
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/large-language-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Large Language Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/leetcode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LeetCode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/live-comments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Live Comments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/log-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Log System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/multiplayer-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiplayer Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/netflix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Netflix
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/notification-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notification System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/products/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Products
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/rate-limiter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Rate Limiter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/recomendation-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recommendation Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/redis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Redis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/search-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/social-media/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Social Media
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/spotify/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spotify
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/stock-broker-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stock Broker System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/tiny-url/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tiny URL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/twitter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Twitter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/uber/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Uber
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/upi-payments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UPI Payments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/video-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Video Streaming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/vpn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    VPN
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/webhook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Webhook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/desgining/yelp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Yelp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_2_4" >
        
          
          <label class="md-nav__link" for="__nav_11_2_4" id="__nav_11_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Links
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Links
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/links/udemy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Udemy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/links/websites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Websites
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/high-level/links/youtube/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    YouTube
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3" id="__nav_11_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Low Level Design
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_11_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Low Level Design
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_2" >
        
          
          <label class="md-nav__link" for="__nav_11_3_2" id="__nav_11_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/concepts/hashmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HashMap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/concepts/solid-principles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SOLID Principles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/concepts/technical-debt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Technical Debt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_3" >
        
          
          <label class="md-nav__link" for="__nav_11_3_3" id="__nav_11_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Design Patterns
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Design Patterns
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/design-pattern/design-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design Pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_3_2" >
        
          
          <label class="md-nav__link" for="__nav_11_3_3_2" id="__nav_11_3_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Others
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_11_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Others
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/design-pattern/others/null-object-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Null Object Pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11_3_4" >
        
          
          <label class="md-nav__link" for="__nav_11_3_4" id="__nav_11_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Designing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_11_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Designing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/access-management-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Access Management System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/account-balance-tracker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Account Balance Tracker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/air-traffic-controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Air Traffic Controller
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/atm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ATM
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/cache-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cache System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/car-rental-service/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Car Rental Service
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/chess-game/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chess Game
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/elevator-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Elevator System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/locker-allocation-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Locker Allocation System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/parking-lot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parking Lot
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/snake-and-ladder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Snake and Ladder
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/stock-exchange-book/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Stock Exchange Book
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/tic-tac-toe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tic Tac Toe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../system-design/low-level/designing/vending-machine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Vending Machine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="symmetric-asymmetric-encryption">Symmetric &amp; Asymmetric Encryption</h1>
<h2 id="youtube">Youtube</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=GtSUeAkPEP0">25. Symmetric &amp; Asymmetric Encryption with Explanation of AES, Diffie-Hellman and Digital Signature</a></li>
</ul>
<h2 id="theory">Theory</h2>
<h3 id="what-is-encryption-and-decryption">What is Encryption and Decryption?</h3>
<p><strong>Encryption</strong> is the process of converting plaintext (readable data) into ciphertext (scrambled, unreadable data) using an algorithm and a key. <strong>Decryption</strong> is the reverse process of converting ciphertext back to plaintext.</p>
<p><strong>Purpose:</strong>
- <strong>Confidentiality</strong>: Protect sensitive data from unauthorized access
- <strong>Data Security</strong>: Secure data in transit and at rest
- <strong>Privacy</strong>: Keep personal information private
- <strong>Compliance</strong>: Meet regulatory requirements (GDPR, HIPAA, PCI-DSS)</p>
<h4 id="how-encryption-works">How Encryption Works</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>              Encryption &amp; Decryption Process                 
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>ENCRYPTION:
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>          
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>  Plaintext          Encryption         Ciphertext  
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>                Algorithm                 
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a> &quot;Hello 123&quot;          + Key            &quot;xK9#mP2$...&quot;
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>          
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>                            
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>                            
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>                     
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>                      Encryption  
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>                          Key     
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>                       (Secret)   
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>                     
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>DECRYPTION:
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>          
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>  Ciphertext         Decryption         Plaintext   
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>                Algorithm                 
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a> &quot;xK9#mP2$...&quot;        + Key            &quot;Hello 123&quot;  
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>          
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>                            
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>                            
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>                     
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>                      Decryption  
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>                          Key     
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>                       (Secret)   
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>                     
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>KEY COMPONENTS:
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>1. Plaintext:  Original readable data
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>2. Algorithm:  Mathematical function (AES, RSA, etc.)
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>3. Key:        Secret value used by algorithm
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>4. Ciphertext: Encrypted, unreadable output
</code></pre></div>
<p><strong>Example Process:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Plaintext:    &quot;HELLO WORLD&quot;
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Algorithm:    AES-256
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>Key:          &quot;my-secret-key-12345&quot;
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>             
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>Encryption:   Apply AES-256 algorithm with key
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>             
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>Ciphertext:   &quot;j8kL#2mN9qR$5tX...&quot;
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>             
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>Decryption:   Apply AES-256 algorithm with same key
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>             
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>Plaintext:    &quot;HELLO WORLD&quot;
</code></pre></div></p>
<h3 id="symmetric-encryption">Symmetric Encryption</h3>
<p><strong>Definition</strong>: Encryption method that uses the <strong>same key</strong> for both encryption and decryption.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>                 Symmetric Encryption                         
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>         
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>               Shared Secret Key           
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>                &quot;mySecretKey123&quot;           
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>         
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>                                
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>               
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>           ENCRYPTION          
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>                               
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>Sender     Plaintext  Ciphertext
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>           &quot;Hello&quot;                     &quot;xK9#mP2$&quot;
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>                               
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>               
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>                                 
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>                                 
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>                      
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>                          TRANSMISSION     
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>                         (Over Network)    
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>                         Ciphertext Sent   
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>                      
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>                                 
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>                                 
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>               
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>           DECRYPTION          
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>                               
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>Receiver   Ciphertext 
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>           &quot;xK9#mP2$&quot;    
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>                        
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>                        
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>           Plaintext     
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>           &quot;Hello&quot;       
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>         
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a>KEY CHARACTERISTIC:
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>Same key used for encryption AND decryption
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a>Both parties must have the secret key
</code></pre></div>
<h4 id="symmetric-encryption-algorithms">Symmetric Encryption Algorithms</h4>
<p><strong>Evolution and Improvements:</strong></p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Key Size</th>
<th>Year</th>
<th>Status</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DES</strong></td>
<td>56-bit</td>
<td>1977</td>
<td> Deprecated</td>
<td>Too weak, broken by brute force</td>
</tr>
<tr>
<td><strong>3DES</strong></td>
<td>168-bit</td>
<td>1998</td>
<td> Legacy</td>
<td>Triple encryption, slow, being phased out</td>
</tr>
<tr>
<td><strong>AES</strong></td>
<td>128/192/256-bit</td>
<td>2001</td>
<td> Current Standard</td>
<td>Fast, secure, widely used</td>
</tr>
<tr>
<td><strong>ChaCha20</strong></td>
<td>256-bit</td>
<td>2008</td>
<td> Modern</td>
<td>Fast on mobile, used in TLS</td>
</tr>
<tr>
<td><strong>Blowfish</strong></td>
<td>32-448 bit</td>
<td>1993</td>
<td> Legacy</td>
<td>Replaced by AES</td>
</tr>
<tr>
<td><strong>Twofish</strong></td>
<td>128/192/256-bit</td>
<td>1998</td>
<td> Secure</td>
<td>AES finalist, still secure</td>
</tr>
</tbody>
</table>
<p><strong>Modern Algorithm: AES (Advanced Encryption Standard)</strong></p>
<p><strong>Advantages of AES over DES:</strong>
-  <strong>Stronger Security</strong>: 256-bit keys vs 56-bit (2^200 times harder to crack)
-  <strong>Faster</strong>: Hardware acceleration in modern CPUs
-  <strong>Flexible</strong>: Multiple key sizes (128, 192, 256 bits)
-  <strong>Proven</strong>: Extensively analyzed, no practical attacks
-  <strong>Government Approved</strong>: Used by NSA for classified data
-  <strong>Efficient</strong>: Low memory footprint</p>
<p><strong>AES Modes of Operation:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>ECB (Electronic Codebook):         Not recommended (patterns visible)
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>CBC (Cipher Block Chaining):       Good for files
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>CTR (Counter Mode):                 Good for random access
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>GCM (Galois/Counter Mode):          Best - Encryption + Authentication
</code></pre></div></p>
<h3 id="detailed-symmetric-encryption-algorithms">Detailed Symmetric Encryption Algorithms</h3>
<h4 id="des-data-encryption-standard">DES (Data Encryption Standard)</h4>
<p><strong>Description:</strong>
DES was the first widely adopted modern encryption standard, developed by IBM and adopted by NIST in 1977. It's a block cipher that encrypts data in 64-bit blocks using a 56-bit key.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>              DES Algorithm Structure                         
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>INPUT: 64-bit Plaintext Block
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>       
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a> Initial Permutation    Rearrange bits
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        (IP)          
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>           
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>      Split into
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>           
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>                 
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>Left 32 bits  Right 32 bits
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>                 
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>      16 Rounds  
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>        
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>      Round 1    Each round:
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>        K1       - Expansion
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>          - XOR with key
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>      Round 2    - S-boxes (substitution)
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>        K2       - Permutation
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>        
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>        ...    
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>        
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>      Round16  
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>        K16    
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>        
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>    
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>           
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a> Final Permutation      Inverse of IP
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>      (IP)          
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>           
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>OUTPUT: 64-bit Ciphertext
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>KEY SCHEDULE:
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>56-bit Key  Generate 16 subkeys (K1-K16)
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a>Each round uses different subkey
</code></pre></div>
<p><strong>Specifications:</strong>
- <strong>Block Size</strong>: 64 bits
- <strong>Key Size</strong>: 56 bits (+ 8 parity bits = 64 bits total)
- <strong>Rounds</strong>: 16
- <strong>Structure</strong>: Feistel Network</p>
<p><strong>Advantages (Historical):</strong>
-  Well-studied and understood
-  Hardware implementations very fast
-  Simple to implement</p>
<p><strong>Disadvantages:</strong>
-  <strong>Too Weak</strong>: 56-bit key is too small (2^56 = 72 quadrillion keys)
-  <strong>Broken</strong>: Can be cracked in days with modern hardware
-  <strong>Small Block Size</strong>: 64-bit blocks lead to collisions
-  <strong>Deprecated</strong>: Should not be used anymore</p>
<p><strong>Why DES Failed:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>Key Space: 2^56 = 72,057,594,037,927,936 possible keys
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>1977:  Would take years to brute force
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>1998:  EFF&#39;s DES Cracker broke DES in 56 hours
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>2006:  COPACOBANA broke DES in 9 days (cost: $10,000)
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>2025:  Can be broken in seconds with cloud computing
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>Example Attack Cost:
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>AWS EC2: ~$100 to crack DES in a few hours
</code></pre></div></p>
<h4 id="3des-triple-des">3DES (Triple DES)</h4>
<p><strong>Description:</strong>
3DES applies DES three times with different keys to increase security. It was created as a temporary solution when DES became too weak.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>              3DES Algorithm (EDE Mode)                       
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>Plaintext
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a> Encrypt       Key1 (56 bits)
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>  (DES)        Encryption with first key
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>       
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>       
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a> Decrypt       Key2 (56 bits)
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>  (DES)        Decryption with second key
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>       
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>       
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a> Encrypt       Key3 (56 bits)
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>  (DES)        Encryption with third key
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>       
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>       
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>Ciphertext
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>Total Key Length: 168 bits (3  56)
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>Effective Security: ~112 bits (due to meet-in-the-middle attacks)
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>Variants:
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>1. 3DES-EDE3: K1, K2, K3 all different (168-bit)
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>2. 3DES-EDE2: K1=K3, K2 different (112-bit)
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>3. 3DES-EEE:  All encryption (less common)
</code></pre></div>
<p><strong>Advantages:</strong>
-  Backward compatible with DES
-  Stronger than DES (112-168 bit effective security)
-  No known practical attacks</p>
<p><strong>Disadvantages:</strong>
-  <strong>Slow</strong>: 3x slower than DES, 6-7x slower than AES
-  <strong>Small Block Size</strong>: Still 64-bit blocks
-  <strong>Being Deprecated</strong>: NIST deprecated in 2023
-  <strong>Inefficient</strong>: Legacy design</p>
<h4 id="aes-advanced-encryption-standard">AES (Advanced Encryption Standard)</h4>
<p><strong>Description:</strong>
AES, also known as Rijndael, is the current encryption standard. It was selected through a public competition and adopted by NIST in 2001. It's a substitution-permutation network (SPN) cipher.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>              AES Algorithm Structure                         
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>INPUT: 128-bit Plaintext (16 bytes)
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>       
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>Arranged in 44 matrix (State):
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a> b0  b4  b8  b12 
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a> b1  b5  b9  b13 
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a> b2  b6  b10 b14 
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a> b3  b7  b11 b15 
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>       
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a> Initial Round (Add Round Key)   
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a> XOR with first round key        
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>                
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>        
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>           Main Rounds   (Nr-1 rounds)
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>                         Nr = 10, 12, or 14
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>              depending on key size
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>           Round 1   
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>            
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>             1. SubBytes        S-box substitution
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>             2. ShiftRows       Rotate rows
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>             3. MixColumns      Mix column data
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>             4. AddRoundKey     XOR with round key
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>            
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>          
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>           Round 2 
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>          
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>             ...   
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>          
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>        
<a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>                
<a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>
<a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a> Final Round (No MixColumns)     
<a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a> 1. SubBytes                     
<a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a> 2. ShiftRows                    
<a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a> 3. AddRoundKey                  
<a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>
<a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>                
<a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>OUTPUT: 128-bit Ciphertext
<a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a>
<a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>AES OPERATIONS:
<a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>
<a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>
<a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>1. SubBytes (S-box):
<a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a>       
<a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>    A    C   Each byte substituted
<a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>    B    7   using lookup table
<a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>       
<a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>
<a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>2. ShiftRows:
<a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>   Row 0: No shift
<a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>   Row 1: Left shift by 1
<a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>   Row 2: Left shift by 2
<a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a>   Row 3: Left shift by 3
<a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a>
<a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>3. MixColumns:
<a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a>   Multiply each column by fixed matrix
<a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a>   (Provides diffusion)
<a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a>
<a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a>4. AddRoundKey:
<a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>   XOR state with round key
</code></pre></div>
<p><strong>AES Variants:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>        AES-128    AES-192    AES-256         
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a> Key Size:   128   192        256 bits        
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a> Rounds:     10    12         14              
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a> Security:   High  Higher     Highest         
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a> Speed:      Fast  Medium     Slower          
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a> Use Case: StandardGovernmentTop Secret/Future
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>Security Level:
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>AES-128: 2^128 possible keys (unbreakable with current tech)
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>AES-256: 2^256 possible keys (quantum-resistant)
</code></pre></div></p>
<p><strong>Advantages:</strong>
-  <strong>Extremely Secure</strong>: No practical attacks on full AES
-  <strong>Fast</strong>: Hardware acceleration (AES-NI instructions)
-  <strong>Flexible</strong>: Multiple key sizes
-  <strong>Efficient</strong>: Low memory and CPU usage
-  <strong>Widely Adopted</strong>: Industry standard
-  <strong>Government Approved</strong>: NSA Suite B
-  <strong>Well Studied</strong>: Analyzed for over 20 years</p>
<p><strong>Performance Comparison:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Encryption Speed (MB/s on modern CPU):
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>DES:         50 MB/s
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>3DES:        20 MB/s
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>AES-128:    500 MB/s (without AES-NI)
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>AES-128:  3,000 MB/s (with AES-NI)
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>AES is 10-150x faster than 3DES!
</code></pre></div></p>
<h3 id="how-aes-works-step-by-step">How AES Works: Step-by-Step</h3>
<p>AES processes data through multiple rounds of transformations. Let's understand each operation in detail:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>            AES DETAILED ENCRYPTION PROCESS                   
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>EXAMPLE: AES-128 (10 rounds)
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>INPUT PLAINTEXT: &quot;Hello World 123!&quot; (16 bytes)
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>KEY: 256-bit key (we&#39;ll use 128-bit for simplicity)
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>STEP 1: Convert to State Matrix (44 bytes)
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>Input bytes arranged column-wise:
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        Col0  Col1  Col2  Col3
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>     
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>Row0   H     W     d     3    
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>Row1   e     o     (space)!   
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>Row2   l     r     1          
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>Row3   l     l     2          
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>     
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>Hex representation:
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>     
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>      48   57   64   33       
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>      65   6F   20   21       
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>      6C   72   31           
<a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>      6C   6C   32           
<a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>     
<a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>
<a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>
<a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>
<a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>ROUND 0: Initial AddRoundKey
<a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>
<a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>State  RoundKey[0]
<a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>
<a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a>Before:              RoundKey[0]:      After (State):
<a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>               
<a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a> 48 57 ..          2B 7E ..   =    63 29 .. 
<a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a> 65 6F ..           28 AE ..        4D C1 .. 
<a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a> 6C 72 ..           D2 A6 ..        BE D4 .. 
<a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a> 6C 6C ..           AB F7 ..        C7 9B .. 
<a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a>               
<a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a>
<a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a>
<a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a>
<a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a>ROUND 1-9: Main Rounds (each has 4 operations)
<a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a>
<a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a>
<a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a>
<a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a> OPERATION 1: SubBytes (Byte Substitution)                   
<a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a>
<a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a>
<a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a>Each byte replaced using S-box lookup table (non-linear substitution)
<a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a>
<a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a>S-BOX (partial):
<a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a>    0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F
<a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a>  
<a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a>0  63 7C 77 7B F2 6B 6F C5 30 01 67 2B FE D7 AB 76
<a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a>1  CA 82 C9 7D FA 59 47 F0 AD D4 A2 AF 9C A4 72 C0
<a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a>...
<a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a>
<a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a>Example:
<a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a>Input byte:  0x53
<a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a>Row = 5, Col = 3
<a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a>S-box[5][3] = 0xED
<a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a>Output byte: 0xED
<a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a>
<a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a>Before SubBytes:        After SubBytes:
<a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a>            
<a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a> 63 29 ..   S-box      FB 7D .. 
<a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a> 4D C1 ..       E4 8E .. 
<a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a> BE D4 ..              23 AF .. 
<a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a> C7 9B ..              0C C5 .. 
<a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a>            
<a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a>                             
<a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a>       Non-linear 
<a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a>           confusion
<a id="__codelineno-10-78" name="__codelineno-10-78" href="#__codelineno-10-78"></a>
<a id="__codelineno-10-79" name="__codelineno-10-79" href="#__codelineno-10-79"></a>
<a id="__codelineno-10-80" name="__codelineno-10-80" href="#__codelineno-10-80"></a> OPERATION 2: ShiftRows (Row Permutation)                    
<a id="__codelineno-10-81" name="__codelineno-10-81" href="#__codelineno-10-81"></a>
<a id="__codelineno-10-82" name="__codelineno-10-82" href="#__codelineno-10-82"></a>
<a id="__codelineno-10-83" name="__codelineno-10-83" href="#__codelineno-10-83"></a>Circular left shift of rows (provides diffusion)
<a id="__codelineno-10-84" name="__codelineno-10-84" href="#__codelineno-10-84"></a>
<a id="__codelineno-10-85" name="__codelineno-10-85" href="#__codelineno-10-85"></a>Before ShiftRows:              After ShiftRows:
<a id="__codelineno-10-86" name="__codelineno-10-86" href="#__codelineno-10-86"></a>               
<a id="__codelineno-10-87" name="__codelineno-10-87" href="#__codelineno-10-87"></a> a0 a1 a2 a3   Row 0: No      a0 a1 a2 a3  
<a id="__codelineno-10-88" name="__codelineno-10-88" href="#__codelineno-10-88"></a> b0 b1 b2 b3   Row 1: &lt;&lt;1     b1 b2 b3 b0  
<a id="__codelineno-10-89" name="__codelineno-10-89" href="#__codelineno-10-89"></a> c0 c1 c2 c3   Row 2: &lt;&lt;2     c2 c3 c0 c1  
<a id="__codelineno-10-90" name="__codelineno-10-90" href="#__codelineno-10-90"></a> d0 d1 d2 d3   Row 3: &lt;&lt;3     d3 d0 d1 d2  
<a id="__codelineno-10-91" name="__codelineno-10-91" href="#__codelineno-10-91"></a>               
<a id="__codelineno-10-92" name="__codelineno-10-92" href="#__codelineno-10-92"></a>
<a id="__codelineno-10-93" name="__codelineno-10-93" href="#__codelineno-10-93"></a>Visual:
<a id="__codelineno-10-94" name="__codelineno-10-94" href="#__codelineno-10-94"></a>Row 1: [b0, b1, b2, b3]  [b1, b2, b3, b0]
<a id="__codelineno-10-95" name="__codelineno-10-95" href="#__codelineno-10-95"></a>        shifted left by 1
<a id="__codelineno-10-96" name="__codelineno-10-96" href="#__codelineno-10-96"></a>
<a id="__codelineno-10-97" name="__codelineno-10-97" href="#__codelineno-10-97"></a>Row 2: [c0, c1, c2, c3]  [c2, c3, c0, c1]
<a id="__codelineno-10-98" name="__codelineno-10-98" href="#__codelineno-10-98"></a>        shifted left by 2
<a id="__codelineno-10-99" name="__codelineno-10-99" href="#__codelineno-10-99"></a>
<a id="__codelineno-10-100" name="__codelineno-10-100" href="#__codelineno-10-100"></a>Row 3: [d0, d1, d2, d3]  [d3, d0, d1, d2]
<a id="__codelineno-10-101" name="__codelineno-10-101" href="#__codelineno-10-101"></a>        shifted left by 3
<a id="__codelineno-10-102" name="__codelineno-10-102" href="#__codelineno-10-102"></a>
<a id="__codelineno-10-103" name="__codelineno-10-103" href="#__codelineno-10-103"></a>
<a id="__codelineno-10-104" name="__codelineno-10-104" href="#__codelineno-10-104"></a> OPERATION 3: MixColumns (Column Mixing)                     
<a id="__codelineno-10-105" name="__codelineno-10-105" href="#__codelineno-10-105"></a>
<a id="__codelineno-10-106" name="__codelineno-10-106" href="#__codelineno-10-106"></a>
<a id="__codelineno-10-107" name="__codelineno-10-107" href="#__codelineno-10-107"></a>Matrix multiplication in Galois Field GF(2^8)
<a id="__codelineno-10-108" name="__codelineno-10-108" href="#__codelineno-10-108"></a>Each column multiplied by fixed matrix
<a id="__codelineno-10-109" name="__codelineno-10-109" href="#__codelineno-10-109"></a>
<a id="__codelineno-10-110" name="__codelineno-10-110" href="#__codelineno-10-110"></a>MixColumns Matrix:
<a id="__codelineno-10-111" name="__codelineno-10-111" href="#__codelineno-10-111"></a>      
<a id="__codelineno-10-112" name="__codelineno-10-112" href="#__codelineno-10-112"></a> 02 03 01 01  s0,c       s&#39;0,c    
<a id="__codelineno-10-113" name="__codelineno-10-113" href="#__codelineno-10-113"></a> 01 02 03 01  s1,c       s&#39;1,c    
<a id="__codelineno-10-114" name="__codelineno-10-114" href="#__codelineno-10-114"></a> 01 01 02 03   s2,c      =  s&#39;2,c    
<a id="__codelineno-10-115" name="__codelineno-10-115" href="#__codelineno-10-115"></a> 03 01 01 02  s3,c       s&#39;3,c    
<a id="__codelineno-10-116" name="__codelineno-10-116" href="#__codelineno-10-116"></a>      
<a id="__codelineno-10-117" name="__codelineno-10-117" href="#__codelineno-10-117"></a>
<a id="__codelineno-10-118" name="__codelineno-10-118" href="#__codelineno-10-118"></a>Example for one column:
<a id="__codelineno-10-119" name="__codelineno-10-119" href="#__codelineno-10-119"></a>      
<a id="__codelineno-10-120" name="__codelineno-10-120" href="#__codelineno-10-120"></a> 02 03 01 01  DB   8E 
<a id="__codelineno-10-121" name="__codelineno-10-121" href="#__codelineno-10-121"></a> 01 02 03 01  13   9F 
<a id="__codelineno-10-122" name="__codelineno-10-122" href="#__codelineno-10-122"></a> 01 01 02 03   53  =  D4 
<a id="__codelineno-10-123" name="__codelineno-10-123" href="#__codelineno-10-123"></a> 03 01 01 02  45   17 
<a id="__codelineno-10-124" name="__codelineno-10-124" href="#__codelineno-10-124"></a>      
<a id="__codelineno-10-125" name="__codelineno-10-125" href="#__codelineno-10-125"></a>
<a id="__codelineno-10-126" name="__codelineno-10-126" href="#__codelineno-10-126"></a>This spreads each byte across entire column
<a id="__codelineno-10-127" name="__codelineno-10-127" href="#__codelineno-10-127"></a>(Maximum diffusion)
<a id="__codelineno-10-128" name="__codelineno-10-128" href="#__codelineno-10-128"></a>
<a id="__codelineno-10-129" name="__codelineno-10-129" href="#__codelineno-10-129"></a>Before MixColumns:        After MixColumns:
<a id="__codelineno-10-130" name="__codelineno-10-130" href="#__codelineno-10-130"></a>              
<a id="__codelineno-10-131" name="__codelineno-10-131" href="#__codelineno-10-131"></a> a0 b0 c0 d0              a&#39;0 b&#39;0 c&#39;0 d&#39;0
<a id="__codelineno-10-132" name="__codelineno-10-132" href="#__codelineno-10-132"></a> a1 b1 c1 d1  Matrix      a&#39;1 b&#39;1 c&#39;1 d&#39;1
<a id="__codelineno-10-133" name="__codelineno-10-133" href="#__codelineno-10-133"></a> a2 b2 c2 d2       a&#39;2 b&#39;2 c&#39;2 d&#39;2
<a id="__codelineno-10-134" name="__codelineno-10-134" href="#__codelineno-10-134"></a> a3 b3 c3 d3              a&#39;3 b&#39;3 c&#39;3 d&#39;3
<a id="__codelineno-10-135" name="__codelineno-10-135" href="#__codelineno-10-135"></a>              
<a id="__codelineno-10-136" name="__codelineno-10-136" href="#__codelineno-10-136"></a>
<a id="__codelineno-10-137" name="__codelineno-10-137" href="#__codelineno-10-137"></a>Each output byte depends on all 4 input bytes of column!
<a id="__codelineno-10-138" name="__codelineno-10-138" href="#__codelineno-10-138"></a>
<a id="__codelineno-10-139" name="__codelineno-10-139" href="#__codelineno-10-139"></a>
<a id="__codelineno-10-140" name="__codelineno-10-140" href="#__codelineno-10-140"></a> OPERATION 4: AddRoundKey (XOR with Round Key)               
<a id="__codelineno-10-141" name="__codelineno-10-141" href="#__codelineno-10-141"></a>
<a id="__codelineno-10-142" name="__codelineno-10-142" href="#__codelineno-10-142"></a>
<a id="__codelineno-10-143" name="__codelineno-10-143" href="#__codelineno-10-143"></a>XOR state with round-specific key
<a id="__codelineno-10-144" name="__codelineno-10-144" href="#__codelineno-10-144"></a>
<a id="__codelineno-10-145" name="__codelineno-10-145" href="#__codelineno-10-145"></a>State:                  RoundKey[i]:        Result:
<a id="__codelineno-10-146" name="__codelineno-10-146" href="#__codelineno-10-146"></a>                    
<a id="__codelineno-10-147" name="__codelineno-10-147" href="#__codelineno-10-147"></a> a0 b0 ..             k0 l0 ..     =    a0k0 .. 
<a id="__codelineno-10-148" name="__codelineno-10-148" href="#__codelineno-10-148"></a> a1 b1 ..              k1 l1 ..          a1k1 .. 
<a id="__codelineno-10-149" name="__codelineno-10-149" href="#__codelineno-10-149"></a> a2 b2 ..              k2 l2 ..          a2k2 .. 
<a id="__codelineno-10-150" name="__codelineno-10-150" href="#__codelineno-10-150"></a> a3 b3 ..              k3 l3 ..          a3k3 .. 
<a id="__codelineno-10-151" name="__codelineno-10-151" href="#__codelineno-10-151"></a>                    
<a id="__codelineno-10-152" name="__codelineno-10-152" href="#__codelineno-10-152"></a>
<a id="__codelineno-10-153" name="__codelineno-10-153" href="#__codelineno-10-153"></a>
<a id="__codelineno-10-154" name="__codelineno-10-154" href="#__codelineno-10-154"></a>
<a id="__codelineno-10-155" name="__codelineno-10-155" href="#__codelineno-10-155"></a>COMPLETE ROUND VISUALIZATION:
<a id="__codelineno-10-156" name="__codelineno-10-156" href="#__codelineno-10-156"></a>
<a id="__codelineno-10-157" name="__codelineno-10-157" href="#__codelineno-10-157"></a>
<a id="__codelineno-10-158" name="__codelineno-10-158" href="#__codelineno-10-158"></a>Input State
<a id="__codelineno-10-159" name="__codelineno-10-159" href="#__codelineno-10-159"></a>     
<a id="__codelineno-10-160" name="__codelineno-10-160" href="#__codelineno-10-160"></a>     
<a id="__codelineno-10-161" name="__codelineno-10-161" href="#__codelineno-10-161"></a>
<a id="__codelineno-10-162" name="__codelineno-10-162" href="#__codelineno-10-162"></a> SubBytes   Non-linear substitution (confusion)
<a id="__codelineno-10-163" name="__codelineno-10-163" href="#__codelineno-10-163"></a>
<a id="__codelineno-10-164" name="__codelineno-10-164" href="#__codelineno-10-164"></a>     
<a id="__codelineno-10-165" name="__codelineno-10-165" href="#__codelineno-10-165"></a>     
<a id="__codelineno-10-166" name="__codelineno-10-166" href="#__codelineno-10-166"></a>
<a id="__codelineno-10-167" name="__codelineno-10-167" href="#__codelineno-10-167"></a>ShiftRows   Transpose rows (diffusion)
<a id="__codelineno-10-168" name="__codelineno-10-168" href="#__codelineno-10-168"></a>
<a id="__codelineno-10-169" name="__codelineno-10-169" href="#__codelineno-10-169"></a>     
<a id="__codelineno-10-170" name="__codelineno-10-170" href="#__codelineno-10-170"></a>     
<a id="__codelineno-10-171" name="__codelineno-10-171" href="#__codelineno-10-171"></a>
<a id="__codelineno-10-172" name="__codelineno-10-172" href="#__codelineno-10-172"></a>MixColumns  Mix columns (diffusion) [Not in final round]
<a id="__codelineno-10-173" name="__codelineno-10-173" href="#__codelineno-10-173"></a>
<a id="__codelineno-10-174" name="__codelineno-10-174" href="#__codelineno-10-174"></a>     
<a id="__codelineno-10-175" name="__codelineno-10-175" href="#__codelineno-10-175"></a>     
<a id="__codelineno-10-176" name="__codelineno-10-176" href="#__codelineno-10-176"></a>
<a id="__codelineno-10-177" name="__codelineno-10-177" href="#__codelineno-10-177"></a>AddRndKey   XOR with round key
<a id="__codelineno-10-178" name="__codelineno-10-178" href="#__codelineno-10-178"></a>
<a id="__codelineno-10-179" name="__codelineno-10-179" href="#__codelineno-10-179"></a>     
<a id="__codelineno-10-180" name="__codelineno-10-180" href="#__codelineno-10-180"></a>     
<a id="__codelineno-10-181" name="__codelineno-10-181" href="#__codelineno-10-181"></a>Output State (input to next round)
<a id="__codelineno-10-182" name="__codelineno-10-182" href="#__codelineno-10-182"></a>
<a id="__codelineno-10-183" name="__codelineno-10-183" href="#__codelineno-10-183"></a>
<a id="__codelineno-10-184" name="__codelineno-10-184" href="#__codelineno-10-184"></a>
<a id="__codelineno-10-185" name="__codelineno-10-185" href="#__codelineno-10-185"></a>ROUND 10: Final Round (No MixColumns)
<a id="__codelineno-10-186" name="__codelineno-10-186" href="#__codelineno-10-186"></a>
<a id="__codelineno-10-187" name="__codelineno-10-187" href="#__codelineno-10-187"></a>
<a id="__codelineno-10-188" name="__codelineno-10-188" href="#__codelineno-10-188"></a>1. SubBytes
<a id="__codelineno-10-189" name="__codelineno-10-189" href="#__codelineno-10-189"></a>2. ShiftRows
<a id="__codelineno-10-190" name="__codelineno-10-190" href="#__codelineno-10-190"></a>3. AddRoundKey   Final round key
<a id="__codelineno-10-191" name="__codelineno-10-191" href="#__codelineno-10-191"></a>
<a id="__codelineno-10-192" name="__codelineno-10-192" href="#__codelineno-10-192"></a>Final State  CIPHERTEXT (16 bytes)
<a id="__codelineno-10-193" name="__codelineno-10-193" href="#__codelineno-10-193"></a>
<a id="__codelineno-10-194" name="__codelineno-10-194" href="#__codelineno-10-194"></a>
<a id="__codelineno-10-195" name="__codelineno-10-195" href="#__codelineno-10-195"></a>
<a id="__codelineno-10-196" name="__codelineno-10-196" href="#__codelineno-10-196"></a>KEY SCHEDULE (Round Key Generation):
<a id="__codelineno-10-197" name="__codelineno-10-197" href="#__codelineno-10-197"></a>
<a id="__codelineno-10-198" name="__codelineno-10-198" href="#__codelineno-10-198"></a>
<a id="__codelineno-10-199" name="__codelineno-10-199" href="#__codelineno-10-199"></a>Original Key (128-bit):
<a id="__codelineno-10-200" name="__codelineno-10-200" href="#__codelineno-10-200"></a>
<a id="__codelineno-10-201" name="__codelineno-10-201" href="#__codelineno-10-201"></a> K0  K1  K2  K3  K4  K5 ...  K14  K15  
<a id="__codelineno-10-202" name="__codelineno-10-202" href="#__codelineno-10-202"></a>
<a id="__codelineno-10-203" name="__codelineno-10-203" href="#__codelineno-10-203"></a>
<a id="__codelineno-10-204" name="__codelineno-10-204" href="#__codelineno-10-204"></a>Expand to 11 round keys (44 words):
<a id="__codelineno-10-205" name="__codelineno-10-205" href="#__codelineno-10-205"></a>RoundKey[0]:  w[0]  w[1]  w[2]  w[3]
<a id="__codelineno-10-206" name="__codelineno-10-206" href="#__codelineno-10-206"></a>RoundKey[1]:  w[4]  w[5]  w[6]  w[7]
<a id="__codelineno-10-207" name="__codelineno-10-207" href="#__codelineno-10-207"></a>RoundKey[2]:  w[8]  w[9]  w[10] w[11]
<a id="__codelineno-10-208" name="__codelineno-10-208" href="#__codelineno-10-208"></a>...
<a id="__codelineno-10-209" name="__codelineno-10-209" href="#__codelineno-10-209"></a>RoundKey[10]: w[40] w[41] w[42] w[43]
<a id="__codelineno-10-210" name="__codelineno-10-210" href="#__codelineno-10-210"></a>
<a id="__codelineno-10-211" name="__codelineno-10-211" href="#__codelineno-10-211"></a>Key expansion uses:
<a id="__codelineno-10-212" name="__codelineno-10-212" href="#__codelineno-10-212"></a>- RotWord: Circular byte rotation
<a id="__codelineno-10-213" name="__codelineno-10-213" href="#__codelineno-10-213"></a>- SubWord: S-box substitution  
<a id="__codelineno-10-214" name="__codelineno-10-214" href="#__codelineno-10-214"></a>- Rcon: Round constant XOR
<a id="__codelineno-10-215" name="__codelineno-10-215" href="#__codelineno-10-215"></a>
<a id="__codelineno-10-216" name="__codelineno-10-216" href="#__codelineno-10-216"></a>Example:
<a id="__codelineno-10-217" name="__codelineno-10-217" href="#__codelineno-10-217"></a>w[i] = w[i-4]  T(w[i-1])
<a id="__codelineno-10-218" name="__codelineno-10-218" href="#__codelineno-10-218"></a>where T() = SubWord(RotWord(w))  Rcon[i]
<a id="__codelineno-10-219" name="__codelineno-10-219" href="#__codelineno-10-219"></a>
<a id="__codelineno-10-220" name="__codelineno-10-220" href="#__codelineno-10-220"></a>
<a id="__codelineno-10-221" name="__codelineno-10-221" href="#__codelineno-10-221"></a>
<a id="__codelineno-10-222" name="__codelineno-10-222" href="#__codelineno-10-222"></a>WHY AES IS SECURE:
<a id="__codelineno-10-223" name="__codelineno-10-223" href="#__codelineno-10-223"></a>
<a id="__codelineno-10-224" name="__codelineno-10-224" href="#__codelineno-10-224"></a>
<a id="__codelineno-10-225" name="__codelineno-10-225" href="#__codelineno-10-225"></a>1. CONFUSION (SubBytes):
<a id="__codelineno-10-226" name="__codelineno-10-226" href="#__codelineno-10-226"></a>   Changes in plaintext/key produce complex changes in ciphertext
<a id="__codelineno-10-227" name="__codelineno-10-227" href="#__codelineno-10-227"></a>   Non-linear S-box prevents mathematical analysis
<a id="__codelineno-10-228" name="__codelineno-10-228" href="#__codelineno-10-228"></a>
<a id="__codelineno-10-229" name="__codelineno-10-229" href="#__codelineno-10-229"></a>2. DIFFUSION (ShiftRows + MixColumns):
<a id="__codelineno-10-230" name="__codelineno-10-230" href="#__codelineno-10-230"></a>   Each plaintext bit affects many ciphertext bits
<a id="__codelineno-10-231" name="__codelineno-10-231" href="#__codelineno-10-231"></a>   After 2 rounds: 1 bit affects all 128 bits!
<a id="__codelineno-10-232" name="__codelineno-10-232" href="#__codelineno-10-232"></a>
<a id="__codelineno-10-233" name="__codelineno-10-233" href="#__codelineno-10-233"></a>3. KEY MIXING (AddRoundKey):
<a id="__codelineno-10-234" name="__codelineno-10-234" href="#__codelineno-10-234"></a>   Different key for each round
<a id="__codelineno-10-235" name="__codelineno-10-235" href="#__codelineno-10-235"></a>   Prevents key recovery attacks
<a id="__codelineno-10-236" name="__codelineno-10-236" href="#__codelineno-10-236"></a>
<a id="__codelineno-10-237" name="__codelineno-10-237" href="#__codelineno-10-237"></a>4. MULTIPLE ROUNDS:
<a id="__codelineno-10-238" name="__codelineno-10-238" href="#__codelineno-10-238"></a>   10/12/14 rounds ensure complete diffusion
<a id="__codelineno-10-239" name="__codelineno-10-239" href="#__codelineno-10-239"></a>   Avalanche effect: changing 1 input bit flips ~50% output bits
<a id="__codelineno-10-240" name="__codelineno-10-240" href="#__codelineno-10-240"></a>
<a id="__codelineno-10-241" name="__codelineno-10-241" href="#__codelineno-10-241"></a>
<a id="__codelineno-10-242" name="__codelineno-10-242" href="#__codelineno-10-242"></a>
<a id="__codelineno-10-243" name="__codelineno-10-243" href="#__codelineno-10-243"></a>AVALANCHE EFFECT DEMONSTRATION:
<a id="__codelineno-10-244" name="__codelineno-10-244" href="#__codelineno-10-244"></a>
<a id="__codelineno-10-245" name="__codelineno-10-245" href="#__codelineno-10-245"></a>
<a id="__codelineno-10-246" name="__codelineno-10-246" href="#__codelineno-10-246"></a>Plaintext 1: &quot;Hello World!!!!&quot;
<a id="__codelineno-10-247" name="__codelineno-10-247" href="#__codelineno-10-247"></a>Plaintext 2: &quot;Hello World!!!!&quot; (last char changed to &#39;?&#39;)
<a id="__codelineno-10-248" name="__codelineno-10-248" href="#__codelineno-10-248"></a>                             Only 1 bit different
<a id="__codelineno-10-249" name="__codelineno-10-249" href="#__codelineno-10-249"></a>
<a id="__codelineno-10-250" name="__codelineno-10-250" href="#__codelineno-10-250"></a>After AES-128 encryption with same key:
<a id="__codelineno-10-251" name="__codelineno-10-251" href="#__codelineno-10-251"></a>
<a id="__codelineno-10-252" name="__codelineno-10-252" href="#__codelineno-10-252"></a>Ciphertext 1: A7 3B F2 8C 91 5D E4 2A 8F 1C 37 6B D9 E8 4F 5C
<a id="__codelineno-10-253" name="__codelineno-10-253" href="#__codelineno-10-253"></a>Ciphertext 2: 2D C9 8A 41 6F E3 B7 9D 53 A8 C2 1F 84 6E D5 29
<a id="__codelineno-10-254" name="__codelineno-10-254" href="#__codelineno-10-254"></a>                             
<a id="__codelineno-10-255" name="__codelineno-10-255" href="#__codelineno-10-255"></a>              All bytes completely different!
<a id="__codelineno-10-256" name="__codelineno-10-256" href="#__codelineno-10-256"></a>
<a id="__codelineno-10-257" name="__codelineno-10-257" href="#__codelineno-10-257"></a>64 bits out of 128 changed  Perfect avalanche!
</code></pre></div>
<h3 id="aes-implementation-example">AES Implementation Example</h3>
<p><strong>Complete AES Implementation with All Modes:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Random</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_random_bytes</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.Padding</span><span class="w"> </span><span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">AESCipher</span><span class="p">:</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="sd">    Complete AES implementation with multiple modes</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="sd">    Demonstrates all common AES modes of operation</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="sd">        Initialize AES cipher</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="sd">        key: 16, 24, or 32 bytes for AES-128, AES-192, or AES-256</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>            <span class="c1"># Generate random 256-bit key</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">32</span><span class="p">]:</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Key must be 16, 24, or 32 bytes&quot;</span><span class="p">)</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span>  <span class="c1"># 16 bytes</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>    <span class="c1"># </span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>    <span class="c1"># MODE 1: GCM (Galois/Counter Mode) - RECOMMENDED</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>    <span class="c1"># </span>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt_gcm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="sd">        Encrypt using AES-GCM (Authenticated Encryption)</span>
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a><span class="sd">        Advantages:</span>
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a><span class="sd">         Encryption + Authentication in one step</span>
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="sd">         Detects tampering</span>
<a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a><span class="sd">         Fast (parallelizable)</span>
<a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a><span class="sd">         No padding needed</span>
<a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a>
<a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a><span class="sd">        Returns: dict with ciphertext, nonce, and tag</span>
<a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-43" name="__codelineno-11-43" href="#__codelineno-11-43"></a>        <span class="c1"># Create cipher in GCM mode</span>
<a id="__codelineno-11-44" name="__codelineno-11-44" href="#__codelineno-11-44"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">)</span>
<a id="__codelineno-11-45" name="__codelineno-11-45" href="#__codelineno-11-45"></a>
<a id="__codelineno-11-46" name="__codelineno-11-46" href="#__codelineno-11-46"></a>        <span class="c1"># Encrypt and generate authentication tag</span>
<a id="__codelineno-11-47" name="__codelineno-11-47" href="#__codelineno-11-47"></a>        <span class="n">ciphertext</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt_and_digest</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-48" name="__codelineno-11-48" href="#__codelineno-11-48"></a>
<a id="__codelineno-11-49" name="__codelineno-11-49" href="#__codelineno-11-49"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-11-50" name="__codelineno-11-50" href="#__codelineno-11-50"></a>            <span class="s1">&#39;ciphertext&#39;</span><span class="p">:</span> <span class="n">ciphertext</span><span class="p">,</span>
<a id="__codelineno-11-51" name="__codelineno-11-51" href="#__codelineno-11-51"></a>            <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="n">cipher</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span>  <span class="c1"># 16 bytes, must be unique</span>
<a id="__codelineno-11-52" name="__codelineno-11-52" href="#__codelineno-11-52"></a>            <span class="s1">&#39;tag&#39;</span><span class="p">:</span> <span class="n">tag</span>              <span class="c1"># 16 bytes authentication tag</span>
<a id="__codelineno-11-53" name="__codelineno-11-53" href="#__codelineno-11-53"></a>        <span class="p">}</span>
<a id="__codelineno-11-54" name="__codelineno-11-54" href="#__codelineno-11-54"></a>
<a id="__codelineno-11-55" name="__codelineno-11-55" href="#__codelineno-11-55"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt_gcm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-11-56" name="__codelineno-11-56" href="#__codelineno-11-56"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-57" name="__codelineno-11-57" href="#__codelineno-11-57"></a><span class="sd">        Decrypt and verify AES-GCM</span>
<a id="__codelineno-11-58" name="__codelineno-11-58" href="#__codelineno-11-58"></a><span class="sd">        Raises ValueError if authentication fails (tampered data)</span>
<a id="__codelineno-11-59" name="__codelineno-11-59" href="#__codelineno-11-59"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-60" name="__codelineno-11-60" href="#__codelineno-11-60"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<a id="__codelineno-11-61" name="__codelineno-11-61" href="#__codelineno-11-61"></a>
<a id="__codelineno-11-62" name="__codelineno-11-62" href="#__codelineno-11-62"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-11-63" name="__codelineno-11-63" href="#__codelineno-11-63"></a>            <span class="c1"># Decrypt and verify in one step</span>
<a id="__codelineno-11-64" name="__codelineno-11-64" href="#__codelineno-11-64"></a>            <span class="n">plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt_and_verify</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
<a id="__codelineno-11-65" name="__codelineno-11-65" href="#__codelineno-11-65"></a>            <span class="k">return</span> <span class="n">plaintext</span>
<a id="__codelineno-11-66" name="__codelineno-11-66" href="#__codelineno-11-66"></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
<a id="__codelineno-11-67" name="__codelineno-11-67" href="#__codelineno-11-67"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Authentication failed! Data was tampered with.&quot;</span><span class="p">)</span>
<a id="__codelineno-11-68" name="__codelineno-11-68" href="#__codelineno-11-68"></a>
<a id="__codelineno-11-69" name="__codelineno-11-69" href="#__codelineno-11-69"></a>    <span class="c1"># </span>
<a id="__codelineno-11-70" name="__codelineno-11-70" href="#__codelineno-11-70"></a>    <span class="c1"># MODE 2: CBC (Cipher Block Chaining) - TRADITIONAL</span>
<a id="__codelineno-11-71" name="__codelineno-11-71" href="#__codelineno-11-71"></a>    <span class="c1"># </span>
<a id="__codelineno-11-72" name="__codelineno-11-72" href="#__codelineno-11-72"></a>
<a id="__codelineno-11-73" name="__codelineno-11-73" href="#__codelineno-11-73"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt_cbc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-11-74" name="__codelineno-11-74" href="#__codelineno-11-74"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-75" name="__codelineno-11-75" href="#__codelineno-11-75"></a><span class="sd">        Encrypt using AES-CBC mode</span>
<a id="__codelineno-11-76" name="__codelineno-11-76" href="#__codelineno-11-76"></a>
<a id="__codelineno-11-77" name="__codelineno-11-77" href="#__codelineno-11-77"></a><span class="sd">        Characteristics:</span>
<a id="__codelineno-11-78" name="__codelineno-11-78" href="#__codelineno-11-78"></a><span class="sd">         Each block depends on previous block</span>
<a id="__codelineno-11-79" name="__codelineno-11-79" href="#__codelineno-11-79"></a><span class="sd">         Requires padding</span>
<a id="__codelineno-11-80" name="__codelineno-11-80" href="#__codelineno-11-80"></a><span class="sd">         Requires IV (Initialization Vector)</span>
<a id="__codelineno-11-81" name="__codelineno-11-81" href="#__codelineno-11-81"></a><span class="sd">         No authentication (use HMAC separately)</span>
<a id="__codelineno-11-82" name="__codelineno-11-82" href="#__codelineno-11-82"></a>
<a id="__codelineno-11-83" name="__codelineno-11-83" href="#__codelineno-11-83"></a><span class="sd">        Returns: dict with ciphertext and IV</span>
<a id="__codelineno-11-84" name="__codelineno-11-84" href="#__codelineno-11-84"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-85" name="__codelineno-11-85" href="#__codelineno-11-85"></a>        <span class="c1"># Generate random IV (must be unpredictable)</span>
<a id="__codelineno-11-86" name="__codelineno-11-86" href="#__codelineno-11-86"></a>        <span class="n">iv</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
<a id="__codelineno-11-87" name="__codelineno-11-87" href="#__codelineno-11-87"></a>
<a id="__codelineno-11-88" name="__codelineno-11-88" href="#__codelineno-11-88"></a>        <span class="c1"># Create cipher</span>
<a id="__codelineno-11-89" name="__codelineno-11-89" href="#__codelineno-11-89"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
<a id="__codelineno-11-90" name="__codelineno-11-90" href="#__codelineno-11-90"></a>
<a id="__codelineno-11-91" name="__codelineno-11-91" href="#__codelineno-11-91"></a>        <span class="c1"># Pad plaintext to block size (PKCS7 padding)</span>
<a id="__codelineno-11-92" name="__codelineno-11-92" href="#__codelineno-11-92"></a>        <span class="n">padded_plaintext</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
<a id="__codelineno-11-93" name="__codelineno-11-93" href="#__codelineno-11-93"></a>
<a id="__codelineno-11-94" name="__codelineno-11-94" href="#__codelineno-11-94"></a>        <span class="c1"># Encrypt</span>
<a id="__codelineno-11-95" name="__codelineno-11-95" href="#__codelineno-11-95"></a>        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">padded_plaintext</span><span class="p">)</span>
<a id="__codelineno-11-96" name="__codelineno-11-96" href="#__codelineno-11-96"></a>
<a id="__codelineno-11-97" name="__codelineno-11-97" href="#__codelineno-11-97"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-11-98" name="__codelineno-11-98" href="#__codelineno-11-98"></a>            <span class="s1">&#39;ciphertext&#39;</span><span class="p">:</span> <span class="n">ciphertext</span><span class="p">,</span>
<a id="__codelineno-11-99" name="__codelineno-11-99" href="#__codelineno-11-99"></a>            <span class="s1">&#39;iv&#39;</span><span class="p">:</span> <span class="n">iv</span>
<a id="__codelineno-11-100" name="__codelineno-11-100" href="#__codelineno-11-100"></a>        <span class="p">}</span>
<a id="__codelineno-11-101" name="__codelineno-11-101" href="#__codelineno-11-101"></a>
<a id="__codelineno-11-102" name="__codelineno-11-102" href="#__codelineno-11-102"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt_cbc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">iv</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-11-103" name="__codelineno-11-103" href="#__codelineno-11-103"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypt AES-CBC&quot;&quot;&quot;</span>
<a id="__codelineno-11-104" name="__codelineno-11-104" href="#__codelineno-11-104"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
<a id="__codelineno-11-105" name="__codelineno-11-105" href="#__codelineno-11-105"></a>        <span class="n">padded_plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<a id="__codelineno-11-106" name="__codelineno-11-106" href="#__codelineno-11-106"></a>
<a id="__codelineno-11-107" name="__codelineno-11-107" href="#__codelineno-11-107"></a>        <span class="c1"># Remove padding</span>
<a id="__codelineno-11-108" name="__codelineno-11-108" href="#__codelineno-11-108"></a>        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">padded_plaintext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
<a id="__codelineno-11-109" name="__codelineno-11-109" href="#__codelineno-11-109"></a>        <span class="k">return</span> <span class="n">plaintext</span>
<a id="__codelineno-11-110" name="__codelineno-11-110" href="#__codelineno-11-110"></a>
<a id="__codelineno-11-111" name="__codelineno-11-111" href="#__codelineno-11-111"></a>    <span class="c1"># </span>
<a id="__codelineno-11-112" name="__codelineno-11-112" href="#__codelineno-11-112"></a>    <span class="c1"># MODE 3: CTR (Counter Mode) - STREAM CIPHER</span>
<a id="__codelineno-11-113" name="__codelineno-11-113" href="#__codelineno-11-113"></a>    <span class="c1"># </span>
<a id="__codelineno-11-114" name="__codelineno-11-114" href="#__codelineno-11-114"></a>
<a id="__codelineno-11-115" name="__codelineno-11-115" href="#__codelineno-11-115"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt_ctr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-11-116" name="__codelineno-11-116" href="#__codelineno-11-116"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-117" name="__codelineno-11-117" href="#__codelineno-11-117"></a><span class="sd">        Encrypt using AES-CTR mode</span>
<a id="__codelineno-11-118" name="__codelineno-11-118" href="#__codelineno-11-118"></a>
<a id="__codelineno-11-119" name="__codelineno-11-119" href="#__codelineno-11-119"></a><span class="sd">        Characteristics:</span>
<a id="__codelineno-11-120" name="__codelineno-11-120" href="#__codelineno-11-120"></a><span class="sd">         Turns block cipher into stream cipher</span>
<a id="__codelineno-11-121" name="__codelineno-11-121" href="#__codelineno-11-121"></a><span class="sd">         Parallelizable (fast)</span>
<a id="__codelineno-11-122" name="__codelineno-11-122" href="#__codelineno-11-122"></a><span class="sd">         Random access to encrypted data</span>
<a id="__codelineno-11-123" name="__codelineno-11-123" href="#__codelineno-11-123"></a><span class="sd">         No padding needed</span>
<a id="__codelineno-11-124" name="__codelineno-11-124" href="#__codelineno-11-124"></a><span class="sd">         No authentication</span>
<a id="__codelineno-11-125" name="__codelineno-11-125" href="#__codelineno-11-125"></a>
<a id="__codelineno-11-126" name="__codelineno-11-126" href="#__codelineno-11-126"></a><span class="sd">        Returns: dict with ciphertext and nonce</span>
<a id="__codelineno-11-127" name="__codelineno-11-127" href="#__codelineno-11-127"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-128" name="__codelineno-11-128" href="#__codelineno-11-128"></a>        <span class="c1"># Generate random nonce (number used once)</span>
<a id="__codelineno-11-129" name="__codelineno-11-129" href="#__codelineno-11-129"></a>        <span class="n">nonce</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># CTR uses 8-byte nonce</span>
<a id="__codelineno-11-130" name="__codelineno-11-130" href="#__codelineno-11-130"></a>
<a id="__codelineno-11-131" name="__codelineno-11-131" href="#__codelineno-11-131"></a>        <span class="c1"># Create cipher (nonce will be used as counter prefix)</span>
<a id="__codelineno-11-132" name="__codelineno-11-132" href="#__codelineno-11-132"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<a id="__codelineno-11-133" name="__codelineno-11-133" href="#__codelineno-11-133"></a>
<a id="__codelineno-11-134" name="__codelineno-11-134" href="#__codelineno-11-134"></a>        <span class="c1"># Encrypt (works on any length, no padding)</span>
<a id="__codelineno-11-135" name="__codelineno-11-135" href="#__codelineno-11-135"></a>        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-136" name="__codelineno-11-136" href="#__codelineno-11-136"></a>
<a id="__codelineno-11-137" name="__codelineno-11-137" href="#__codelineno-11-137"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-11-138" name="__codelineno-11-138" href="#__codelineno-11-138"></a>            <span class="s1">&#39;ciphertext&#39;</span><span class="p">:</span> <span class="n">ciphertext</span><span class="p">,</span>
<a id="__codelineno-11-139" name="__codelineno-11-139" href="#__codelineno-11-139"></a>            <span class="s1">&#39;nonce&#39;</span><span class="p">:</span> <span class="n">nonce</span>
<a id="__codelineno-11-140" name="__codelineno-11-140" href="#__codelineno-11-140"></a>        <span class="p">}</span>
<a id="__codelineno-11-141" name="__codelineno-11-141" href="#__codelineno-11-141"></a>
<a id="__codelineno-11-142" name="__codelineno-11-142" href="#__codelineno-11-142"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt_ctr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-11-143" name="__codelineno-11-143" href="#__codelineno-11-143"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypt AES-CTR&quot;&quot;&quot;</span>
<a id="__codelineno-11-144" name="__codelineno-11-144" href="#__codelineno-11-144"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CTR</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<a id="__codelineno-11-145" name="__codelineno-11-145" href="#__codelineno-11-145"></a>        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<a id="__codelineno-11-146" name="__codelineno-11-146" href="#__codelineno-11-146"></a>        <span class="k">return</span> <span class="n">plaintext</span>
<a id="__codelineno-11-147" name="__codelineno-11-147" href="#__codelineno-11-147"></a>
<a id="__codelineno-11-148" name="__codelineno-11-148" href="#__codelineno-11-148"></a>    <span class="c1"># </span>
<a id="__codelineno-11-149" name="__codelineno-11-149" href="#__codelineno-11-149"></a>    <span class="c1"># MODE 4: ECB (Electronic Codebook) - NOT RECOMMENDED</span>
<a id="__codelineno-11-150" name="__codelineno-11-150" href="#__codelineno-11-150"></a>    <span class="c1"># </span>
<a id="__codelineno-11-151" name="__codelineno-11-151" href="#__codelineno-11-151"></a>
<a id="__codelineno-11-152" name="__codelineno-11-152" href="#__codelineno-11-152"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt_ecb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-11-153" name="__codelineno-11-153" href="#__codelineno-11-153"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-154" name="__codelineno-11-154" href="#__codelineno-11-154"></a><span class="sd">        Encrypt using AES-ECB mode</span>
<a id="__codelineno-11-155" name="__codelineno-11-155" href="#__codelineno-11-155"></a>
<a id="__codelineno-11-156" name="__codelineno-11-156" href="#__codelineno-11-156"></a><span class="sd">          WARNING: NOT SECURE FOR MOST USE CASES</span>
<a id="__codelineno-11-157" name="__codelineno-11-157" href="#__codelineno-11-157"></a><span class="sd">         Same plaintext block  same ciphertext block</span>
<a id="__codelineno-11-158" name="__codelineno-11-158" href="#__codelineno-11-158"></a><span class="sd">         Patterns visible in ciphertext</span>
<a id="__codelineno-11-159" name="__codelineno-11-159" href="#__codelineno-11-159"></a><span class="sd">         No IV/nonce</span>
<a id="__codelineno-11-160" name="__codelineno-11-160" href="#__codelineno-11-160"></a>
<a id="__codelineno-11-161" name="__codelineno-11-161" href="#__codelineno-11-161"></a><span class="sd">        Only use for encrypting random data (like keys)</span>
<a id="__codelineno-11-162" name="__codelineno-11-162" href="#__codelineno-11-162"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-163" name="__codelineno-11-163" href="#__codelineno-11-163"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<a id="__codelineno-11-164" name="__codelineno-11-164" href="#__codelineno-11-164"></a>        <span class="n">padded_plaintext</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
<a id="__codelineno-11-165" name="__codelineno-11-165" href="#__codelineno-11-165"></a>        <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">padded_plaintext</span><span class="p">)</span>
<a id="__codelineno-11-166" name="__codelineno-11-166" href="#__codelineno-11-166"></a>        <span class="k">return</span> <span class="n">ciphertext</span>
<a id="__codelineno-11-167" name="__codelineno-11-167" href="#__codelineno-11-167"></a>
<a id="__codelineno-11-168" name="__codelineno-11-168" href="#__codelineno-11-168"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt_ecb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-11-169" name="__codelineno-11-169" href="#__codelineno-11-169"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypt AES-ECB&quot;&quot;&quot;</span>
<a id="__codelineno-11-170" name="__codelineno-11-170" href="#__codelineno-11-170"></a>        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<a id="__codelineno-11-171" name="__codelineno-11-171" href="#__codelineno-11-171"></a>        <span class="n">padded_plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<a id="__codelineno-11-172" name="__codelineno-11-172" href="#__codelineno-11-172"></a>        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">padded_plaintext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span>
<a id="__codelineno-11-173" name="__codelineno-11-173" href="#__codelineno-11-173"></a>        <span class="k">return</span> <span class="n">plaintext</span>
<a id="__codelineno-11-174" name="__codelineno-11-174" href="#__codelineno-11-174"></a>
<a id="__codelineno-11-175" name="__codelineno-11-175" href="#__codelineno-11-175"></a>
<a id="__codelineno-11-176" name="__codelineno-11-176" href="#__codelineno-11-176"></a><span class="c1"># </span>
<a id="__codelineno-11-177" name="__codelineno-11-177" href="#__codelineno-11-177"></a><span class="c1"># USAGE EXAMPLES</span>
<a id="__codelineno-11-178" name="__codelineno-11-178" href="#__codelineno-11-178"></a><span class="c1"># </span>
<a id="__codelineno-11-179" name="__codelineno-11-179" href="#__codelineno-11-179"></a>
<a id="__codelineno-11-180" name="__codelineno-11-180" href="#__codelineno-11-180"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-11-181" name="__codelineno-11-181" href="#__codelineno-11-181"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-182" name="__codelineno-11-182" href="#__codelineno-11-182"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AES ENCRYPTION DEMONSTRATION&quot;</span><span class="p">)</span>
<a id="__codelineno-11-183" name="__codelineno-11-183" href="#__codelineno-11-183"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-184" name="__codelineno-11-184" href="#__codelineno-11-184"></a>
<a id="__codelineno-11-185" name="__codelineno-11-185" href="#__codelineno-11-185"></a>    <span class="c1"># Initialize cipher with 256-bit key</span>
<a id="__codelineno-11-186" name="__codelineno-11-186" href="#__codelineno-11-186"></a>    <span class="n">aes</span> <span class="o">=</span> <span class="n">AESCipher</span><span class="p">()</span>
<a id="__codelineno-11-187" name="__codelineno-11-187" href="#__codelineno-11-187"></a>
<a id="__codelineno-11-188" name="__codelineno-11-188" href="#__codelineno-11-188"></a>    <span class="c1"># Test data</span>
<a id="__codelineno-11-189" name="__codelineno-11-189" href="#__codelineno-11-189"></a>    <span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;This is a secret message that needs encryption!&quot;</span>
<a id="__codelineno-11-190" name="__codelineno-11-190" href="#__codelineno-11-190"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Original: </span><span class="si">{</span><span class="n">plaintext</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-191" name="__codelineno-11-191" href="#__codelineno-11-191"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<a id="__codelineno-11-192" name="__codelineno-11-192" href="#__codelineno-11-192"></a>
<a id="__codelineno-11-193" name="__codelineno-11-193" href="#__codelineno-11-193"></a>    <span class="c1"># </span>
<a id="__codelineno-11-194" name="__codelineno-11-194" href="#__codelineno-11-194"></a>    <span class="c1"># Example 1: AES-GCM (RECOMMENDED)</span>
<a id="__codelineno-11-195" name="__codelineno-11-195" href="#__codelineno-11-195"></a>    <span class="c1"># </span>
<a id="__codelineno-11-196" name="__codelineno-11-196" href="#__codelineno-11-196"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-197" name="__codelineno-11-197" href="#__codelineno-11-197"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. AES-256-GCM (Best for most use cases)&quot;</span><span class="p">)</span>
<a id="__codelineno-11-198" name="__codelineno-11-198" href="#__codelineno-11-198"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-199" name="__codelineno-11-199" href="#__codelineno-11-199"></a>
<a id="__codelineno-11-200" name="__codelineno-11-200" href="#__codelineno-11-200"></a>    <span class="c1"># Encrypt</span>
<a id="__codelineno-11-201" name="__codelineno-11-201" href="#__codelineno-11-201"></a>    <span class="n">encrypted_gcm</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt_gcm</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-202" name="__codelineno-11-202" href="#__codelineno-11-202"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">60</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-11-203" name="__codelineno-11-203" href="#__codelineno-11-203"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nonce: </span><span class="si">{</span><span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-204" name="__codelineno-11-204" href="#__codelineno-11-204"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tag: </span><span class="si">{</span><span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-205" name="__codelineno-11-205" href="#__codelineno-11-205"></a>
<a id="__codelineno-11-206" name="__codelineno-11-206" href="#__codelineno-11-206"></a>    <span class="c1"># Decrypt</span>
<a id="__codelineno-11-207" name="__codelineno-11-207" href="#__codelineno-11-207"></a>    <span class="n">decrypted_gcm</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">decrypt_gcm</span><span class="p">(</span>
<a id="__codelineno-11-208" name="__codelineno-11-208" href="#__codelineno-11-208"></a>        <span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">],</span>
<a id="__codelineno-11-209" name="__codelineno-11-209" href="#__codelineno-11-209"></a>        <span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">],</span>
<a id="__codelineno-11-210" name="__codelineno-11-210" href="#__codelineno-11-210"></a>        <span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span>
<a id="__codelineno-11-211" name="__codelineno-11-211" href="#__codelineno-11-211"></a>    <span class="p">)</span>
<a id="__codelineno-11-212" name="__codelineno-11-212" href="#__codelineno-11-212"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted_gcm</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-213" name="__codelineno-11-213" href="#__codelineno-11-213"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Match: </span><span class="si">{</span><span class="n">decrypted_gcm</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">plaintext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-214" name="__codelineno-11-214" href="#__codelineno-11-214"></a>
<a id="__codelineno-11-215" name="__codelineno-11-215" href="#__codelineno-11-215"></a>    <span class="c1"># Test tampering detection</span>
<a id="__codelineno-11-216" name="__codelineno-11-216" href="#__codelineno-11-216"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Testing tamper detection...&quot;</span><span class="p">)</span>
<a id="__codelineno-11-217" name="__codelineno-11-217" href="#__codelineno-11-217"></a>    <span class="n">tampered_ciphertext</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">])</span>
<a id="__codelineno-11-218" name="__codelineno-11-218" href="#__codelineno-11-218"></a>    <span class="n">tampered_ciphertext</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="mh">0x01</span>  <span class="c1"># Flip one bit</span>
<a id="__codelineno-11-219" name="__codelineno-11-219" href="#__codelineno-11-219"></a>
<a id="__codelineno-11-220" name="__codelineno-11-220" href="#__codelineno-11-220"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-11-221" name="__codelineno-11-221" href="#__codelineno-11-221"></a>        <span class="n">aes</span><span class="o">.</span><span class="n">decrypt_gcm</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">tampered_ciphertext</span><span class="p">),</span> 
<a id="__codelineno-11-222" name="__codelineno-11-222" href="#__codelineno-11-222"></a>                       <span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">],</span> 
<a id="__codelineno-11-223" name="__codelineno-11-223" href="#__codelineno-11-223"></a>                       <span class="n">encrypted_gcm</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>
<a id="__codelineno-11-224" name="__codelineno-11-224" href="#__codelineno-11-224"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Tampering not detected!&quot;</span><span class="p">)</span>
<a id="__codelineno-11-225" name="__codelineno-11-225" href="#__codelineno-11-225"></a>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-11-226" name="__codelineno-11-226" href="#__codelineno-11-226"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Tampering detected: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-227" name="__codelineno-11-227" href="#__codelineno-11-227"></a>
<a id="__codelineno-11-228" name="__codelineno-11-228" href="#__codelineno-11-228"></a>    <span class="c1"># </span>
<a id="__codelineno-11-229" name="__codelineno-11-229" href="#__codelineno-11-229"></a>    <span class="c1"># Example 2: AES-CBC</span>
<a id="__codelineno-11-230" name="__codelineno-11-230" href="#__codelineno-11-230"></a>    <span class="c1"># </span>
<a id="__codelineno-11-231" name="__codelineno-11-231" href="#__codelineno-11-231"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-232" name="__codelineno-11-232" href="#__codelineno-11-232"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. AES-256-CBC (Traditional mode)&quot;</span><span class="p">)</span>
<a id="__codelineno-11-233" name="__codelineno-11-233" href="#__codelineno-11-233"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-234" name="__codelineno-11-234" href="#__codelineno-11-234"></a>
<a id="__codelineno-11-235" name="__codelineno-11-235" href="#__codelineno-11-235"></a>    <span class="n">encrypted_cbc</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt_cbc</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-236" name="__codelineno-11-236" href="#__codelineno-11-236"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">encrypted_cbc</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">60</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-11-237" name="__codelineno-11-237" href="#__codelineno-11-237"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IV: </span><span class="si">{</span><span class="n">encrypted_cbc</span><span class="p">[</span><span class="s1">&#39;iv&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-238" name="__codelineno-11-238" href="#__codelineno-11-238"></a>
<a id="__codelineno-11-239" name="__codelineno-11-239" href="#__codelineno-11-239"></a>    <span class="n">decrypted_cbc</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">decrypt_cbc</span><span class="p">(</span>
<a id="__codelineno-11-240" name="__codelineno-11-240" href="#__codelineno-11-240"></a>        <span class="n">encrypted_cbc</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">],</span>
<a id="__codelineno-11-241" name="__codelineno-11-241" href="#__codelineno-11-241"></a>        <span class="n">encrypted_cbc</span><span class="p">[</span><span class="s1">&#39;iv&#39;</span><span class="p">]</span>
<a id="__codelineno-11-242" name="__codelineno-11-242" href="#__codelineno-11-242"></a>    <span class="p">)</span>
<a id="__codelineno-11-243" name="__codelineno-11-243" href="#__codelineno-11-243"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted_cbc</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-244" name="__codelineno-11-244" href="#__codelineno-11-244"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Match: </span><span class="si">{</span><span class="n">decrypted_cbc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">plaintext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-245" name="__codelineno-11-245" href="#__codelineno-11-245"></a>
<a id="__codelineno-11-246" name="__codelineno-11-246" href="#__codelineno-11-246"></a>    <span class="c1"># </span>
<a id="__codelineno-11-247" name="__codelineno-11-247" href="#__codelineno-11-247"></a>    <span class="c1"># Example 3: AES-CTR</span>
<a id="__codelineno-11-248" name="__codelineno-11-248" href="#__codelineno-11-248"></a>    <span class="c1"># </span>
<a id="__codelineno-11-249" name="__codelineno-11-249" href="#__codelineno-11-249"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-250" name="__codelineno-11-250" href="#__codelineno-11-250"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. AES-256-CTR (Stream cipher mode)&quot;</span><span class="p">)</span>
<a id="__codelineno-11-251" name="__codelineno-11-251" href="#__codelineno-11-251"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-252" name="__codelineno-11-252" href="#__codelineno-11-252"></a>
<a id="__codelineno-11-253" name="__codelineno-11-253" href="#__codelineno-11-253"></a>    <span class="n">encrypted_ctr</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt_ctr</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-254" name="__codelineno-11-254" href="#__codelineno-11-254"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">encrypted_ctr</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">60</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-11-255" name="__codelineno-11-255" href="#__codelineno-11-255"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nonce: </span><span class="si">{</span><span class="n">encrypted_ctr</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-256" name="__codelineno-11-256" href="#__codelineno-11-256"></a>
<a id="__codelineno-11-257" name="__codelineno-11-257" href="#__codelineno-11-257"></a>    <span class="n">decrypted_ctr</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">decrypt_ctr</span><span class="p">(</span>
<a id="__codelineno-11-258" name="__codelineno-11-258" href="#__codelineno-11-258"></a>        <span class="n">encrypted_ctr</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">],</span>
<a id="__codelineno-11-259" name="__codelineno-11-259" href="#__codelineno-11-259"></a>        <span class="n">encrypted_ctr</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">]</span>
<a id="__codelineno-11-260" name="__codelineno-11-260" href="#__codelineno-11-260"></a>    <span class="p">)</span>
<a id="__codelineno-11-261" name="__codelineno-11-261" href="#__codelineno-11-261"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted_ctr</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-262" name="__codelineno-11-262" href="#__codelineno-11-262"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Match: </span><span class="si">{</span><span class="n">decrypted_ctr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">plaintext</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-263" name="__codelineno-11-263" href="#__codelineno-11-263"></a>
<a id="__codelineno-11-264" name="__codelineno-11-264" href="#__codelineno-11-264"></a>    <span class="c1"># </span>
<a id="__codelineno-11-265" name="__codelineno-11-265" href="#__codelineno-11-265"></a>    <span class="c1"># Example 4: Key Size Comparison</span>
<a id="__codelineno-11-266" name="__codelineno-11-266" href="#__codelineno-11-266"></a>    <span class="c1"># </span>
<a id="__codelineno-11-267" name="__codelineno-11-267" href="#__codelineno-11-267"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-268" name="__codelineno-11-268" href="#__codelineno-11-268"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Key Size Comparison&quot;</span><span class="p">)</span>
<a id="__codelineno-11-269" name="__codelineno-11-269" href="#__codelineno-11-269"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-270" name="__codelineno-11-270" href="#__codelineno-11-270"></a>
<a id="__codelineno-11-271" name="__codelineno-11-271" href="#__codelineno-11-271"></a>    <span class="n">key_sizes</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-11-272" name="__codelineno-11-272" href="#__codelineno-11-272"></a>        <span class="s1">&#39;AES-128&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
<a id="__codelineno-11-273" name="__codelineno-11-273" href="#__codelineno-11-273"></a>        <span class="s1">&#39;AES-192&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span>
<a id="__codelineno-11-274" name="__codelineno-11-274" href="#__codelineno-11-274"></a>        <span class="s1">&#39;AES-256&#39;</span><span class="p">:</span> <span class="mi">32</span>
<a id="__codelineno-11-275" name="__codelineno-11-275" href="#__codelineno-11-275"></a>    <span class="p">}</span>
<a id="__codelineno-11-276" name="__codelineno-11-276" href="#__codelineno-11-276"></a>
<a id="__codelineno-11-277" name="__codelineno-11-277" href="#__codelineno-11-277"></a>    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">key_sizes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-11-278" name="__codelineno-11-278" href="#__codelineno-11-278"></a>        <span class="n">key</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
<a id="__codelineno-11-279" name="__codelineno-11-279" href="#__codelineno-11-279"></a>        <span class="n">aes_test</span> <span class="o">=</span> <span class="n">AESCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-11-280" name="__codelineno-11-280" href="#__codelineno-11-280"></a>        <span class="n">enc</span> <span class="o">=</span> <span class="n">aes_test</span><span class="o">.</span><span class="n">encrypt_gcm</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
<a id="__codelineno-11-281" name="__codelineno-11-281" href="#__codelineno-11-281"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: Key=</span><span class="si">{</span><span class="n">size</span><span class="o">*</span><span class="mi">8</span><span class="si">}</span><span class="s2"> bits, &quot;</span>
<a id="__codelineno-11-282" name="__codelineno-11-282" href="#__codelineno-11-282"></a>              <span class="sa">f</span><span class="s2">&quot;Rounds=</span><span class="si">{</span><span class="mi">10</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">size</span><span class="o">==</span><span class="mi">16</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">size</span><span class="o">==</span><span class="mi">24</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="mi">14</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-283" name="__codelineno-11-283" href="#__codelineno-11-283"></a>
<a id="__codelineno-11-284" name="__codelineno-11-284" href="#__codelineno-11-284"></a>    <span class="c1"># </span>
<a id="__codelineno-11-285" name="__codelineno-11-285" href="#__codelineno-11-285"></a>    <span class="c1"># Example 5: File Encryption</span>
<a id="__codelineno-11-286" name="__codelineno-11-286" href="#__codelineno-11-286"></a>    <span class="c1"># </span>
<a id="__codelineno-11-287" name="__codelineno-11-287" href="#__codelineno-11-287"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-288" name="__codelineno-11-288" href="#__codelineno-11-288"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5. File Encryption Example&quot;</span><span class="p">)</span>
<a id="__codelineno-11-289" name="__codelineno-11-289" href="#__codelineno-11-289"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-290" name="__codelineno-11-290" href="#__codelineno-11-290"></a>
<a id="__codelineno-11-291" name="__codelineno-11-291" href="#__codelineno-11-291"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">encrypt_file</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
<a id="__codelineno-11-292" name="__codelineno-11-292" href="#__codelineno-11-292"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Encrypt a file using AES-GCM&quot;&quot;&quot;</span>
<a id="__codelineno-11-293" name="__codelineno-11-293" href="#__codelineno-11-293"></a>        <span class="c1"># Read file</span>
<a id="__codelineno-11-294" name="__codelineno-11-294" href="#__codelineno-11-294"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-11-295" name="__codelineno-11-295" href="#__codelineno-11-295"></a>            <span class="n">plaintext</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-11-296" name="__codelineno-11-296" href="#__codelineno-11-296"></a>
<a id="__codelineno-11-297" name="__codelineno-11-297" href="#__codelineno-11-297"></a>        <span class="c1"># Encrypt</span>
<a id="__codelineno-11-298" name="__codelineno-11-298" href="#__codelineno-11-298"></a>        <span class="n">aes</span> <span class="o">=</span> <span class="n">AESCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-11-299" name="__codelineno-11-299" href="#__codelineno-11-299"></a>        <span class="n">encrypted</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">encrypt_gcm</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-300" name="__codelineno-11-300" href="#__codelineno-11-300"></a>
<a id="__codelineno-11-301" name="__codelineno-11-301" href="#__codelineno-11-301"></a>        <span class="c1"># Save encrypted file</span>
<a id="__codelineno-11-302" name="__codelineno-11-302" href="#__codelineno-11-302"></a>        <span class="n">encrypted_filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.enc&#39;</span>
<a id="__codelineno-11-303" name="__codelineno-11-303" href="#__codelineno-11-303"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">encrypted_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-11-304" name="__codelineno-11-304" href="#__codelineno-11-304"></a>            <span class="c1"># Save nonce (16 bytes)</span>
<a id="__codelineno-11-305" name="__codelineno-11-305" href="#__codelineno-11-305"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">])</span>
<a id="__codelineno-11-306" name="__codelineno-11-306" href="#__codelineno-11-306"></a>            <span class="c1"># Save tag (16 bytes)</span>
<a id="__codelineno-11-307" name="__codelineno-11-307" href="#__codelineno-11-307"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span>
<a id="__codelineno-11-308" name="__codelineno-11-308" href="#__codelineno-11-308"></a>            <span class="c1"># Save ciphertext</span>
<a id="__codelineno-11-309" name="__codelineno-11-309" href="#__codelineno-11-309"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">encrypted</span><span class="p">[</span><span class="s1">&#39;ciphertext&#39;</span><span class="p">])</span>
<a id="__codelineno-11-310" name="__codelineno-11-310" href="#__codelineno-11-310"></a>
<a id="__codelineno-11-311" name="__codelineno-11-311" href="#__codelineno-11-311"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Encrypted: </span><span class="si">{</span><span class="n">encrypted_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-312" name="__codelineno-11-312" href="#__codelineno-11-312"></a>        <span class="k">return</span> <span class="n">encrypted_filename</span>
<a id="__codelineno-11-313" name="__codelineno-11-313" href="#__codelineno-11-313"></a>
<a id="__codelineno-11-314" name="__codelineno-11-314" href="#__codelineno-11-314"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decrypt_file</span><span class="p">(</span><span class="n">encrypted_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-11-315" name="__codelineno-11-315" href="#__codelineno-11-315"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Decrypt a file encrypted with AES-GCM&quot;&quot;&quot;</span>
<a id="__codelineno-11-316" name="__codelineno-11-316" href="#__codelineno-11-316"></a>        <span class="c1"># Read encrypted file</span>
<a id="__codelineno-11-317" name="__codelineno-11-317" href="#__codelineno-11-317"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">encrypted_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-11-318" name="__codelineno-11-318" href="#__codelineno-11-318"></a>            <span class="n">nonce</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-11-319" name="__codelineno-11-319" href="#__codelineno-11-319"></a>            <span class="n">tag</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<a id="__codelineno-11-320" name="__codelineno-11-320" href="#__codelineno-11-320"></a>            <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a id="__codelineno-11-321" name="__codelineno-11-321" href="#__codelineno-11-321"></a>
<a id="__codelineno-11-322" name="__codelineno-11-322" href="#__codelineno-11-322"></a>        <span class="c1"># Decrypt</span>
<a id="__codelineno-11-323" name="__codelineno-11-323" href="#__codelineno-11-323"></a>        <span class="n">aes</span> <span class="o">=</span> <span class="n">AESCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<a id="__codelineno-11-324" name="__codelineno-11-324" href="#__codelineno-11-324"></a>        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">aes</span><span class="o">.</span><span class="n">decrypt_gcm</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
<a id="__codelineno-11-325" name="__codelineno-11-325" href="#__codelineno-11-325"></a>
<a id="__codelineno-11-326" name="__codelineno-11-326" href="#__codelineno-11-326"></a>        <span class="c1"># Save decrypted file</span>
<a id="__codelineno-11-327" name="__codelineno-11-327" href="#__codelineno-11-327"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-11-328" name="__codelineno-11-328" href="#__codelineno-11-328"></a>            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-11-329" name="__codelineno-11-329" href="#__codelineno-11-329"></a>
<a id="__codelineno-11-330" name="__codelineno-11-330" href="#__codelineno-11-330"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Decrypted: </span><span class="si">{</span><span class="n">output_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-331" name="__codelineno-11-331" href="#__codelineno-11-331"></a>
<a id="__codelineno-11-332" name="__codelineno-11-332" href="#__codelineno-11-332"></a>    <span class="c1"># Create test file</span>
<a id="__codelineno-11-333" name="__codelineno-11-333" href="#__codelineno-11-333"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/test.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-11-334" name="__codelineno-11-334" href="#__codelineno-11-334"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Secret file content!&quot;</span><span class="p">)</span>
<a id="__codelineno-11-335" name="__codelineno-11-335" href="#__codelineno-11-335"></a>
<a id="__codelineno-11-336" name="__codelineno-11-336" href="#__codelineno-11-336"></a>    <span class="c1"># Encrypt and decrypt</span>
<a id="__codelineno-11-337" name="__codelineno-11-337" href="#__codelineno-11-337"></a>    <span class="n">file_key</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<a id="__codelineno-11-338" name="__codelineno-11-338" href="#__codelineno-11-338"></a>    <span class="n">enc_file</span> <span class="o">=</span> <span class="n">encrypt_file</span><span class="p">(</span><span class="s1">&#39;/tmp/test.txt&#39;</span><span class="p">,</span> <span class="n">file_key</span><span class="p">)</span>
<a id="__codelineno-11-339" name="__codelineno-11-339" href="#__codelineno-11-339"></a>    <span class="n">decrypt_file</span><span class="p">(</span><span class="n">enc_file</span><span class="p">,</span> <span class="n">file_key</span><span class="p">,</span> <span class="s1">&#39;/tmp/test_decrypted.txt&#39;</span><span class="p">)</span>
<a id="__codelineno-11-340" name="__codelineno-11-340" href="#__codelineno-11-340"></a>
<a id="__codelineno-11-341" name="__codelineno-11-341" href="#__codelineno-11-341"></a>    <span class="c1"># Verify</span>
<a id="__codelineno-11-342" name="__codelineno-11-342" href="#__codelineno-11-342"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/test.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f1</span><span class="p">:</span>
<a id="__codelineno-11-343" name="__codelineno-11-343" href="#__codelineno-11-343"></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/test_decrypted.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f2</span><span class="p">:</span>
<a id="__codelineno-11-344" name="__codelineno-11-344" href="#__codelineno-11-344"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Files match: </span><span class="si">{</span><span class="n">f1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">f2</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-11-345" name="__codelineno-11-345" href="#__codelineno-11-345"></a>
<a id="__codelineno-11-346" name="__codelineno-11-346" href="#__codelineno-11-346"></a>    <span class="c1"># Cleanup</span>
<a id="__codelineno-11-347" name="__codelineno-11-347" href="#__codelineno-11-347"></a>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;/tmp/test.txt&#39;</span><span class="p">)</span>
<a id="__codelineno-11-348" name="__codelineno-11-348" href="#__codelineno-11-348"></a>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">enc_file</span><span class="p">)</span>
<a id="__codelineno-11-349" name="__codelineno-11-349" href="#__codelineno-11-349"></a>    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;/tmp/test_decrypted.txt&#39;</span><span class="p">)</span>
<a id="__codelineno-11-350" name="__codelineno-11-350" href="#__codelineno-11-350"></a>
<a id="__codelineno-11-351" name="__codelineno-11-351" href="#__codelineno-11-351"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-352" name="__codelineno-11-352" href="#__codelineno-11-352"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RECOMMENDATIONS&quot;</span><span class="p">)</span>
<a id="__codelineno-11-353" name="__codelineno-11-353" href="#__codelineno-11-353"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-11-354" name="__codelineno-11-354" href="#__codelineno-11-354"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-11-355" name="__codelineno-11-355" href="#__codelineno-11-355"></a><span class="s2">     USE:</span>
<a id="__codelineno-11-356" name="__codelineno-11-356" href="#__codelineno-11-356"></a><span class="s2">       - AES-GCM for most applications (auth + encryption)</span>
<a id="__codelineno-11-357" name="__codelineno-11-357" href="#__codelineno-11-357"></a><span class="s2">       - AES-256 for maximum security</span>
<a id="__codelineno-11-358" name="__codelineno-11-358" href="#__codelineno-11-358"></a><span class="s2">       - AES-CTR for streaming/random access</span>
<a id="__codelineno-11-359" name="__codelineno-11-359" href="#__codelineno-11-359"></a>
<a id="__codelineno-11-360" name="__codelineno-11-360" href="#__codelineno-11-360"></a><span class="s2">      CONSIDER:</span>
<a id="__codelineno-11-361" name="__codelineno-11-361" href="#__codelineno-11-361"></a><span class="s2">       - AES-CBC with HMAC for compatibility</span>
<a id="__codelineno-11-362" name="__codelineno-11-362" href="#__codelineno-11-362"></a><span class="s2">       - AES-128 for performance (still very secure)</span>
<a id="__codelineno-11-363" name="__codelineno-11-363" href="#__codelineno-11-363"></a>
<a id="__codelineno-11-364" name="__codelineno-11-364" href="#__codelineno-11-364"></a><span class="s2">     AVOID:</span>
<a id="__codelineno-11-365" name="__codelineno-11-365" href="#__codelineno-11-365"></a><span class="s2">       - AES-ECB (insecure for most use cases)</span>
<a id="__codelineno-11-366" name="__codelineno-11-366" href="#__codelineno-11-366"></a><span class="s2">       - Reusing nonces/IVs</span>
<a id="__codelineno-11-367" name="__codelineno-11-367" href="#__codelineno-11-367"></a><span class="s2">       - Encryption without authentication</span>
<a id="__codelineno-11-368" name="__codelineno-11-368" href="#__codelineno-11-368"></a><span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Output Example:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>============================================================
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>AES ENCRYPTION DEMONSTRATION
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>============================================================
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>Original: This is a secret message that needs encryption!
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>Length: 48 bytes
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>1. AES-256-GCM (Best for most use cases)
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>Ciphertext: 8a3f2e1d9c8b7a6f5e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e...
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>Nonce: 7f3a8e2c1b9d4f6a8c3e5b7d
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>Tag: 9f2e4d7c1a8b6e3f5d2c9a7b
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>Decrypted: This is a secret message that needs encryption!
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a> Match: True
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a> Testing tamper detection...
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a> Tampering detected: Authentication failed! Data was tampered with.
</code></pre></div></p>
<p><strong>AES in Practice:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Random</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_random_bytes</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.Padding</span><span class="w"> </span><span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1"># AES Encryption Example</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="k">def</span><span class="w"> </span><span class="nf">aes_encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="sd">    Encrypt data using AES-256-GCM</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="sd">    Returns: (ciphertext, nonce, tag)</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">)</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>    <span class="n">ciphertext</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt_and_digest</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>    <span class="k">return</span> <span class="n">ciphertext</span><span class="p">,</span> <span class="n">cipher</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span> <span class="n">tag</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">aes_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">nonce</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decrypt AES-GCM encrypted data&quot;&quot;&quot;</span>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a>    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt_and_verify</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>    <span class="k">return</span> <span class="n">plaintext</span>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="c1"># Usage</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="n">key</span> <span class="o">=</span> <span class="n">get_random_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>  <span class="c1"># 256-bit key</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="n">plaintext</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Secret message&quot;</span>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="c1"># Encrypt</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="n">ciphertext</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ciphertext: </span><span class="si">{</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>
<a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="c1"># Decrypt</span>
<a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="n">decrypted</span> <span class="o">=</span> <span class="n">aes_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">nonce</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
<a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h4 id="chacha20">ChaCha20</h4>
<p><strong>Description:</strong>
ChaCha20 is a modern stream cipher designed by Daniel J. Bernstein. It's optimized for software performance, especially on mobile devices without AES hardware acceleration.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>            ChaCha20 Algorithm Structure                      
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>INPUT:
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a> Key:       256 bits (32 bytes)        
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a> Nonce:     96 bits (12 bytes)         
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a> Counter:   32 bits (4 bytes)          
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>              
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>    
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>     Initial State   
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>       (512 bits)    
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>    
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>     Constants (128)  &quot;expand 32-byte k&quot;
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>     Key (256)        256-bit key
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>     Counter (32)     Block counter
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>     Nonce (96)       Random nonce
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>    
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>             
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>    
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>      20 Rounds      
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>      (Quarter rounds)
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>                     
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>      Each round:    
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>      - Add          
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>      - XOR          
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>      - Rotate       
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>    
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>             
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>    
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a>     Add Initial     
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>         State       
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>    
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>             
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a>OUTPUT: 512-bit Keystream Block
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a>        
<a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>XOR with plaintext  Ciphertext
<a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>
<a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>Advantages:
<a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a>
<a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a> Constant-time (resistant to timing attacks)
<a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a> Fast on mobile/ARM processors
<a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a> No AES-NI needed
<a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a> Simpler than AES
<a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a> Resistant to cache-timing attacks
</code></pre></div>
<p><strong>ChaCha20 vs AES:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>                  ChaCha20          AES-256
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>Type              Stream cipher     Block cipher
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>Speed (no AES-NI)  Very Fast     Moderate
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>Speed (AES-NI)     Fast           Very Fast
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>Mobile/ARM         Excellent    Good
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>Security           Excellent       Excellent
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>Adoption          Growing          Widespread
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>Use Case          TLS, VPN, Mobile General purpose
</code></pre></div></p>
<p><strong>Where ChaCha20 is Used:</strong>
- Google Chrome (TLS_CHACHA20_POLY1305)
- Android encryption
- WireGuard VPN
- Signal messaging
- SSH (ChaCha20-Poly1305)</p>
<h3 id="detailed-asymmetric-encryption-algorithms">Detailed Asymmetric Encryption Algorithms</h3>
<h4 id="rsa-rivest-shamir-adleman">RSA (Rivest-Shamir-Adleman)</h4>
<p><strong>Description:</strong>
RSA is the most widely used asymmetric encryption algorithm. It's based on the mathematical difficulty of factoring large prime numbers.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>                 RSA Algorithm                                
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>KEY GENERATION:
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>Step 1: Choose two large prime numbers
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>        p = 61, q = 53 (toy example, real: 1024+ bits each)
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>Step 2: Compute n = p  q
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>        n = 61  53 = 3233
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>Step 3: Compute (n) = (p-1)  (q-1)
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>        (n) = 60  52 = 3120
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>Step 4: Choose e (public exponent)
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>        e = 17 (common values: 3, 17, 65537)
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>        Must be: 1 &lt; e &lt; (n) and gcd(e, (n)) = 1
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>Step 5: Calculate d (private exponent)
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>        d  e  1 (mod (n))
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>        d = 2753
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>KEYS:
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>Public Key:  (e, n) = (17, 3233)
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>Private Key: (d, n) = (2753, 3233)
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>ENCRYPTION:
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>Plaintext:  m = 123
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>Ciphertext: c = m^e mod n
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>            c = 123^17 mod 3233 = 855
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a> Plaintext
<a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>   m      
<a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a>
<a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>     
<a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a>      Raise to power e
<a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a>      Modulo n
<a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>     
<a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a>
<a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a>Ciphertext
<a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a>   c      
<a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a>
<a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a>
<a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a>DECRYPTION:
<a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a>
<a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a>Ciphertext: c = 855
<a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a>Plaintext:  m = c^d mod n
<a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>            m = 855^2753 mod 3233 = 123
<a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>
<a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a>
<a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>Ciphertext
<a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>   c      
<a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a>
<a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a>     
<a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a>      Raise to power d
<a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a>      Modulo n
<a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a>     
<a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a>
<a id="__codelineno-16-64" name="__codelineno-16-64" href="#__codelineno-16-64"></a> Plaintext
<a id="__codelineno-16-65" name="__codelineno-16-65" href="#__codelineno-16-65"></a>   m      
<a id="__codelineno-16-66" name="__codelineno-16-66" href="#__codelineno-16-66"></a>
<a id="__codelineno-16-67" name="__codelineno-16-67" href="#__codelineno-16-67"></a>
<a id="__codelineno-16-68" name="__codelineno-16-68" href="#__codelineno-16-68"></a>SECURITY BASIS:
<a id="__codelineno-16-69" name="__codelineno-16-69" href="#__codelineno-16-69"></a>
<a id="__codelineno-16-70" name="__codelineno-16-70" href="#__codelineno-16-70"></a>Easy:    n = p  q (multiply primes)
<a id="__codelineno-16-71" name="__codelineno-16-71" href="#__codelineno-16-71"></a>Hard:    Given n, find p and q (factorization)
<a id="__codelineno-16-72" name="__codelineno-16-72" href="#__codelineno-16-72"></a>
<a id="__codelineno-16-73" name="__codelineno-16-73" href="#__codelineno-16-73"></a>Example:
<a id="__codelineno-16-74" name="__codelineno-16-74" href="#__codelineno-16-74"></a>n = 3233 = ?  ?
<a id="__codelineno-16-75" name="__codelineno-16-75" href="#__codelineno-16-75"></a>Small numbers: Easy to find 61  53
<a id="__codelineno-16-76" name="__codelineno-16-76" href="#__codelineno-16-76"></a>Large numbers (2048-bit): Computationally infeasible
</code></pre></div>
<p><strong>RSA Key Sizes:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a> Key Size  Security  Status       Use         
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a> 512-bit   None       Broken     Don&#39;t use   
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a> 1024-bit  Weak       Deprecated Legacy only 
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a> 2048-bit  Good       Standard   Common use  
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a> 3072-bit  Better     Secure     High sec    
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a> 4096-bit  Strong     Very Sec   Max security
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>Current Recommendation: Minimum 2048-bit
</code></pre></div></p>
<p><strong>Advantages:</strong>
-  <strong>Well-Established</strong>: Used since 1977, extremely well-studied
-  <strong>Versatile</strong>: Both encryption and digital signatures
-  <strong>Widely Supported</strong>: Every platform and library
-  <strong>Proven Security</strong>: Based on well-understood math problem
-  <strong>Simple Concept</strong>: Easy to understand</p>
<p><strong>Disadvantages:</strong>
-  <strong>Slow</strong>: Much slower than symmetric encryption
-  <strong>Large Keys</strong>: Requires 2048-4096 bit keys
-  <strong>Large Ciphertext</strong>: Output larger than input
-  <strong>Quantum Vulnerable</strong>: Shor's algorithm can break it
-  <strong>Padding Required</strong>: Needs OAEP or PSS padding</p>
<p><strong>RSA Performance:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Operation Times (2048-bit key):
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>Key Generation:    100-500 ms
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>Encryption:        0.5-2 ms
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>Decryption:        10-50 ms (slower due to private key ops)
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>Signing:           10-50 ms
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>Verification:      0.5-2 ms (fast with small public exponent)
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>Compare to AES: 1000x-10000x slower!
</code></pre></div></p>
<p><strong>RSA in Practice:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.PublicKey</span><span class="w"> </span><span class="kn">import</span> <span class="n">RSA</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">PKCS1_OAEP</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Signature</span><span class="w"> </span><span class="kn">import</span> <span class="n">pkcs1_15</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Hash</span><span class="w"> </span><span class="kn">import</span> <span class="n">SHA256</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="c1"># Generate RSA key pair</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="n">key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">private_key</span> <span class="o">=</span> <span class="n">key</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="n">public_key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">publickey</span><span class="p">()</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="c1"># Encryption (using OAEP padding)</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">rsa_encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">public_key</span><span class="p">):</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>    <span class="n">ciphertext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>    <span class="k">return</span> <span class="n">ciphertext</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="c1"># Decryption</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="k">def</span><span class="w"> </span><span class="nf">rsa_decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">private_key</span><span class="p">):</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="n">PKCS1_OAEP</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">private_key</span><span class="p">)</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a>    <span class="n">plaintext</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a>    <span class="k">return</span> <span class="n">plaintext</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a>
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="c1"># Usage</span>
<a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello RSA!&quot;</span>
<a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="n">encrypted</span> <span class="o">=</span> <span class="n">rsa_encrypt</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="n">decrypted</span> <span class="o">=</span> <span class="n">rsa_decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span>
<a id="__codelineno-19-27" name="__codelineno-19-27" href="#__codelineno-19-27"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decrypted: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h4 id="diffie-hellman-key-exchange">Diffie-Hellman Key Exchange</h4>
<p><strong>Description:</strong>
Diffie-Hellman is not an encryption algorithm, but a <strong>key exchange protocol</strong>. It allows two parties to establish a shared secret over an insecure channel without ever transmitting the secret itself.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>         Diffie-Hellman Key Exchange Protocol                 
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>PUBLIC PARAMETERS (Known to everyone):
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>p = Large prime number (e.g., 23)
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>g = Generator (primitive root of p, e.g., 5)
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>ALICE                                           BOB
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>                                           
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>Step 1: Generate private key
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>a = 6 (secret)                                  b = 15 (secret)
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>                                                    
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>                                                    
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>Step 2: Compute public key
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>A = g^a mod p                                   B = g^b mod p
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>A = 5^6 mod 23                                  B = 5^15 mod 23
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>A = 8                                           B = 19
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>                                                    
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>                                                    
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>Step 3: Exchange public keys
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>             Send A = 8                             
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>     
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>                                                    
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>             Send B = 19                            
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a>     
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a>                                                    
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>         Attacker can see A and B!                
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a>        But cannot derive a or b                    
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a>                                                    
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a>Step 4: Compute shared secret
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a>s = B^a mod p                                   s = A^b mod p
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a>s = 19^6 mod 23                                 s = 8^15 mod 23
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a>s = 2                                           s = 2
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a>                                                    
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a>                                                    
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a>Both parties now have shared secret = 2!
<a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a>
<a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a>MATHEMATICAL PROOF:
<a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a>
<a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a>Alice: s = B^a mod p = (g^b)^a mod p = g^(ab) mod p
<a id="__codelineno-20-48" name="__codelineno-20-48" href="#__codelineno-20-48"></a>Bob:   s = A^b mod p = (g^a)^b mod p = g^(ab) mod p
<a id="__codelineno-20-49" name="__codelineno-20-49" href="#__codelineno-20-49"></a>
<a id="__codelineno-20-50" name="__codelineno-20-50" href="#__codelineno-20-50"></a>Both compute the same value!
<a id="__codelineno-20-51" name="__codelineno-20-51" href="#__codelineno-20-51"></a>
<a id="__codelineno-20-52" name="__codelineno-20-52" href="#__codelineno-20-52"></a>SECURITY:
<a id="__codelineno-20-53" name="__codelineno-20-53" href="#__codelineno-20-53"></a>
<a id="__codelineno-20-54" name="__codelineno-20-54" href="#__codelineno-20-54"></a>Attacker knows: p, g, A, B
<a id="__codelineno-20-55" name="__codelineno-20-55" href="#__codelineno-20-55"></a>Attacker needs: a or b
<a id="__codelineno-20-56" name="__codelineno-20-56" href="#__codelineno-20-56"></a>Problem: Discrete Logarithm Problem (DLP)
<a id="__codelineno-20-57" name="__codelineno-20-57" href="#__codelineno-20-57"></a>         Given g^a mod p, find a  Computationally hard!
<a id="__codelineno-20-58" name="__codelineno-20-58" href="#__codelineno-20-58"></a>
<a id="__codelineno-20-59" name="__codelineno-20-59" href="#__codelineno-20-59"></a>VISUAL REPRESENTATION (Paint Mixing Analogy):
<a id="__codelineno-20-60" name="__codelineno-20-60" href="#__codelineno-20-60"></a>
<a id="__codelineno-20-61" name="__codelineno-20-61" href="#__codelineno-20-61"></a>
<a id="__codelineno-20-62" name="__codelineno-20-62" href="#__codelineno-20-62"></a>
<a id="__codelineno-20-63" name="__codelineno-20-63" href="#__codelineno-20-63"></a>                                                 
<a id="__codelineno-20-64" name="__codelineno-20-64" href="#__codelineno-20-64"></a>  Public Color: Yellow                           
<a id="__codelineno-20-65" name="__codelineno-20-65" href="#__codelineno-20-65"></a>  (Known to everyone)                            
<a id="__codelineno-20-66" name="__codelineno-20-66" href="#__codelineno-20-66"></a>                                                 
<a id="__codelineno-20-67" name="__codelineno-20-67" href="#__codelineno-20-67"></a>
<a id="__codelineno-20-68" name="__codelineno-20-68" href="#__codelineno-20-68"></a>                    
<a id="__codelineno-20-69" name="__codelineno-20-69" href="#__codelineno-20-69"></a>        
<a id="__codelineno-20-70" name="__codelineno-20-70" href="#__codelineno-20-70"></a>                               
<a id="__codelineno-20-71" name="__codelineno-20-71" href="#__codelineno-20-71"></a>               
<a id="__codelineno-20-72" name="__codelineno-20-72" href="#__codelineno-20-72"></a>     Alice                 Bob   
<a id="__codelineno-20-73" name="__codelineno-20-73" href="#__codelineno-20-73"></a>                                 
<a id="__codelineno-20-74" name="__codelineno-20-74" href="#__codelineno-20-74"></a>     Secret:             Secret: 
<a id="__codelineno-20-75" name="__codelineno-20-75" href="#__codelineno-20-75"></a>      Blue                 Red   
<a id="__codelineno-20-76" name="__codelineno-20-76" href="#__codelineno-20-76"></a>               
<a id="__codelineno-20-77" name="__codelineno-20-77" href="#__codelineno-20-77"></a>                              
<a id="__codelineno-20-78" name="__codelineno-20-78" href="#__codelineno-20-78"></a>      Mix with                Mix with
<a id="__codelineno-20-79" name="__codelineno-20-79" href="#__codelineno-20-79"></a>      Yellow                  Yellow
<a id="__codelineno-20-80" name="__codelineno-20-80" href="#__codelineno-20-80"></a>                              
<a id="__codelineno-20-81" name="__codelineno-20-81" href="#__codelineno-20-81"></a>               
<a id="__codelineno-20-82" name="__codelineno-20-82" href="#__codelineno-20-82"></a>     Green               Orange  
<a id="__codelineno-20-83" name="__codelineno-20-83" href="#__codelineno-20-83"></a>    (Public) (Public) 
<a id="__codelineno-20-84" name="__codelineno-20-84" href="#__codelineno-20-84"></a>      Exchange 
<a id="__codelineno-20-85" name="__codelineno-20-85" href="#__codelineno-20-85"></a>                              
<a id="__codelineno-20-86" name="__codelineno-20-86" href="#__codelineno-20-86"></a>    Add Bob&#39;s                Add Alice&#39;s
<a id="__codelineno-20-87" name="__codelineno-20-87" href="#__codelineno-20-87"></a>    Orange                    Green
<a id="__codelineno-20-88" name="__codelineno-20-88" href="#__codelineno-20-88"></a>                              
<a id="__codelineno-20-89" name="__codelineno-20-89" href="#__codelineno-20-89"></a>               
<a id="__codelineno-20-90" name="__codelineno-20-90" href="#__codelineno-20-90"></a>      Brown               Brown  
<a id="__codelineno-20-91" name="__codelineno-20-91" href="#__codelineno-20-91"></a>     (Secret)            (Secret)
<a id="__codelineno-20-92" name="__codelineno-20-92" href="#__codelineno-20-92"></a>               
<a id="__codelineno-20-93" name="__codelineno-20-93" href="#__codelineno-20-93"></a>
<a id="__codelineno-20-94" name="__codelineno-20-94" href="#__codelineno-20-94"></a>    Same color (shared secret)!
<a id="__codelineno-20-95" name="__codelineno-20-95" href="#__codelineno-20-95"></a>
<a id="__codelineno-20-96" name="__codelineno-20-96" href="#__codelineno-20-96"></a>    Attacker sees: Yellow, Green, Orange
<a id="__codelineno-20-97" name="__codelineno-20-97" href="#__codelineno-20-97"></a>    Cannot extract: Blue or Red
<a id="__codelineno-20-98" name="__codelineno-20-98" href="#__codelineno-20-98"></a>    Cannot create: Brown
</code></pre></div>
<p><strong>Diffie-Hellman Variants:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>1. TRADITIONAL DH (Finite Fields)
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>   - Uses modular exponentiation
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>   - Key size: 2048-4096 bits
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>   - Slower computation
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>2. ECDH (Elliptic Curve Diffie-Hellman)
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>   - Uses elliptic curve points
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>   - Key size: 256-521 bits
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>   - Faster, smaller keys
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>   - Used in modern TLS
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>3. X25519 (Curve25519)
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>   - Modern ECDH variant
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>   - 255-bit keys
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>   - Very fast
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>   - Used in: Signal, WireGuard, TLS 1.3
</code></pre></div></p>
<p><strong>Advantages:</strong>
-  <strong>No Pre-shared Secret</strong>: Parties don't need prior communication
-  <strong>Perfect Forward Secrecy</strong>: Each session has unique key
-  <strong>Efficient</strong>: Fast key establishment
-  <strong>Widely Used</strong>: Core of TLS/SSL</p>
<p><strong>Disadvantages:</strong>
-  <strong>Vulnerable to MITM</strong>: Without authentication
-  <strong>Not an Encryption Algorithm</strong>: Only for key exchange
-  <strong>Requires Authentication</strong>: Must be combined with signatures</p>
<p><strong>Diffie-Hellman in TLS:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>Client                                  Server
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>                                         
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>   1. ClientHello                        
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>  
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>                                         
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>                                          Generate DH private: b
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>                                          Compute DH public: B
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>                                         
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>   2. ServerHello                        
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>      Server DH Public Key: B            
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>      Signature (proves server identity) 
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>  
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>                                         
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>   Generate DH private: a                
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a>   Compute DH public: A                  
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>   Compute shared secret: s = B^a        
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>                                         
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>   3. Client DH Public Key: A            
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>  
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>                                          Compute shared secret: s = A^b
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>                                         
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>Both parties now have shared secret!
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>Use it to derive session keys for AES encryption
</code></pre></div></p>
<p><strong>Diffie-Hellman in Practice:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">dh</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.kdf.hkdf</span><span class="w"> </span><span class="kn">import</span> <span class="n">HKDF</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="c1"># Generate DH parameters (done once, can be reused)</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="n">parameters</span> <span class="o">=</span> <span class="n">dh</span><span class="o">.</span><span class="n">generate_parameters</span><span class="p">(</span><span class="n">generator</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="c1"># Alice generates her key pair</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="n">alice_private_key</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="n">alice_public_key</span> <span class="o">=</span> <span class="n">alice_private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="c1"># Bob generates his key pair</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="n">bob_private_key</span> <span class="o">=</span> <span class="n">parameters</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="n">bob_public_key</span> <span class="o">=</span> <span class="n">bob_private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
<a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="c1"># Alice computes shared secret using Bob&#39;s public key</span>
<a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="n">alice_shared_secret</span> <span class="o">=</span> <span class="n">alice_private_key</span><span class="o">.</span><span class="n">exchange</span><span class="p">(</span><span class="n">bob_public_key</span><span class="p">)</span>
<a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>
<a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="c1"># Bob computes shared secret using Alice&#39;s public key</span>
<a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="n">bob_shared_secret</span> <span class="o">=</span> <span class="n">bob_private_key</span><span class="o">.</span><span class="n">exchange</span><span class="p">(</span><span class="n">alice_public_key</span><span class="p">)</span>
<a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>
<a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a><span class="c1"># Both secrets are identical!</span>
<a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="k">assert</span> <span class="n">alice_shared_secret</span> <span class="o">==</span> <span class="n">bob_shared_secret</span>
<a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>
<a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="c1"># Derive encryption key from shared secret</span>
<a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="k">def</span><span class="w"> </span><span class="nf">derive_key</span><span class="p">(</span><span class="n">shared_secret</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>    <span class="k">return</span> <span class="n">HKDF</span><span class="p">(</span>
<a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>        <span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span>
<a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>        <span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
<a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>        <span class="n">salt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>        <span class="n">info</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;session key&#39;</span>
<a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>    <span class="p">)</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">shared_secret</span><span class="p">)</span>
<a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>
<a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="n">session_key</span> <span class="o">=</span> <span class="n">derive_key</span><span class="p">(</span><span class="n">alice_shared_secret</span><span class="p">)</span>
<a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Session Key: </span><span class="si">{</span><span class="n">session_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="digital-signatures">Digital Signatures</h3>
<p><strong>What is a Digital Signature?</strong></p>
<p>A digital signature is a cryptographic mechanism that provides:
1. <strong>Authentication</strong>: Proves who created the message
2. <strong>Integrity</strong>: Ensures message wasn't altered
3. <strong>Non-repudiation</strong>: Signer cannot deny signing</p>
<p>It's the digital equivalent of a handwritten signature, but much more secure.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>              Digital Signature Process                       
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>SIGNING (Creating Signature):
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>   Document   
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>  &quot;Contract&quot;  
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>       
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>        Step 1: Hash the document
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>       
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>   Hash         SHA-256
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a> Function       One-way function
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>  Creates fixed-size digest
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>       
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a>        Document Hash
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>        (e.g., 256 bits)
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>       
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>    Hash      
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>   Digest     
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a> a7f3b2c1...  
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>       
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>        Step 2: Encrypt hash with private key
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a>       
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>         
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>          Private Key   
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>            (Keep Secret)  
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>          
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>                   
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a>                   
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>          
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>             Signature      This IS the digital signature!
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>            8k2mN9pR...     Encrypted hash
<a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>          
<a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a>
<a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a>VERIFICATION (Checking Signature):
<a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a>
<a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a>
<a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a>Receiver gets:
<a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a>1. Original document
<a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a>2. Digital signature
<a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a>
<a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a>
<a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a>   Document   
<a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a>  &quot;Contract&quot;  
<a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a>
<a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a>       
<a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a>        Step 1: Hash the received document
<a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a>       
<a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a>
<a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a>   Hash       
<a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a> Function     
<a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a>
<a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a>       
<a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a>        Computed Hash
<a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a>       
<a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a>
<a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a>    Hash      
<a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a>   Digest     
<a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a> a7f3b2c1...   
<a id="__codelineno-24-67" name="__codelineno-24-67" href="#__codelineno-24-67"></a>              
<a id="__codelineno-24-68" name="__codelineno-24-68" href="#__codelineno-24-68"></a>                              
<a id="__codelineno-24-69" name="__codelineno-24-69" href="#__codelineno-24-69"></a>                               Step 3: Compare
<a id="__codelineno-24-70" name="__codelineno-24-70" href="#__codelineno-24-70"></a>              
<a id="__codelineno-24-71" name="__codelineno-24-71" href="#__codelineno-24-71"></a>  Signature                 
<a id="__codelineno-24-72" name="__codelineno-24-72" href="#__codelineno-24-72"></a> 8k2mN9pR...                
<a id="__codelineno-24-73" name="__codelineno-24-73" href="#__codelineno-24-73"></a>              
<a id="__codelineno-24-74" name="__codelineno-24-74" href="#__codelineno-24-74"></a>                             
<a id="__codelineno-24-75" name="__codelineno-24-75" href="#__codelineno-24-75"></a>        Step 2: Decrypt      
<a id="__codelineno-24-76" name="__codelineno-24-76" href="#__codelineno-24-76"></a>        signature with       
<a id="__codelineno-24-77" name="__codelineno-24-77" href="#__codelineno-24-77"></a>        public key           
<a id="__codelineno-24-78" name="__codelineno-24-78" href="#__codelineno-24-78"></a>                             
<a id="__codelineno-24-79" name="__codelineno-24-79" href="#__codelineno-24-79"></a>          
<a id="__codelineno-24-80" name="__codelineno-24-80" href="#__codelineno-24-80"></a>          Public Key     
<a id="__codelineno-24-81" name="__codelineno-24-81" href="#__codelineno-24-81"></a>           (Publicly Known) 
<a id="__codelineno-24-82" name="__codelineno-24-82" href="#__codelineno-24-82"></a>           
<a id="__codelineno-24-83" name="__codelineno-24-83" href="#__codelineno-24-83"></a>                             
<a id="__codelineno-24-84" name="__codelineno-24-84" href="#__codelineno-24-84"></a>                             
<a id="__codelineno-24-85" name="__codelineno-24-85" href="#__codelineno-24-85"></a>           
<a id="__codelineno-24-86" name="__codelineno-24-86" href="#__codelineno-24-86"></a>            Decrypted      
<a id="__codelineno-24-87" name="__codelineno-24-87" href="#__codelineno-24-87"></a>              Hash         
<a id="__codelineno-24-88" name="__codelineno-24-88" href="#__codelineno-24-88"></a>           a7f3b2c1...    
<a id="__codelineno-24-89" name="__codelineno-24-89" href="#__codelineno-24-89"></a>          
<a id="__codelineno-24-90" name="__codelineno-24-90" href="#__codelineno-24-90"></a>                   
<a id="__codelineno-24-91" name="__codelineno-24-91" href="#__codelineno-24-91"></a>                   
<a id="__codelineno-24-92" name="__codelineno-24-92" href="#__codelineno-24-92"></a>          
<a id="__codelineno-24-93" name="__codelineno-24-93" href="#__codelineno-24-93"></a>           If hashes match:   
<a id="__codelineno-24-94" name="__codelineno-24-94" href="#__codelineno-24-94"></a>            Signature valid! 
<a id="__codelineno-24-95" name="__codelineno-24-95" href="#__codelineno-24-95"></a>            Document intact! 
<a id="__codelineno-24-96" name="__codelineno-24-96" href="#__codelineno-24-96"></a>            Authentic!       
<a id="__codelineno-24-97" name="__codelineno-24-97" href="#__codelineno-24-97"></a>                              
<a id="__codelineno-24-98" name="__codelineno-24-98" href="#__codelineno-24-98"></a>           If hashes differ:  
<a id="__codelineno-24-99" name="__codelineno-24-99" href="#__codelineno-24-99"></a>            Tampered!        
<a id="__codelineno-24-100" name="__codelineno-24-100" href="#__codelineno-24-100"></a>            Invalid!         
<a id="__codelineno-24-101" name="__codelineno-24-101" href="#__codelineno-24-101"></a>          
<a id="__codelineno-24-102" name="__codelineno-24-102" href="#__codelineno-24-102"></a>
<a id="__codelineno-24-103" name="__codelineno-24-103" href="#__codelineno-24-103"></a>COMPLETE FLOW:
<a id="__codelineno-24-104" name="__codelineno-24-104" href="#__codelineno-24-104"></a>
<a id="__codelineno-24-105" name="__codelineno-24-105" href="#__codelineno-24-105"></a>
<a id="__codelineno-24-106" name="__codelineno-24-106" href="#__codelineno-24-106"></a>ALICE (Sender)                           BOB (Receiver)
<a id="__codelineno-24-107" name="__codelineno-24-107" href="#__codelineno-24-107"></a>                           
<a id="__codelineno-24-108" name="__codelineno-24-108" href="#__codelineno-24-108"></a>
<a id="__codelineno-24-109" name="__codelineno-24-109" href="#__codelineno-24-109"></a>                         
<a id="__codelineno-24-110" name="__codelineno-24-110" href="#__codelineno-24-110"></a>  Document                               Document    
<a id="__codelineno-24-111" name="__codelineno-24-111" href="#__codelineno-24-111"></a>                         
<a id="__codelineno-24-112" name="__codelineno-24-112" href="#__codelineno-24-112"></a>                                               
<a id="__codelineno-24-113" name="__codelineno-24-113" href="#__codelineno-24-113"></a>   Hash with                                Hash with
<a id="__codelineno-24-114" name="__codelineno-24-114" href="#__codelineno-24-114"></a>   SHA-256                                  SHA-256
<a id="__codelineno-24-115" name="__codelineno-24-115" href="#__codelineno-24-115"></a>                                               
<a id="__codelineno-24-116" name="__codelineno-24-116" href="#__codelineno-24-116"></a>                                               
<a id="__codelineno-24-117" name="__codelineno-24-117" href="#__codelineno-24-117"></a>                         
<a id="__codelineno-24-118" name="__codelineno-24-118" href="#__codelineno-24-118"></a> Hash Digest                            Hash Digest  
<a id="__codelineno-24-119" name="__codelineno-24-119" href="#__codelineno-24-119"></a> a7f3b2c1...                            a7f3b2c1...  
<a id="__codelineno-24-120" name="__codelineno-24-120" href="#__codelineno-24-120"></a>                         
<a id="__codelineno-24-121" name="__codelineno-24-121" href="#__codelineno-24-121"></a>                                               
<a id="__codelineno-24-122" name="__codelineno-24-122" href="#__codelineno-24-122"></a>  Encrypt with                            Decrypt with
<a id="__codelineno-24-123" name="__codelineno-24-123" href="#__codelineno-24-123"></a> Alice&#39;s Private                          Alice&#39;s Public
<a id="__codelineno-24-124" name="__codelineno-24-124" href="#__codelineno-24-124"></a>      Key                                      Key
<a id="__codelineno-24-125" name="__codelineno-24-125" href="#__codelineno-24-125"></a>                                               
<a id="__codelineno-24-126" name="__codelineno-24-126" href="#__codelineno-24-126"></a>                                               
<a id="__codelineno-24-127" name="__codelineno-24-127" href="#__codelineno-24-127"></a>                         
<a id="__codelineno-24-128" name="__codelineno-24-128" href="#__codelineno-24-128"></a>  Signature                             Decrypted    
<a id="__codelineno-24-129" name="__codelineno-24-129" href="#__codelineno-24-129"></a> 8k2mN9pR...                               Hash      
<a id="__codelineno-24-130" name="__codelineno-24-130" href="#__codelineno-24-130"></a>                         
<a id="__codelineno-24-131" name="__codelineno-24-131" href="#__codelineno-24-131"></a>                                               
<a id="__codelineno-24-132" name="__codelineno-24-132" href="#__codelineno-24-132"></a>        Send both:                             
<a id="__codelineno-24-133" name="__codelineno-24-133" href="#__codelineno-24-133"></a>        - Document                             
<a id="__codelineno-24-134" name="__codelineno-24-134" href="#__codelineno-24-134"></a>        - Signature                            
<a id="__codelineno-24-135" name="__codelineno-24-135" href="#__codelineno-24-135"></a>       
<a id="__codelineno-24-136" name="__codelineno-24-136" href="#__codelineno-24-136"></a>                                                
<a id="__codelineno-24-137" name="__codelineno-24-137" href="#__codelineno-24-137"></a>                                          Compare hashes
<a id="__codelineno-24-138" name="__codelineno-24-138" href="#__codelineno-24-138"></a>                                                
<a id="__codelineno-24-139" name="__codelineno-24-139" href="#__codelineno-24-139"></a>                                                
<a id="__codelineno-24-140" name="__codelineno-24-140" href="#__codelineno-24-140"></a>                                          Valid if match
</code></pre></div>
<h4 id="digital-signature-algorithms">Digital Signature Algorithms</h4>
<p><strong>1. RSA Signatures:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>SIGNING:
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>1. Hash message: h = SHA-256(message)
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>2. Sign hash: signature = h^d mod n (private key d)
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>VERIFICATION:
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>1. Hash received message: h1 = SHA-256(message)
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>2. Decrypt signature: h2 = signature^e mod n (public key e)
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>3. Compare: h1 == h2 ?
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>Common Padding: PKCS#1 v1.5, PSS (Probabilistic Signature Scheme)
</code></pre></div></p>
<p><strong>2. ECDSA (Elliptic Curve Digital Signature Algorithm):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>SIGNING:
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>1. Hash message: h = SHA-256(message)
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>2. Generate random k
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>3. Compute r = (k  G)_x mod n
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>4. Compute s = k^(-1)  (h + r  private_key) mod n
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>5. Signature = (r, s)
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>VERIFICATION:
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>1. Hash message: h = SHA-256(message)
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>2. Compute u1 = h  s^(-1) mod n
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>3. Compute u2 = r  s^(-1) mod n
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>4. Compute point P = u1  G + u2  PublicKey
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>5. Valid if P_x == r
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>Advantages:
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a> Smaller signatures than RSA
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a> Faster than RSA
<a id="__codelineno-26-20" name="__codelineno-26-20" href="#__codelineno-26-20"></a> Same security with smaller keys
</code></pre></div></p>
<p><strong>3. EdDSA (Ed25519):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>Modern signature algorithm:
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a> Deterministic (no random k needed)
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a> Resistant to side-channel attacks
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a> Very fast
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a> 255-bit keys
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a> Used in: SSH, Signal, cryptocurrency
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>Signature: 512 bits (64 bytes)
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>Public Key: 256 bits (32 bytes)
</code></pre></div></p>
<h4 id="digital-signature-use-cases">Digital Signature Use Cases</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a> COMMON APPLICATIONS:
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>1. SOFTWARE SIGNING
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>   
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>      software.exe   
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a>           +           Developer signs
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>      Signature        Users verify authenticity
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>   
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>   Examples: Windows code signing, Apple developer certificates
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>2. EMAIL SECURITY (S/MIME, PGP)
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>   
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>        Email        
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>     From: Alice       Sign email
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>     To: Bob           Prove sender
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>     + Signature       Detect tampering
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>   
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>3. DOCUMENT SIGNING (PDF, DocuSign)
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>   
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>      Contract.pdf   
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a>    [Signature]        Legally binding
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>    Signed by: Alice   Non-repudiation
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>    Date: 2025-12-30   Tamper-evident
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a>   
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a>4. SSL/TLS CERTIFICATES
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>   Server proves identity with digital signature
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a>   on its certificate
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>5. BLOCKCHAIN/CRYPTOCURRENCY
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>   
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a>     Transaction     
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>     From: Wallet A    Prove ownership
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a>     To: Wallet B      Authorize transfer
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>     Amount: 1 BTC     Prevent tampering
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a>     + Signature     
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a>   
<a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a>
<a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a>6. CODE REPOSITORIES (Git commits)
<a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a>   Git commit signed with GPG key
<a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>   Proves commit author identity
<a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a>
<a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a>7. API AUTHENTICATION
<a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a>   Sign API requests to prove identity
<a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a>   Prevent request tampering
</code></pre></div>
<h4 id="advantages-of-digital-signatures">Advantages of Digital Signatures</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a> SECURITY BENEFITS:
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>1. AUTHENTICATION
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>   Proves who created/sent the message
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>   Cannot be forged without private key
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>2. INTEGRITY
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>   Any modification invalidates signature
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>   Even one bit changed = signature fails
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>3. NON-REPUDIATION
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>   Signer cannot deny signing
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>   Legal proof of agreement
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>   Binding like handwritten signature
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>4. EFFICIENCY
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>   Faster than encrypting entire document
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>   Only sign hash (fixed size)
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>5. VERIFIABLE
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>   Anyone with public key can verify
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>   No secrets need to be shared
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>6. SCALABLE
<a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>   One key pair for unlimited signatures
<a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>   Public key can be widely distributed
<a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>
<a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a>7. TIMESTAMPING
<a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a>   Can include timestamp in signature
<a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a>   Proves when document was signed
</code></pre></div>
<h4 id="digital-signature-implementation">Digital Signature Implementation</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span><span class="p">,</span> <span class="n">padding</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">ec</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="n">InvalidSignature</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="c1"># RSA Digital Signature</span>
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a><span class="k">class</span><span class="w"> </span><span class="nc">RSASignature</span><span class="p">:</span>
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>        <span class="c1"># Generate RSA key pair</span>
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>            <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>            <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span>
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>        <span class="p">)</span>
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sign a message with private key&quot;&quot;&quot;</span>
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>        <span class="n">signature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>            <span class="n">message</span><span class="p">,</span>
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>            <span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="p">(</span>
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>                <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>                <span class="n">salt_length</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="o">.</span><span class="n">MAX_LENGTH</span>
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>            <span class="p">),</span>
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>            <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()</span>
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>        <span class="p">)</span>
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a>        <span class="k">return</span> <span class="n">signature</span>
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">signature</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify signature with public key&quot;&quot;&quot;</span>
<a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
<a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a>                <span class="n">signature</span><span class="p">,</span>
<a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a>                <span class="n">message</span><span class="p">,</span>
<a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a>                <span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="p">(</span>
<a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a>                    <span class="n">mgf</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">MGF1</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()),</span>
<a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a>                    <span class="n">salt_length</span><span class="o">=</span><span class="n">padding</span><span class="o">.</span><span class="n">PSS</span><span class="o">.</span><span class="n">MAX_LENGTH</span>
<a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a>                <span class="p">),</span>
<a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a>                <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">()</span>
<a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a>            <span class="p">)</span>
<a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>        <span class="k">except</span> <span class="n">InvalidSignature</span><span class="p">:</span>
<a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a>
<a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a><span class="c1"># ECDSA Digital Signature</span>
<a id="__codelineno-30-46" name="__codelineno-30-46" href="#__codelineno-30-46"></a><span class="k">class</span><span class="w"> </span><span class="nc">ECDSASignature</span><span class="p">:</span>
<a id="__codelineno-30-47" name="__codelineno-30-47" href="#__codelineno-30-47"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-30-48" name="__codelineno-30-48" href="#__codelineno-30-48"></a>        <span class="c1"># Generate ECDSA key pair (P-256 curve)</span>
<a id="__codelineno-30-49" name="__codelineno-30-49" href="#__codelineno-30-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">ec</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span><span class="n">ec</span><span class="o">.</span><span class="n">SECP256R1</span><span class="p">())</span>
<a id="__codelineno-30-50" name="__codelineno-30-50" href="#__codelineno-30-50"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<a id="__codelineno-30-51" name="__codelineno-30-51" href="#__codelineno-30-51"></a>
<a id="__codelineno-30-52" name="__codelineno-30-52" href="#__codelineno-30-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<a id="__codelineno-30-53" name="__codelineno-30-53" href="#__codelineno-30-53"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sign a message with ECDSA private key&quot;&quot;&quot;</span>
<a id="__codelineno-30-54" name="__codelineno-30-54" href="#__codelineno-30-54"></a>        <span class="n">signature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
<a id="__codelineno-30-55" name="__codelineno-30-55" href="#__codelineno-30-55"></a>            <span class="n">message</span><span class="p">,</span>
<a id="__codelineno-30-56" name="__codelineno-30-56" href="#__codelineno-30-56"></a>            <span class="n">ec</span><span class="o">.</span><span class="n">ECDSA</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
<a id="__codelineno-30-57" name="__codelineno-30-57" href="#__codelineno-30-57"></a>        <span class="p">)</span>
<a id="__codelineno-30-58" name="__codelineno-30-58" href="#__codelineno-30-58"></a>        <span class="k">return</span> <span class="n">signature</span>
<a id="__codelineno-30-59" name="__codelineno-30-59" href="#__codelineno-30-59"></a>
<a id="__codelineno-30-60" name="__codelineno-30-60" href="#__codelineno-30-60"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">signature</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-30-61" name="__codelineno-30-61" href="#__codelineno-30-61"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify ECDSA signature&quot;&quot;&quot;</span>
<a id="__codelineno-30-62" name="__codelineno-30-62" href="#__codelineno-30-62"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-30-63" name="__codelineno-30-63" href="#__codelineno-30-63"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span>
<a id="__codelineno-30-64" name="__codelineno-30-64" href="#__codelineno-30-64"></a>                <span class="n">signature</span><span class="p">,</span>
<a id="__codelineno-30-65" name="__codelineno-30-65" href="#__codelineno-30-65"></a>                <span class="n">message</span><span class="p">,</span>
<a id="__codelineno-30-66" name="__codelineno-30-66" href="#__codelineno-30-66"></a>                <span class="n">ec</span><span class="o">.</span><span class="n">ECDSA</span><span class="p">(</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">())</span>
<a id="__codelineno-30-67" name="__codelineno-30-67" href="#__codelineno-30-67"></a>            <span class="p">)</span>
<a id="__codelineno-30-68" name="__codelineno-30-68" href="#__codelineno-30-68"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-30-69" name="__codelineno-30-69" href="#__codelineno-30-69"></a>        <span class="k">except</span> <span class="n">InvalidSignature</span><span class="p">:</span>
<a id="__codelineno-30-70" name="__codelineno-30-70" href="#__codelineno-30-70"></a>            <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-30-71" name="__codelineno-30-71" href="#__codelineno-30-71"></a>
<a id="__codelineno-30-72" name="__codelineno-30-72" href="#__codelineno-30-72"></a><span class="c1"># Usage Example</span>
<a id="__codelineno-30-73" name="__codelineno-30-73" href="#__codelineno-30-73"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-30-74" name="__codelineno-30-74" href="#__codelineno-30-74"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-30-75" name="__codelineno-30-75" href="#__codelineno-30-75"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Digital Signature Demonstration&quot;</span><span class="p">)</span>
<a id="__codelineno-30-76" name="__codelineno-30-76" href="#__codelineno-30-76"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-30-77" name="__codelineno-30-77" href="#__codelineno-30-77"></a>
<a id="__codelineno-30-78" name="__codelineno-30-78" href="#__codelineno-30-78"></a>    <span class="c1"># Test message</span>
<a id="__codelineno-30-79" name="__codelineno-30-79" href="#__codelineno-30-79"></a>    <span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;This is a signed contract agreement.&quot;</span>
<a id="__codelineno-30-80" name="__codelineno-30-80" href="#__codelineno-30-80"></a>
<a id="__codelineno-30-81" name="__codelineno-30-81" href="#__codelineno-30-81"></a>    <span class="c1"># RSA Signature</span>
<a id="__codelineno-30-82" name="__codelineno-30-82" href="#__codelineno-30-82"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. RSA Signature:&quot;</span><span class="p">)</span>
<a id="__codelineno-30-83" name="__codelineno-30-83" href="#__codelineno-30-83"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-30-84" name="__codelineno-30-84" href="#__codelineno-30-84"></a>    <span class="n">rsa_sig</span> <span class="o">=</span> <span class="n">RSASignature</span><span class="p">()</span>
<a id="__codelineno-30-85" name="__codelineno-30-85" href="#__codelineno-30-85"></a>
<a id="__codelineno-30-86" name="__codelineno-30-86" href="#__codelineno-30-86"></a>    <span class="c1"># Sign</span>
<a id="__codelineno-30-87" name="__codelineno-30-87" href="#__codelineno-30-87"></a>    <span class="n">signature</span> <span class="o">=</span> <span class="n">rsa_sig</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-30-88" name="__codelineno-30-88" href="#__codelineno-30-88"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-89" name="__codelineno-30-89" href="#__codelineno-30-89"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<a id="__codelineno-30-90" name="__codelineno-30-90" href="#__codelineno-30-90"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature (first 40 chars): </span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-30-91" name="__codelineno-30-91" href="#__codelineno-30-91"></a>
<a id="__codelineno-30-92" name="__codelineno-30-92" href="#__codelineno-30-92"></a>    <span class="c1"># Verify valid signature</span>
<a id="__codelineno-30-93" name="__codelineno-30-93" href="#__codelineno-30-93"></a>    <span class="n">is_valid</span> <span class="o">=</span> <span class="n">rsa_sig</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
<a id="__codelineno-30-94" name="__codelineno-30-94" href="#__codelineno-30-94"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Signature valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-95" name="__codelineno-30-95" href="#__codelineno-30-95"></a>
<a id="__codelineno-30-96" name="__codelineno-30-96" href="#__codelineno-30-96"></a>    <span class="c1"># Verify tampered message</span>
<a id="__codelineno-30-97" name="__codelineno-30-97" href="#__codelineno-30-97"></a>    <span class="n">tampered</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;This is a MODIFIED contract agreement.&quot;</span>
<a id="__codelineno-30-98" name="__codelineno-30-98" href="#__codelineno-30-98"></a>    <span class="n">is_valid_tampered</span> <span class="o">=</span> <span class="n">rsa_sig</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">tampered</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
<a id="__codelineno-30-99" name="__codelineno-30-99" href="#__codelineno-30-99"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Tampered message valid: </span><span class="si">{</span><span class="n">is_valid_tampered</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-100" name="__codelineno-30-100" href="#__codelineno-30-100"></a>
<a id="__codelineno-30-101" name="__codelineno-30-101" href="#__codelineno-30-101"></a>    <span class="c1"># ECDSA Signature</span>
<a id="__codelineno-30-102" name="__codelineno-30-102" href="#__codelineno-30-102"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. ECDSA Signature:&quot;</span><span class="p">)</span>
<a id="__codelineno-30-103" name="__codelineno-30-103" href="#__codelineno-30-103"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-30-104" name="__codelineno-30-104" href="#__codelineno-30-104"></a>    <span class="n">ecdsa_sig</span> <span class="o">=</span> <span class="n">ECDSASignature</span><span class="p">()</span>
<a id="__codelineno-30-105" name="__codelineno-30-105" href="#__codelineno-30-105"></a>
<a id="__codelineno-30-106" name="__codelineno-30-106" href="#__codelineno-30-106"></a>    <span class="c1"># Sign</span>
<a id="__codelineno-30-107" name="__codelineno-30-107" href="#__codelineno-30-107"></a>    <span class="n">signature</span> <span class="o">=</span> <span class="n">ecdsa_sig</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-30-108" name="__codelineno-30-108" href="#__codelineno-30-108"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-109" name="__codelineno-30-109" href="#__codelineno-30-109"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<a id="__codelineno-30-110" name="__codelineno-30-110" href="#__codelineno-30-110"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signature (first 40 chars): </span><span class="si">{</span><span class="n">signature</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-30-111" name="__codelineno-30-111" href="#__codelineno-30-111"></a>
<a id="__codelineno-30-112" name="__codelineno-30-112" href="#__codelineno-30-112"></a>    <span class="c1"># Verify</span>
<a id="__codelineno-30-113" name="__codelineno-30-113" href="#__codelineno-30-113"></a>    <span class="n">is_valid</span> <span class="o">=</span> <span class="n">ecdsa_sig</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
<a id="__codelineno-30-114" name="__codelineno-30-114" href="#__codelineno-30-114"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Signature valid: </span><span class="si">{</span><span class="n">is_valid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-115" name="__codelineno-30-115" href="#__codelineno-30-115"></a>
<a id="__codelineno-30-116" name="__codelineno-30-116" href="#__codelineno-30-116"></a>    <span class="c1"># Comparison</span>
<a id="__codelineno-30-117" name="__codelineno-30-117" href="#__codelineno-30-117"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Comparison:&quot;</span><span class="p">)</span>
<a id="__codelineno-30-118" name="__codelineno-30-118" href="#__codelineno-30-118"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<a id="__codelineno-30-119" name="__codelineno-30-119" href="#__codelineno-30-119"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RSA-2048:&quot;</span><span class="p">)</span>
<a id="__codelineno-30-120" name="__codelineno-30-120" href="#__codelineno-30-120"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Key size: 2048 bits&quot;</span><span class="p">)</span>
<a id="__codelineno-30-121" name="__codelineno-30-121" href="#__codelineno-30-121"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Signature size: 256 bytes&quot;</span><span class="p">)</span>
<a id="__codelineno-30-122" name="__codelineno-30-122" href="#__codelineno-30-122"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Speed: Moderate&quot;</span><span class="p">)</span>
<a id="__codelineno-30-123" name="__codelineno-30-123" href="#__codelineno-30-123"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">ECDSA P-256:&quot;</span><span class="p">)</span>
<a id="__codelineno-30-124" name="__codelineno-30-124" href="#__codelineno-30-124"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Key size: 256 bits&quot;</span><span class="p">)</span>
<a id="__codelineno-30-125" name="__codelineno-30-125" href="#__codelineno-30-125"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Signature size: ~64 bytes&quot;</span><span class="p">)</span>
<a id="__codelineno-30-126" name="__codelineno-30-126" href="#__codelineno-30-126"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Speed: Fast&quot;</span><span class="p">)</span>
<a id="__codelineno-30-127" name="__codelineno-30-127" href="#__codelineno-30-127"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Advantage: Smaller, faster, same security&quot;</span><span class="p">)</span>
<a id="__codelineno-30-128" name="__codelineno-30-128" href="#__codelineno-30-128"></a>
<a id="__codelineno-30-129" name="__codelineno-30-129" href="#__codelineno-30-129"></a><span class="c1"># Document Signing Example</span>
<a id="__codelineno-30-130" name="__codelineno-30-130" href="#__codelineno-30-130"></a><span class="k">class</span><span class="w"> </span><span class="nc">DocumentSigner</span><span class="p">:</span>
<a id="__codelineno-30-131" name="__codelineno-30-131" href="#__codelineno-30-131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Sign and verify documents with metadata&quot;&quot;&quot;</span>
<a id="__codelineno-30-132" name="__codelineno-30-132" href="#__codelineno-30-132"></a>
<a id="__codelineno-30-133" name="__codelineno-30-133" href="#__codelineno-30-133"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-30-134" name="__codelineno-30-134" href="#__codelineno-30-134"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rsa_sig</span> <span class="o">=</span> <span class="n">RSASignature</span><span class="p">()</span>
<a id="__codelineno-30-135" name="__codelineno-30-135" href="#__codelineno-30-135"></a>
<a id="__codelineno-30-136" name="__codelineno-30-136" href="#__codelineno-30-136"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sign_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">signer_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-30-137" name="__codelineno-30-137" href="#__codelineno-30-137"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sign document and return signature package&quot;&quot;&quot;</span>
<a id="__codelineno-30-138" name="__codelineno-30-138" href="#__codelineno-30-138"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<a id="__codelineno-30-139" name="__codelineno-30-139" href="#__codelineno-30-139"></a>
<a id="__codelineno-30-140" name="__codelineno-30-140" href="#__codelineno-30-140"></a>        <span class="c1"># Create signature metadata</span>
<a id="__codelineno-30-141" name="__codelineno-30-141" href="#__codelineno-30-141"></a>        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
<a id="__codelineno-30-142" name="__codelineno-30-142" href="#__codelineno-30-142"></a>
<a id="__codelineno-30-143" name="__codelineno-30-143" href="#__codelineno-30-143"></a>        <span class="c1"># Sign document</span>
<a id="__codelineno-30-144" name="__codelineno-30-144" href="#__codelineno-30-144"></a>        <span class="n">signature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsa_sig</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
<a id="__codelineno-30-145" name="__codelineno-30-145" href="#__codelineno-30-145"></a>
<a id="__codelineno-30-146" name="__codelineno-30-146" href="#__codelineno-30-146"></a>        <span class="c1"># Create signature package</span>
<a id="__codelineno-30-147" name="__codelineno-30-147" href="#__codelineno-30-147"></a>        <span class="n">package</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-30-148" name="__codelineno-30-148" href="#__codelineno-30-148"></a>            <span class="s1">&#39;document&#39;</span><span class="p">:</span> <span class="n">document</span><span class="p">,</span>
<a id="__codelineno-30-149" name="__codelineno-30-149" href="#__codelineno-30-149"></a>            <span class="s1">&#39;signature&#39;</span><span class="p">:</span> <span class="n">signature</span><span class="p">,</span>
<a id="__codelineno-30-150" name="__codelineno-30-150" href="#__codelineno-30-150"></a>            <span class="s1">&#39;signer&#39;</span><span class="p">:</span> <span class="n">signer_name</span><span class="p">,</span>
<a id="__codelineno-30-151" name="__codelineno-30-151" href="#__codelineno-30-151"></a>            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
<a id="__codelineno-30-152" name="__codelineno-30-152" href="#__codelineno-30-152"></a>            <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="s1">&#39;RSA-2048-PSS&#39;</span><span class="p">,</span>
<a id="__codelineno-30-153" name="__codelineno-30-153" href="#__codelineno-30-153"></a>            <span class="s1">&#39;hash&#39;</span><span class="p">:</span> <span class="s1">&#39;SHA-256&#39;</span>
<a id="__codelineno-30-154" name="__codelineno-30-154" href="#__codelineno-30-154"></a>        <span class="p">}</span>
<a id="__codelineno-30-155" name="__codelineno-30-155" href="#__codelineno-30-155"></a>
<a id="__codelineno-30-156" name="__codelineno-30-156" href="#__codelineno-30-156"></a>        <span class="k">return</span> <span class="n">package</span>
<a id="__codelineno-30-157" name="__codelineno-30-157" href="#__codelineno-30-157"></a>
<a id="__codelineno-30-158" name="__codelineno-30-158" href="#__codelineno-30-158"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify_document</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-30-159" name="__codelineno-30-159" href="#__codelineno-30-159"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify signed document&quot;&quot;&quot;</span>
<a id="__codelineno-30-160" name="__codelineno-30-160" href="#__codelineno-30-160"></a>        <span class="n">document</span> <span class="o">=</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;document&#39;</span><span class="p">]</span>
<a id="__codelineno-30-161" name="__codelineno-30-161" href="#__codelineno-30-161"></a>        <span class="n">signature</span> <span class="o">=</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;signature&#39;</span><span class="p">]</span>
<a id="__codelineno-30-162" name="__codelineno-30-162" href="#__codelineno-30-162"></a>
<a id="__codelineno-30-163" name="__codelineno-30-163" href="#__codelineno-30-163"></a>        <span class="n">is_valid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsa_sig</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">signature</span><span class="p">)</span>
<a id="__codelineno-30-164" name="__codelineno-30-164" href="#__codelineno-30-164"></a>
<a id="__codelineno-30-165" name="__codelineno-30-165" href="#__codelineno-30-165"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-30-166" name="__codelineno-30-166" href="#__codelineno-30-166"></a>            <span class="s1">&#39;valid&#39;</span><span class="p">:</span> <span class="n">is_valid</span><span class="p">,</span>
<a id="__codelineno-30-167" name="__codelineno-30-167" href="#__codelineno-30-167"></a>            <span class="s1">&#39;signer&#39;</span><span class="p">:</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;signer&#39;</span><span class="p">],</span>
<a id="__codelineno-30-168" name="__codelineno-30-168" href="#__codelineno-30-168"></a>            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>
<a id="__codelineno-30-169" name="__codelineno-30-169" href="#__codelineno-30-169"></a>            <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="n">package</span><span class="p">[</span><span class="s1">&#39;algorithm&#39;</span><span class="p">]</span>
<a id="__codelineno-30-170" name="__codelineno-30-170" href="#__codelineno-30-170"></a>        <span class="p">}</span>
<a id="__codelineno-30-171" name="__codelineno-30-171" href="#__codelineno-30-171"></a>
<a id="__codelineno-30-172" name="__codelineno-30-172" href="#__codelineno-30-172"></a><span class="c1"># Usage</span>
<a id="__codelineno-30-173" name="__codelineno-30-173" href="#__codelineno-30-173"></a><span class="n">signer</span> <span class="o">=</span> <span class="n">DocumentSigner</span><span class="p">()</span>
<a id="__codelineno-30-174" name="__codelineno-30-174" href="#__codelineno-30-174"></a><span class="n">doc</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Confidential Agreement: Terms and Conditions...&quot;</span>
<a id="__codelineno-30-175" name="__codelineno-30-175" href="#__codelineno-30-175"></a>
<a id="__codelineno-30-176" name="__codelineno-30-176" href="#__codelineno-30-176"></a><span class="c1"># Sign</span>
<a id="__codelineno-30-177" name="__codelineno-30-177" href="#__codelineno-30-177"></a><span class="n">signed_doc</span> <span class="o">=</span> <span class="n">signer</span><span class="o">.</span><span class="n">sign_document</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s2">&quot;Alice Smith&quot;</span><span class="p">)</span>
<a id="__codelineno-30-178" name="__codelineno-30-178" href="#__codelineno-30-178"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Document signed by: </span><span class="si">{</span><span class="n">signed_doc</span><span class="p">[</span><span class="s1">&#39;signer&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-179" name="__codelineno-30-179" href="#__codelineno-30-179"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Timestamp: </span><span class="si">{</span><span class="n">signed_doc</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-180" name="__codelineno-30-180" href="#__codelineno-30-180"></a>
<a id="__codelineno-30-181" name="__codelineno-30-181" href="#__codelineno-30-181"></a><span class="c1"># Verify</span>
<a id="__codelineno-30-182" name="__codelineno-30-182" href="#__codelineno-30-182"></a><span class="n">verification</span> <span class="o">=</span> <span class="n">signer</span><span class="o">.</span><span class="n">verify_document</span><span class="p">(</span><span class="n">signed_doc</span><span class="p">)</span>
<a id="__codelineno-30-183" name="__codelineno-30-183" href="#__codelineno-30-183"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Valid: </span><span class="si">{</span><span class="n">verification</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-30-184" name="__codelineno-30-184" href="#__codelineno-30-184"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Signer: </span><span class="si">{</span><span class="n">verification</span><span class="p">[</span><span class="s1">&#39;signer&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="digital-signature-vs-mac-message-authentication-code">Digital Signature vs MAC (Message Authentication Code)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>        Digital Signature vs MAC Comparison                   
<a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>
<a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
<a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>DIGITAL SIGNATURE:
<a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>
<a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>Key Type:    Asymmetric (public/private)
<a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>Created by:  Private key
<a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>Verified by: Public key (anyone)
<a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>Use Case:    Public verification, non-repudiation
<a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>
<a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>                           
<a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>  Signer                              Anyone   
<a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>            Document + Signature               
<a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a> Private    Public  
<a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a>   Key                                  Key    
<a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a>                           
<a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a>                                           Verify
<a id="__codelineno-31-19" name="__codelineno-31-19" href="#__codelineno-31-19"></a>
<a id="__codelineno-31-20" name="__codelineno-31-20" href="#__codelineno-31-20"></a>Non-repudiation:  Yes
<a id="__codelineno-31-21" name="__codelineno-31-21" href="#__codelineno-31-21"></a>Speed:  Slower
<a id="__codelineno-31-22" name="__codelineno-31-22" href="#__codelineno-31-22"></a>
<a id="__codelineno-31-23" name="__codelineno-31-23" href="#__codelineno-31-23"></a>MAC (HMAC):
<a id="__codelineno-31-24" name="__codelineno-31-24" href="#__codelineno-31-24"></a>
<a id="__codelineno-31-25" name="__codelineno-31-25" href="#__codelineno-31-25"></a>Key Type:    Symmetric (shared secret)
<a id="__codelineno-31-26" name="__codelineno-31-26" href="#__codelineno-31-26"></a>Created by:  Shared secret key
<a id="__codelineno-31-27" name="__codelineno-31-27" href="#__codelineno-31-27"></a>Verified by: Shared secret key (only key holders)
<a id="__codelineno-31-28" name="__codelineno-31-28" href="#__codelineno-31-28"></a>Use Case:    Integrity between trusted parties
<a id="__codelineno-31-29" name="__codelineno-31-29" href="#__codelineno-31-29"></a>
<a id="__codelineno-31-30" name="__codelineno-31-30" href="#__codelineno-31-30"></a>                           
<a id="__codelineno-31-31" name="__codelineno-31-31" href="#__codelineno-31-31"></a>  Sender                              Receiver 
<a id="__codelineno-31-32" name="__codelineno-31-32" href="#__codelineno-31-32"></a>            Document + MAC                     
<a id="__codelineno-31-33" name="__codelineno-31-33" href="#__codelineno-31-33"></a>  Secret    Secret  
<a id="__codelineno-31-34" name="__codelineno-31-34" href="#__codelineno-31-34"></a>   Key                                  Key    
<a id="__codelineno-31-35" name="__codelineno-31-35" href="#__codelineno-31-35"></a>                           
<a id="__codelineno-31-36" name="__codelineno-31-36" href="#__codelineno-31-36"></a>                                           Verify
<a id="__codelineno-31-37" name="__codelineno-31-37" href="#__codelineno-31-37"></a>
<a id="__codelineno-31-38" name="__codelineno-31-38" href="#__codelineno-31-38"></a>Non-repudiation:  No (both parties have same key)
<a id="__codelineno-31-39" name="__codelineno-31-39" href="#__codelineno-31-39"></a>Speed:  Fast
<a id="__codelineno-31-40" name="__codelineno-31-40" href="#__codelineno-31-40"></a>
<a id="__codelineno-31-41" name="__codelineno-31-41" href="#__codelineno-31-41"></a>WHEN TO USE:
<a id="__codelineno-31-42" name="__codelineno-31-42" href="#__codelineno-31-42"></a>
<a id="__codelineno-31-43" name="__codelineno-31-43" href="#__codelineno-31-43"></a>Digital Signature:
<a id="__codelineno-31-44" name="__codelineno-31-44" href="#__codelineno-31-44"></a>- Public document verification
<a id="__codelineno-31-45" name="__codelineno-31-45" href="#__codelineno-31-45"></a>- Legal documents
<a id="__codelineno-31-46" name="__codelineno-31-46" href="#__codelineno-31-46"></a>- Software signing
<a id="__codelineno-31-47" name="__codelineno-31-47" href="#__codelineno-31-47"></a>- Email signing
<a id="__codelineno-31-48" name="__codelineno-31-48" href="#__codelineno-31-48"></a>- When non-repudiation needed
<a id="__codelineno-31-49" name="__codelineno-31-49" href="#__codelineno-31-49"></a>
<a id="__codelineno-31-50" name="__codelineno-31-50" href="#__codelineno-31-50"></a>MAC:
<a id="__codelineno-31-51" name="__codelineno-31-51" href="#__codelineno-31-51"></a>- TLS/HTTPS session integrity
<a id="__codelineno-31-52" name="__codelineno-31-52" href="#__codelineno-31-52"></a>- API authentication (both parties trust)
<a id="__codelineno-31-53" name="__codelineno-31-53" href="#__codelineno-31-53"></a>- Faster performance needed
<a id="__codelineno-31-54" name="__codelineno-31-54" href="#__codelineno-31-54"></a>- Internal systems
</code></pre></div>
<h4 id="symmetric-encryption-use-cases">Symmetric Encryption Use Cases</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a> RECOMMENDED USE CASES:
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>1. DISK ENCRYPTION
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>   
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>     Hard Drive     
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>            Fast encryption/decryption
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>      Encrypted        Single user (one key)
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>        Files          BitLocker, FileVault
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>       
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a>   
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a>2. DATABASE ENCRYPTION
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>   
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>      Database      
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>          Encrypt data at rest
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a>      Encrypted        High performance needed
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>       Records         TDE (Transparent Data Encryption)
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a>     
<a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a>   
<a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>
<a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a>3. FILE ENCRYPTION
<a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>   
<a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>      file.pdf      
<a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a>          Protect sensitive documents
<a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a>      Encrypted        7-Zip, VeraCrypt
<a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a>       Content         Password-based encryption
<a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a>     
<a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a>   
<a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a>
<a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a>4. VPN TUNNELS
<a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a>             
<a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a>    Client  Server   Secure communication channel
<a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a>     AES-256   After key exchange (HTTPS, IPSec)
<a id="__codelineno-32-35" name="__codelineno-32-35" href="#__codelineno-32-35"></a>
<a id="__codelineno-32-36" name="__codelineno-32-36" href="#__codelineno-32-36"></a>5. SESSION ENCRYPTION (After HTTPS Handshake)
<a id="__codelineno-32-37" name="__codelineno-32-37" href="#__codelineno-32-37"></a>   Browser  Server
<a id="__codelineno-32-38" name="__codelineno-32-38" href="#__codelineno-32-38"></a>           AES-GCM      After asymmetric key exchange
</code></pre></div>
<p><strong>Advantages:</strong>
-  <strong>Fast</strong>: Much faster than asymmetric encryption
-  <strong>Strong</strong>: 256-bit AES is virtually unbreakable
-  <strong>Efficient</strong>: Low computational overhead
-  <strong>Bulk Data</strong>: Suitable for encrypting large amounts of data</p>
<p><strong>Disadvantages:</strong>
-  <strong>Key Distribution</strong>: How to securely share the secret key?
-  <strong>Scalability</strong>: Need n(n-1)/2 keys for n users
-  <strong>Single Point of Failure</strong>: If key is compromised, all data is exposed</p>
<h3 id="the-key-exchange-problem-diffie-hellman-solution">The Key Exchange Problem &amp; Diffie-Hellman Solution</h3>
<p><strong>The Challenge:</strong></p>
<p>Symmetric encryption (like AES) is fast and secure, but there's a fundamental problem: <strong>How do two parties securely agree on a shared secret key over an insecure network?</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>               THE KEY DISTRIBUTION PROBLEM                   
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>ALICE wants to send encrypted message to BOB
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>Both need the same AES key
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a> INSECURE APPROACH:
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>ALICE                    INTERNET (Insecure)              BOB
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>                                                           
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>    &quot;Hey Bob, use key: mySecretKey123&quot;                     
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>  
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>                                                          
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>                                                
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>                       HACKER                            
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>                       Sees it!                          
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>                                                
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>                                                           
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a>   PROBLEM: Attacker intercepts the key!
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a>
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>THE DILEMMA:
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a>
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a>- Can&#39;t encrypt the key (no shared key yet!)
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a>- Can&#39;t send it in plaintext (insecure)
<a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a>- Can&#39;t meet in person (impractical for internet)
<a id="__codelineno-33-28" name="__codelineno-33-28" href="#__codelineno-33-28"></a>
<a id="__codelineno-33-29" name="__codelineno-33-29" href="#__codelineno-33-29"></a> SOLUTION: Diffie-Hellman Key Exchange
<a id="__codelineno-33-30" name="__codelineno-33-30" href="#__codelineno-33-30"></a>   Establish shared secret WITHOUT sending it!
</code></pre></div>
<h3 id="how-diffie-hellman-works">How Diffie-Hellman Works</h3>
<p><strong>Diffie-Hellman Key Exchange</strong> is a revolutionary algorithm that allows two parties to create a shared secret key over an insecure channel without ever transmitting the secret itself.</p>
<p><strong>The Magic:</strong> Both parties independently compute the same secret using:
- Public information (shared openly)
- Private information (never shared)
- Mathematical properties of modular exponentiation</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>         DIFFIE-HELLMAN KEY EXCHANGE (Step-by-Step)          
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>SETUP: Public Parameters (Known to everyone, including attackers)
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>p = 23     (Large prime number)
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>g = 5      (Generator/base, primitive root of p)
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>These are published openly - anyone can know them!
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>STEP 1: Generate Private Keys (Secret, never shared)
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>ALICE                                           BOB
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a>                                          
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>Choose random private key:                Choose random private key:
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a>a = 6 (secret!)                           b = 15 (secret!)
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>                                              
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>   KEPT SECRET                              KEPT SECRET
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>   Never transmitted                        Never transmitted
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>STEP 2: Compute Public Keys (Safe to share)
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>ALICE                                           BOB
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a>                                          
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a>A = g^a mod p                                 B = g^b mod p
<a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a>A = 5^6 mod 23                                B = 5^15 mod 23
<a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a>A = 15,625 mod 23                             B = 30,517,578,125 mod 23
<a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>A = 8                                         B = 19
<a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a>
<a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a>Public Key: A = 8                             Public Key: B = 19
<a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a>
<a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a>
<a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a>STEP 3: Exchange Public Keys (Over Insecure Network)
<a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a>
<a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a>
<a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a>ALICE                    INTERNET                    BOB
<a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a>              (Insecure Channel)              
<a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a>                                                      
<a id="__codelineno-34-46" name="__codelineno-34-46" href="#__codelineno-34-46"></a>             Send A = 8                               
<a id="__codelineno-34-47" name="__codelineno-34-47" href="#__codelineno-34-47"></a>  
<a id="__codelineno-34-48" name="__codelineno-34-48" href="#__codelineno-34-48"></a>                                                      
<a id="__codelineno-34-49" name="__codelineno-34-49" href="#__codelineno-34-49"></a>                     Attacker can see: p=23, g=5,   
<a id="__codelineno-34-50" name="__codelineno-34-50" href="#__codelineno-34-50"></a>                       A=8, B=19                      
<a id="__codelineno-34-51" name="__codelineno-34-51" href="#__codelineno-34-51"></a>                       But CANNOT find a or b!        
<a id="__codelineno-34-52" name="__codelineno-34-52" href="#__codelineno-34-52"></a>                                                      
<a id="__codelineno-34-53" name="__codelineno-34-53" href="#__codelineno-34-53"></a>             Send B = 19                              
<a id="__codelineno-34-54" name="__codelineno-34-54" href="#__codelineno-34-54"></a>  
<a id="__codelineno-34-55" name="__codelineno-34-55" href="#__codelineno-34-55"></a>                                                      
<a id="__codelineno-34-56" name="__codelineno-34-56" href="#__codelineno-34-56"></a>
<a id="__codelineno-34-57" name="__codelineno-34-57" href="#__codelineno-34-57"></a>
<a id="__codelineno-34-58" name="__codelineno-34-58" href="#__codelineno-34-58"></a>STEP 4: Compute Shared Secret (Independently)
<a id="__codelineno-34-59" name="__codelineno-34-59" href="#__codelineno-34-59"></a>
<a id="__codelineno-34-60" name="__codelineno-34-60" href="#__codelineno-34-60"></a>
<a id="__codelineno-34-61" name="__codelineno-34-61" href="#__codelineno-34-61"></a>ALICE                                           BOB
<a id="__codelineno-34-62" name="__codelineno-34-62" href="#__codelineno-34-62"></a>                                          
<a id="__codelineno-34-63" name="__codelineno-34-63" href="#__codelineno-34-63"></a>
<a id="__codelineno-34-64" name="__codelineno-34-64" href="#__codelineno-34-64"></a>Uses Bob&#39;s public (B) and                     Uses Alice&#39;s public (A) and
<a id="__codelineno-34-65" name="__codelineno-34-65" href="#__codelineno-34-65"></a>her private (a):                              his private (b):
<a id="__codelineno-34-66" name="__codelineno-34-66" href="#__codelineno-34-66"></a>
<a id="__codelineno-34-67" name="__codelineno-34-67" href="#__codelineno-34-67"></a>s = B^a mod p                                 s = A^b mod p
<a id="__codelineno-34-68" name="__codelineno-34-68" href="#__codelineno-34-68"></a>s = 19^6 mod 23                               s = 8^15 mod 23
<a id="__codelineno-34-69" name="__codelineno-34-69" href="#__codelineno-34-69"></a>s = 47,045,881 mod 23                         s = 35,184,372,088,832 mod 23
<a id="__codelineno-34-70" name="__codelineno-34-70" href="#__codelineno-34-70"></a>s = 2                                         s = 2
<a id="__codelineno-34-71" name="__codelineno-34-71" href="#__codelineno-34-71"></a>
<a id="__codelineno-34-72" name="__codelineno-34-72" href="#__codelineno-34-72"></a>Shared Secret: 2                              Shared Secret: 2
<a id="__codelineno-34-73" name="__codelineno-34-73" href="#__codelineno-34-73"></a>
<a id="__codelineno-34-74" name="__codelineno-34-74" href="#__codelineno-34-74"></a>                                                  
<a id="__codelineno-34-75" name="__codelineno-34-75" href="#__codelineno-34-75"></a>               SAME SECRET KEY!               
<a id="__codelineno-34-76" name="__codelineno-34-76" href="#__codelineno-34-76"></a>     
<a id="__codelineno-34-77" name="__codelineno-34-77" href="#__codelineno-34-77"></a>                       
<a id="__codelineno-34-78" name="__codelineno-34-78" href="#__codelineno-34-78"></a>                  Both have: s = 2
<a id="__codelineno-34-79" name="__codelineno-34-79" href="#__codelineno-34-79"></a>                  Without ever transmitting it!
<a id="__codelineno-34-80" name="__codelineno-34-80" href="#__codelineno-34-80"></a>
<a id="__codelineno-34-81" name="__codelineno-34-81" href="#__codelineno-34-81"></a>
<a id="__codelineno-34-82" name="__codelineno-34-82" href="#__codelineno-34-82"></a>
<a id="__codelineno-34-83" name="__codelineno-34-83" href="#__codelineno-34-83"></a>
<a id="__codelineno-34-84" name="__codelineno-34-84" href="#__codelineno-34-84"></a>MATHEMATICAL PROOF (Why it works):
<a id="__codelineno-34-85" name="__codelineno-34-85" href="#__codelineno-34-85"></a>
<a id="__codelineno-34-86" name="__codelineno-34-86" href="#__codelineno-34-86"></a>
<a id="__codelineno-34-87" name="__codelineno-34-87" href="#__codelineno-34-87"></a>Alice computes:  s = B^a mod p = (g^b)^a mod p = g^(ab) mod p
<a id="__codelineno-34-88" name="__codelineno-34-88" href="#__codelineno-34-88"></a>Bob computes:    s = A^b mod p = (g^a)^b mod p = g^(ab) mod p
<a id="__codelineno-34-89" name="__codelineno-34-89" href="#__codelineno-34-89"></a>
<a id="__codelineno-34-90" name="__codelineno-34-90" href="#__codelineno-34-90"></a>Since g^(ab) = g^(ba), both get the same result!
<a id="__codelineno-34-91" name="__codelineno-34-91" href="#__codelineno-34-91"></a>
<a id="__codelineno-34-92" name="__codelineno-34-92" href="#__codelineno-34-92"></a>Example:
<a id="__codelineno-34-93" name="__codelineno-34-93" href="#__codelineno-34-93"></a>Alice: (5^15)^6 mod 23 = 5^90 mod 23
<a id="__codelineno-34-94" name="__codelineno-34-94" href="#__codelineno-34-94"></a>Bob:   (5^6)^15 mod 23 = 5^90 mod 23
<a id="__codelineno-34-95" name="__codelineno-34-95" href="#__codelineno-34-95"></a>Both equal: 2
<a id="__codelineno-34-96" name="__codelineno-34-96" href="#__codelineno-34-96"></a>
<a id="__codelineno-34-97" name="__codelineno-34-97" href="#__codelineno-34-97"></a>
<a id="__codelineno-34-98" name="__codelineno-34-98" href="#__codelineno-34-98"></a>
<a id="__codelineno-34-99" name="__codelineno-34-99" href="#__codelineno-34-99"></a>
<a id="__codelineno-34-100" name="__codelineno-34-100" href="#__codelineno-34-100"></a>SECURITY: The Discrete Logarithm Problem (DLP)
<a id="__codelineno-34-101" name="__codelineno-34-101" href="#__codelineno-34-101"></a>
<a id="__codelineno-34-102" name="__codelineno-34-102" href="#__codelineno-34-102"></a>
<a id="__codelineno-34-103" name="__codelineno-34-103" href="#__codelineno-34-103"></a>Attacker knows: p = 23, g = 5, A = 8, B = 19
<a id="__codelineno-34-104" name="__codelineno-34-104" href="#__codelineno-34-104"></a>Attacker wants:  a or b (to compute shared secret)
<a id="__codelineno-34-105" name="__codelineno-34-105" href="#__codelineno-34-105"></a>
<a id="__codelineno-34-106" name="__codelineno-34-106" href="#__codelineno-34-106"></a>Problem: Given A = g^a mod p, find a
<a id="__codelineno-34-107" name="__codelineno-34-107" href="#__codelineno-34-107"></a>         Given 8 = 5^a mod 23, find a = ?
<a id="__codelineno-34-108" name="__codelineno-34-108" href="#__codelineno-34-108"></a>
<a id="__codelineno-34-109" name="__codelineno-34-109" href="#__codelineno-34-109"></a>For small numbers: Solvable by brute force
<a id="__codelineno-34-110" name="__codelineno-34-110" href="#__codelineno-34-110"></a>For large numbers (2048-bit): Computationally infeasible!
<a id="__codelineno-34-111" name="__codelineno-34-111" href="#__codelineno-34-111"></a>
<a id="__codelineno-34-112" name="__codelineno-34-112" href="#__codelineno-34-112"></a>Example with real-world sizes:
<a id="__codelineno-34-113" name="__codelineno-34-113" href="#__codelineno-34-113"></a>p = 2048-bit prime number (617 digits!)
<a id="__codelineno-34-114" name="__codelineno-34-114" href="#__codelineno-34-114"></a>Finding a is like searching 2^2048 possibilities
<a id="__codelineno-34-115" name="__codelineno-34-115" href="#__codelineno-34-115"></a>   = 10^617 operations
<a id="__codelineno-34-116" name="__codelineno-34-116" href="#__codelineno-34-116"></a>   = More than atoms in the universe!
<a id="__codelineno-34-117" name="__codelineno-34-117" href="#__codelineno-34-117"></a>
<a id="__codelineno-34-118" name="__codelineno-34-118" href="#__codelineno-34-118"></a>This is why Diffie-Hellman is secure.
<a id="__codelineno-34-119" name="__codelineno-34-119" href="#__codelineno-34-119"></a>
<a id="__codelineno-34-120" name="__codelineno-34-120" href="#__codelineno-34-120"></a>
<a id="__codelineno-34-121" name="__codelineno-34-121" href="#__codelineno-34-121"></a>
<a id="__codelineno-34-122" name="__codelineno-34-122" href="#__codelineno-34-122"></a>
<a id="__codelineno-34-123" name="__codelineno-34-123" href="#__codelineno-34-123"></a>VISUAL ANALOGY: Paint Mixing
<a id="__codelineno-34-124" name="__codelineno-34-124" href="#__codelineno-34-124"></a>
<a id="__codelineno-34-125" name="__codelineno-34-125" href="#__codelineno-34-125"></a>
<a id="__codelineno-34-126" name="__codelineno-34-126" href="#__codelineno-34-126"></a>Think of it like mixing paint colors:
<a id="__codelineno-34-127" name="__codelineno-34-127" href="#__codelineno-34-127"></a>
<a id="__codelineno-34-128" name="__codelineno-34-128" href="#__codelineno-34-128"></a>1. PUBLIC COLOR (Yellow) - Known to everyone
<a id="__codelineno-34-129" name="__codelineno-34-129" href="#__codelineno-34-129"></a>   
<a id="__codelineno-34-130" name="__codelineno-34-130" href="#__codelineno-34-130"></a>     Yellow    Public parameter (like g and p)
<a id="__codelineno-34-131" name="__codelineno-34-131" href="#__codelineno-34-131"></a>   
<a id="__codelineno-34-132" name="__codelineno-34-132" href="#__codelineno-34-132"></a>        
<a id="__codelineno-34-133" name="__codelineno-34-133" href="#__codelineno-34-133"></a>        
<a id="__codelineno-34-134" name="__codelineno-34-134" href="#__codelineno-34-134"></a>                                        
<a id="__codelineno-34-135" name="__codelineno-34-135" href="#__codelineno-34-135"></a>              
<a id="__codelineno-34-136" name="__codelineno-34-136" href="#__codelineno-34-136"></a>     Alice           Bob         Hacker  
<a id="__codelineno-34-137" name="__codelineno-34-137" href="#__codelineno-34-137"></a>     Gets           Gets          Gets   
<a id="__codelineno-34-138" name="__codelineno-34-138" href="#__codelineno-34-138"></a>    Yellow         Yellow        Yellow  
<a id="__codelineno-34-139" name="__codelineno-34-139" href="#__codelineno-34-139"></a>              
<a id="__codelineno-34-140" name="__codelineno-34-140" href="#__codelineno-34-140"></a>
<a id="__codelineno-34-141" name="__codelineno-34-141" href="#__codelineno-34-141"></a>2. ADD SECRET COLORS (Private keys)
<a id="__codelineno-34-142" name="__codelineno-34-142" href="#__codelineno-34-142"></a>         
<a id="__codelineno-34-143" name="__codelineno-34-143" href="#__codelineno-34-143"></a>     Alice           Bob   
<a id="__codelineno-34-144" name="__codelineno-34-144" href="#__codelineno-34-144"></a>    Yellow         Yellow  
<a id="__codelineno-34-145" name="__codelineno-34-145" href="#__codelineno-34-145"></a>      +              +     
<a id="__codelineno-34-146" name="__codelineno-34-146" href="#__codelineno-34-146"></a>     Blue            Red     Secret colors (private keys a, b)
<a id="__codelineno-34-147" name="__codelineno-34-147" href="#__codelineno-34-147"></a>    (Secret)       (Secret)
<a id="__codelineno-34-148" name="__codelineno-34-148" href="#__codelineno-34-148"></a>         
<a id="__codelineno-34-149" name="__codelineno-34-149" href="#__codelineno-34-149"></a>                        
<a id="__codelineno-34-150" name="__codelineno-34-150" href="#__codelineno-34-150"></a>                        
<a id="__codelineno-34-151" name="__codelineno-34-151" href="#__codelineno-34-151"></a>         
<a id="__codelineno-34-152" name="__codelineno-34-152" href="#__codelineno-34-152"></a>     Green         Orange    Public keys (A, B)
<a id="__codelineno-34-153" name="__codelineno-34-153" href="#__codelineno-34-153"></a>         
<a id="__codelineno-34-154" name="__codelineno-34-154" href="#__codelineno-34-154"></a>
<a id="__codelineno-34-155" name="__codelineno-34-155" href="#__codelineno-34-155"></a>3. EXCHANGE PUBLIC MIXES
<a id="__codelineno-34-156" name="__codelineno-34-156" href="#__codelineno-34-156"></a>                        
<a id="__codelineno-34-157" name="__codelineno-34-157" href="#__codelineno-34-157"></a>        
<a id="__codelineno-34-158" name="__codelineno-34-158" href="#__codelineno-34-158"></a>                  Exchange
<a id="__codelineno-34-159" name="__codelineno-34-159" href="#__codelineno-34-159"></a>        
<a id="__codelineno-34-160" name="__codelineno-34-160" href="#__codelineno-34-160"></a>                        
<a id="__codelineno-34-161" name="__codelineno-34-161" href="#__codelineno-34-161"></a>         
<a id="__codelineno-34-162" name="__codelineno-34-162" href="#__codelineno-34-162"></a>     Alice           Bob   
<a id="__codelineno-34-163" name="__codelineno-34-163" href="#__codelineno-34-163"></a>     Green         Orange    Received each other&#39;s public
<a id="__codelineno-34-164" name="__codelineno-34-164" href="#__codelineno-34-164"></a>      +              +     
<a id="__codelineno-34-165" name="__codelineno-34-165" href="#__codelineno-34-165"></a>     Blue            Red     Add own secret again
<a id="__codelineno-34-166" name="__codelineno-34-166" href="#__codelineno-34-166"></a>    (Secret)       (Secret)
<a id="__codelineno-34-167" name="__codelineno-34-167" href="#__codelineno-34-167"></a>         
<a id="__codelineno-34-168" name="__codelineno-34-168" href="#__codelineno-34-168"></a>                        
<a id="__codelineno-34-169" name="__codelineno-34-169" href="#__codelineno-34-169"></a>                        
<a id="__codelineno-34-170" name="__codelineno-34-170" href="#__codelineno-34-170"></a>         
<a id="__codelineno-34-171" name="__codelineno-34-171" href="#__codelineno-34-171"></a>     Brown          Brown    SAME COLOR (shared secret!)
<a id="__codelineno-34-172" name="__codelineno-34-172" href="#__codelineno-34-172"></a>         
<a id="__codelineno-34-173" name="__codelineno-34-173" href="#__codelineno-34-173"></a>
<a id="__codelineno-34-174" name="__codelineno-34-174" href="#__codelineno-34-174"></a>The hacker sees: Yellow, Green, Orange
<a id="__codelineno-34-175" name="__codelineno-34-175" href="#__codelineno-34-175"></a>But CANNOT create Brown without Blue or Red!
<a id="__codelineno-34-176" name="__codelineno-34-176" href="#__codelineno-34-176"></a>(Can&#39;t &quot;unmix&quot; paint to extract secret colors)
<a id="__codelineno-34-177" name="__codelineno-34-177" href="#__codelineno-34-177"></a>
<a id="__codelineno-34-178" name="__codelineno-34-178" href="#__codelineno-34-178"></a>
<a id="__codelineno-34-179" name="__codelineno-34-179" href="#__codelineno-34-179"></a>
<a id="__codelineno-34-180" name="__codelineno-34-180" href="#__codelineno-34-180"></a>
<a id="__codelineno-34-181" name="__codelineno-34-181" href="#__codelineno-34-181"></a>COMPLETE COMMUNICATION FLOW
<a id="__codelineno-34-182" name="__codelineno-34-182" href="#__codelineno-34-182"></a>
<a id="__codelineno-34-183" name="__codelineno-34-183" href="#__codelineno-34-183"></a>
<a id="__codelineno-34-184" name="__codelineno-34-184" href="#__codelineno-34-184"></a>Step 1: Diffie-Hellman Key Exchange
<a id="__codelineno-34-185" name="__codelineno-34-185" href="#__codelineno-34-185"></a>         
<a id="__codelineno-34-186" name="__codelineno-34-186" href="#__codelineno-34-186"></a>    Shared Secret: s = 2
<a id="__codelineno-34-187" name="__codelineno-34-187" href="#__codelineno-34-187"></a>
<a id="__codelineno-34-188" name="__codelineno-34-188" href="#__codelineno-34-188"></a>Step 2: Derive Encryption Key from Shared Secret
<a id="__codelineno-34-189" name="__codelineno-34-189" href="#__codelineno-34-189"></a>         s = 2  Hash(s)  AES Key
<a id="__codelineno-34-190" name="__codelineno-34-190" href="#__codelineno-34-190"></a>         Example: SHA-256(2) = &quot;f2a3b4c5...&quot; (32 bytes)
<a id="__codelineno-34-191" name="__codelineno-34-191" href="#__codelineno-34-191"></a>         
<a id="__codelineno-34-192" name="__codelineno-34-192" href="#__codelineno-34-192"></a>    AES-256 Key: f2a3b4c5d6e7f8...
<a id="__codelineno-34-193" name="__codelineno-34-193" href="#__codelineno-34-193"></a>
<a id="__codelineno-34-194" name="__codelineno-34-194" href="#__codelineno-34-194"></a>Step 3: Use AES for Fast Encryption
<a id="__codelineno-34-195" name="__codelineno-34-195" href="#__codelineno-34-195"></a>         
<a id="__codelineno-34-196" name="__codelineno-34-196" href="#__codelineno-34-196"></a>
<a id="__codelineno-34-197" name="__codelineno-34-197" href="#__codelineno-34-197"></a>ALICE                                           BOB
<a id="__codelineno-34-198" name="__codelineno-34-198" href="#__codelineno-34-198"></a>                                          
<a id="__codelineno-34-199" name="__codelineno-34-199" href="#__codelineno-34-199"></a>Plaintext: &quot;Hello Bob!&quot;                    (Waiting)
<a id="__codelineno-34-200" name="__codelineno-34-200" href="#__codelineno-34-200"></a>     
<a id="__codelineno-34-201" name="__codelineno-34-201" href="#__codelineno-34-201"></a>Encrypt with AES using                     
<a id="__codelineno-34-202" name="__codelineno-34-202" href="#__codelineno-34-202"></a>shared key:                                
<a id="__codelineno-34-203" name="__codelineno-34-203" href="#__codelineno-34-203"></a>     
<a id="__codelineno-34-204" name="__codelineno-34-204" href="#__codelineno-34-204"></a>Ciphertext: &quot;xK9#mP2$vL...&quot;
<a id="__codelineno-34-205" name="__codelineno-34-205" href="#__codelineno-34-205"></a>                                               
<a id="__codelineno-34-206" name="__codelineno-34-206" href="#__codelineno-34-206"></a>       Send Ciphertext                         
<a id="__codelineno-34-207" name="__codelineno-34-207" href="#__codelineno-34-207"></a>     
<a id="__codelineno-34-208" name="__codelineno-34-208" href="#__codelineno-34-208"></a>                                               
<a id="__codelineno-34-209" name="__codelineno-34-209" href="#__codelineno-34-209"></a>                                          Decrypt with AES
<a id="__codelineno-34-210" name="__codelineno-34-210" href="#__codelineno-34-210"></a>                                          using shared key:
<a id="__codelineno-34-211" name="__codelineno-34-211" href="#__codelineno-34-211"></a>                                               
<a id="__codelineno-34-212" name="__codelineno-34-212" href="#__codelineno-34-212"></a>                                          Plaintext: &quot;Hello Bob!&quot;
<a id="__codelineno-34-213" name="__codelineno-34-213" href="#__codelineno-34-213"></a>
<a id="__codelineno-34-214" name="__codelineno-34-214" href="#__codelineno-34-214"></a>
<a id="__codelineno-34-215" name="__codelineno-34-215" href="#__codelineno-34-215"></a>
<a id="__codelineno-34-216" name="__codelineno-34-216" href="#__codelineno-34-216"></a>WHY THIS IS REVOLUTIONARY:
<a id="__codelineno-34-217" name="__codelineno-34-217" href="#__codelineno-34-217"></a>
<a id="__codelineno-34-218" name="__codelineno-34-218" href="#__codelineno-34-218"></a>
<a id="__codelineno-34-219" name="__codelineno-34-219" href="#__codelineno-34-219"></a> No Pre-shared Secret Needed
<a id="__codelineno-34-220" name="__codelineno-34-220" href="#__codelineno-34-220"></a>   Alice and Bob never met before, yet created shared secret!
<a id="__codelineno-34-221" name="__codelineno-34-221" href="#__codelineno-34-221"></a>
<a id="__codelineno-34-222" name="__codelineno-34-222" href="#__codelineno-34-222"></a> Secure Over Insecure Channel
<a id="__codelineno-34-223" name="__codelineno-34-223" href="#__codelineno-34-223"></a>   Even if attacker sees all communication, cannot get secret
<a id="__codelineno-34-224" name="__codelineno-34-224" href="#__codelineno-34-224"></a>
<a id="__codelineno-34-225" name="__codelineno-34-225" href="#__codelineno-34-225"></a> Perfect Forward Secrecy
<a id="__codelineno-34-226" name="__codelineno-34-226" href="#__codelineno-34-226"></a>   Each session can use different ephemeral keys
<a id="__codelineno-34-227" name="__codelineno-34-227" href="#__codelineno-34-227"></a>   If one session key compromised, others remain safe
<a id="__codelineno-34-228" name="__codelineno-34-228" href="#__codelineno-34-228"></a>
<a id="__codelineno-34-229" name="__codelineno-34-229" href="#__codelineno-34-229"></a> Enables Modern Internet Security
<a id="__codelineno-34-230" name="__codelineno-34-230" href="#__codelineno-34-230"></a>   Foundation of:
<a id="__codelineno-34-231" name="__codelineno-34-231" href="#__codelineno-34-231"></a>   - TLS/HTTPS (secure websites)
<a id="__codelineno-34-232" name="__codelineno-34-232" href="#__codelineno-34-232"></a>   - SSH (secure remote access)
<a id="__codelineno-34-233" name="__codelineno-34-233" href="#__codelineno-34-233"></a>   - VPNs (secure networks)
<a id="__codelineno-34-234" name="__codelineno-34-234" href="#__codelineno-34-234"></a>   - Signal/WhatsApp (secure messaging)
</code></pre></div>
<h3 id="diffie-hellman-implementation">Diffie-Hellman Implementation</h3>
<p><strong>Complete Python Implementation:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Cipher</span><span class="w"> </span><span class="kn">import</span> <span class="n">AES</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Random</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_random_bytes</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.Padding</span><span class="w"> </span><span class="kn">import</span> <span class="n">pad</span><span class="p">,</span> <span class="n">unpad</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">DiffieHellman</span><span class="p">:</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="sd">    Complete Diffie-Hellman Key Exchange Implementation</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="sd">    Demonstrates secure key exchange over insecure channel</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">):</span>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="sd">        Initialize with public parameters</span>
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="sd">        In practice, these are standardized (RFC 3526)</span>
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>        <span class="c1"># Use well-known safe primes for production</span>
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>        <span class="c1"># For demonstration, using smaller numbers</span>
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>        <span class="k">if</span> <span class="n">key_size</span> <span class="o">==</span> <span class="mi">2048</span><span class="p">:</span>
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>            <span class="c1"># RFC 3526 - 2048-bit MODP Group</span>
<a id="__codelineno-35-23" name="__codelineno-35-23" href="#__codelineno-35-23"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
<a id="__codelineno-35-24" name="__codelineno-35-24" href="#__codelineno-35-24"></a>                <span class="s2">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1&quot;</span>
<a id="__codelineno-35-25" name="__codelineno-35-25" href="#__codelineno-35-25"></a>                <span class="s2">&quot;29024E088A67CC74020BBEA63B139B22514A08798E3404DD&quot;</span>
<a id="__codelineno-35-26" name="__codelineno-35-26" href="#__codelineno-35-26"></a>                <span class="s2">&quot;EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245&quot;</span>
<a id="__codelineno-35-27" name="__codelineno-35-27" href="#__codelineno-35-27"></a>                <span class="s2">&quot;E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED&quot;</span>
<a id="__codelineno-35-28" name="__codelineno-35-28" href="#__codelineno-35-28"></a>                <span class="s2">&quot;EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D&quot;</span>
<a id="__codelineno-35-29" name="__codelineno-35-29" href="#__codelineno-35-29"></a>                <span class="s2">&quot;C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F&quot;</span>
<a id="__codelineno-35-30" name="__codelineno-35-30" href="#__codelineno-35-30"></a>                <span class="s2">&quot;83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>
<a id="__codelineno-35-31" name="__codelineno-35-31" href="#__codelineno-35-31"></a>                <span class="s2">&quot;670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B&quot;</span>
<a id="__codelineno-35-32" name="__codelineno-35-32" href="#__codelineno-35-32"></a>                <span class="s2">&quot;E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9&quot;</span>
<a id="__codelineno-35-33" name="__codelineno-35-33" href="#__codelineno-35-33"></a>                <span class="s2">&quot;DE2BCBF6955817183995497CEA956AE515D2261898FA0510&quot;</span>
<a id="__codelineno-35-34" name="__codelineno-35-34" href="#__codelineno-35-34"></a>                <span class="s2">&quot;15728E5A8AACAA68FFFFFFFFFFFFFFFF&quot;</span><span class="p">,</span> <span class="mi">16</span>
<a id="__codelineno-35-35" name="__codelineno-35-35" href="#__codelineno-35-35"></a>            <span class="p">)</span>
<a id="__codelineno-35-36" name="__codelineno-35-36" href="#__codelineno-35-36"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span>
<a id="__codelineno-35-37" name="__codelineno-35-37" href="#__codelineno-35-37"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-35-38" name="__codelineno-35-38" href="#__codelineno-35-38"></a>            <span class="c1"># Toy example for demonstration</span>
<a id="__codelineno-35-39" name="__codelineno-35-39" href="#__codelineno-35-39"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="mi">23</span>  <span class="c1"># Small prime</span>
<a id="__codelineno-35-40" name="__codelineno-35-40" href="#__codelineno-35-40"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="mi">5</span>   <span class="c1"># Generator</span>
<a id="__codelineno-35-41" name="__codelineno-35-41" href="#__codelineno-35-41"></a>
<a id="__codelineno-35-42" name="__codelineno-35-42" href="#__codelineno-35-42"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-35-43" name="__codelineno-35-43" href="#__codelineno-35-43"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-35-44" name="__codelineno-35-44" href="#__codelineno-35-44"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shared_secret</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-35-45" name="__codelineno-35-45" href="#__codelineno-35-45"></a>
<a id="__codelineno-35-46" name="__codelineno-35-46" href="#__codelineno-35-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_private_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-35-47" name="__codelineno-35-47" href="#__codelineno-35-47"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate random private key&quot;&quot;&quot;</span>
<a id="__codelineno-35-48" name="__codelineno-35-48" href="#__codelineno-35-48"></a>        <span class="c1"># Private key should be random number: 2 &lt;= private_key &lt; p-1</span>
<a id="__codelineno-35-49" name="__codelineno-35-49" href="#__codelineno-35-49"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="o">=</span> <span class="n">secrets</span><span class="o">.</span><span class="n">randbelow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<a id="__codelineno-35-50" name="__codelineno-35-50" href="#__codelineno-35-50"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span>
<a id="__codelineno-35-51" name="__codelineno-35-51" href="#__codelineno-35-51"></a>
<a id="__codelineno-35-52" name="__codelineno-35-52" href="#__codelineno-35-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_public_key</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-35-53" name="__codelineno-35-53" href="#__codelineno-35-53"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute public key: g^private mod p&quot;&quot;&quot;</span>
<a id="__codelineno-35-54" name="__codelineno-35-54" href="#__codelineno-35-54"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-35-55" name="__codelineno-35-55" href="#__codelineno-35-55"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-35-56" name="__codelineno-35-56" href="#__codelineno-35-56"></a>
<a id="__codelineno-35-57" name="__codelineno-35-57" href="#__codelineno-35-57"></a>        <span class="c1"># Public key = g^a mod p</span>
<a id="__codelineno-35-58" name="__codelineno-35-58" href="#__codelineno-35-58"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
<a id="__codelineno-35-59" name="__codelineno-35-59" href="#__codelineno-35-59"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_key</span>
<a id="__codelineno-35-60" name="__codelineno-35-60" href="#__codelineno-35-60"></a>
<a id="__codelineno-35-61" name="__codelineno-35-61" href="#__codelineno-35-61"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_shared_secret</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_public_key</span><span class="p">):</span>
<a id="__codelineno-35-62" name="__codelineno-35-62" href="#__codelineno-35-62"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-63" name="__codelineno-35-63" href="#__codelineno-35-63"></a><span class="sd">        Compute shared secret using other party&#39;s public key</span>
<a id="__codelineno-35-64" name="__codelineno-35-64" href="#__codelineno-35-64"></a><span class="sd">        shared_secret = other_public^private mod p</span>
<a id="__codelineno-35-65" name="__codelineno-35-65" href="#__codelineno-35-65"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-35-66" name="__codelineno-35-66" href="#__codelineno-35-66"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-35-67" name="__codelineno-35-67" href="#__codelineno-35-67"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must generate private key first&quot;</span><span class="p">)</span>
<a id="__codelineno-35-68" name="__codelineno-35-68" href="#__codelineno-35-68"></a>
<a id="__codelineno-35-69" name="__codelineno-35-69" href="#__codelineno-35-69"></a>        <span class="c1"># Shared secret = B^a mod p (or A^b mod p)</span>
<a id="__codelineno-35-70" name="__codelineno-35-70" href="#__codelineno-35-70"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shared_secret</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">other_public_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">private_key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
<a id="__codelineno-35-71" name="__codelineno-35-71" href="#__codelineno-35-71"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_secret</span>
<a id="__codelineno-35-72" name="__codelineno-35-72" href="#__codelineno-35-72"></a>
<a id="__codelineno-35-73" name="__codelineno-35-73" href="#__codelineno-35-73"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">derive_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key_length</span><span class="o">=</span><span class="mi">32</span><span class="p">):</span>
<a id="__codelineno-35-74" name="__codelineno-35-74" href="#__codelineno-35-74"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-75" name="__codelineno-35-75" href="#__codelineno-35-75"></a><span class="sd">        Derive encryption key from shared secret</span>
<a id="__codelineno-35-76" name="__codelineno-35-76" href="#__codelineno-35-76"></a><span class="sd">        Uses SHA-256 hash to create AES key</span>
<a id="__codelineno-35-77" name="__codelineno-35-77" href="#__codelineno-35-77"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-35-78" name="__codelineno-35-78" href="#__codelineno-35-78"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_secret</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-35-79" name="__codelineno-35-79" href="#__codelineno-35-79"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must compute shared secret first&quot;</span><span class="p">)</span>
<a id="__codelineno-35-80" name="__codelineno-35-80" href="#__codelineno-35-80"></a>
<a id="__codelineno-35-81" name="__codelineno-35-81" href="#__codelineno-35-81"></a>        <span class="c1"># Convert shared secret to bytes and hash it</span>
<a id="__codelineno-35-82" name="__codelineno-35-82" href="#__codelineno-35-82"></a>        <span class="n">secret_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shared_secret</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span>
<a id="__codelineno-35-83" name="__codelineno-35-83" href="#__codelineno-35-83"></a>            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shared_secret</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> 
<a id="__codelineno-35-84" name="__codelineno-35-84" href="#__codelineno-35-84"></a>            <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span>
<a id="__codelineno-35-85" name="__codelineno-35-85" href="#__codelineno-35-85"></a>        <span class="p">)</span>
<a id="__codelineno-35-86" name="__codelineno-35-86" href="#__codelineno-35-86"></a>
<a id="__codelineno-35-87" name="__codelineno-35-87" href="#__codelineno-35-87"></a>        <span class="c1"># Derive key using SHA-256</span>
<a id="__codelineno-35-88" name="__codelineno-35-88" href="#__codelineno-35-88"></a>        <span class="n">derived_key</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">secret_bytes</span><span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
<a id="__codelineno-35-89" name="__codelineno-35-89" href="#__codelineno-35-89"></a>        <span class="k">return</span> <span class="n">derived_key</span><span class="p">[:</span><span class="n">key_length</span><span class="p">]</span>
<a id="__codelineno-35-90" name="__codelineno-35-90" href="#__codelineno-35-90"></a>
<a id="__codelineno-35-91" name="__codelineno-35-91" href="#__codelineno-35-91"></a>
<a id="__codelineno-35-92" name="__codelineno-35-92" href="#__codelineno-35-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_diffie_hellman</span><span class="p">():</span>
<a id="__codelineno-35-93" name="__codelineno-35-93" href="#__codelineno-35-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-94" name="__codelineno-35-94" href="#__codelineno-35-94"></a><span class="sd">    Demonstrate complete Diffie-Hellman key exchange</span>
<a id="__codelineno-35-95" name="__codelineno-35-95" href="#__codelineno-35-95"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-35-96" name="__codelineno-35-96" href="#__codelineno-35-96"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-97" name="__codelineno-35-97" href="#__codelineno-35-97"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DIFFIE-HELLMAN KEY EXCHANGE DEMONSTRATION&quot;</span><span class="p">)</span>
<a id="__codelineno-35-98" name="__codelineno-35-98" href="#__codelineno-35-98"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-99" name="__codelineno-35-99" href="#__codelineno-35-99"></a>
<a id="__codelineno-35-100" name="__codelineno-35-100" href="#__codelineno-35-100"></a>    <span class="c1"># </span>
<a id="__codelineno-35-101" name="__codelineno-35-101" href="#__codelineno-35-101"></a>    <span class="c1"># STEP 1: Setup - Agree on public parameters</span>
<a id="__codelineno-35-102" name="__codelineno-35-102" href="#__codelineno-35-102"></a>    <span class="c1"># </span>
<a id="__codelineno-35-103" name="__codelineno-35-103" href="#__codelineno-35-103"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 1: Public Parameters (known to everyone)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-104" name="__codelineno-35-104" href="#__codelineno-35-104"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-105" name="__codelineno-35-105" href="#__codelineno-35-105"></a>
<a id="__codelineno-35-106" name="__codelineno-35-106" href="#__codelineno-35-106"></a>    <span class="c1"># Using small numbers for clarity (in production, use 2048-bit)</span>
<a id="__codelineno-35-107" name="__codelineno-35-107" href="#__codelineno-35-107"></a>    <span class="n">alice</span> <span class="o">=</span> <span class="n">DiffieHellman</span><span class="p">(</span><span class="n">key_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>  <span class="c1"># Toy example</span>
<a id="__codelineno-35-108" name="__codelineno-35-108" href="#__codelineno-35-108"></a>    <span class="n">bob</span> <span class="o">=</span> <span class="n">DiffieHellman</span><span class="p">(</span><span class="n">key_size</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
<a id="__codelineno-35-109" name="__codelineno-35-109" href="#__codelineno-35-109"></a>
<a id="__codelineno-35-110" name="__codelineno-35-110" href="#__codelineno-35-110"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prime (p):     </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-111" name="__codelineno-35-111" href="#__codelineno-35-111"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generator (g): </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-112" name="__codelineno-35-112" href="#__codelineno-35-112"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  These are PUBLIC - even attackers know them!&quot;</span><span class="p">)</span>
<a id="__codelineno-35-113" name="__codelineno-35-113" href="#__codelineno-35-113"></a>
<a id="__codelineno-35-114" name="__codelineno-35-114" href="#__codelineno-35-114"></a>    <span class="c1"># </span>
<a id="__codelineno-35-115" name="__codelineno-35-115" href="#__codelineno-35-115"></a>    <span class="c1"># STEP 2: Generate Private Keys (secret)</span>
<a id="__codelineno-35-116" name="__codelineno-35-116" href="#__codelineno-35-116"></a>    <span class="c1"># </span>
<a id="__codelineno-35-117" name="__codelineno-35-117" href="#__codelineno-35-117"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 2: Generate Private Keys (SECRET - never shared)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-118" name="__codelineno-35-118" href="#__codelineno-35-118"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-119" name="__codelineno-35-119" href="#__codelineno-35-119"></a>
<a id="__codelineno-35-120" name="__codelineno-35-120" href="#__codelineno-35-120"></a>    <span class="n">alice_private</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-35-121" name="__codelineno-35-121" href="#__codelineno-35-121"></a>    <span class="n">bob_private</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-35-122" name="__codelineno-35-122" href="#__codelineno-35-122"></a>
<a id="__codelineno-35-123" name="__codelineno-35-123" href="#__codelineno-35-123"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alice&#39;s private key (a): </span><span class="si">{</span><span class="n">alice_private</span><span class="si">}</span><span class="s2"> (SECRET!)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-124" name="__codelineno-35-124" href="#__codelineno-35-124"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bob&#39;s private key (b):   </span><span class="si">{</span><span class="n">bob_private</span><span class="si">}</span><span class="s2"> (SECRET!)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-125" name="__codelineno-35-125" href="#__codelineno-35-125"></a>
<a id="__codelineno-35-126" name="__codelineno-35-126" href="#__codelineno-35-126"></a>    <span class="c1"># </span>
<a id="__codelineno-35-127" name="__codelineno-35-127" href="#__codelineno-35-127"></a>    <span class="c1"># STEP 3: Compute Public Keys</span>
<a id="__codelineno-35-128" name="__codelineno-35-128" href="#__codelineno-35-128"></a>    <span class="c1"># </span>
<a id="__codelineno-35-129" name="__codelineno-35-129" href="#__codelineno-35-129"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 3: Compute Public Keys (safe to share)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-130" name="__codelineno-35-130" href="#__codelineno-35-130"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-131" name="__codelineno-35-131" href="#__codelineno-35-131"></a>
<a id="__codelineno-35-132" name="__codelineno-35-132" href="#__codelineno-35-132"></a>    <span class="n">alice_public</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">generate_public_key</span><span class="p">()</span>
<a id="__codelineno-35-133" name="__codelineno-35-133" href="#__codelineno-35-133"></a>    <span class="n">bob_public</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">generate_public_key</span><span class="p">()</span>
<a id="__codelineno-35-134" name="__codelineno-35-134" href="#__codelineno-35-134"></a>
<a id="__codelineno-35-135" name="__codelineno-35-135" href="#__codelineno-35-135"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alice computes: A = g^a mod p = </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">g</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">alice_private</span><span class="si">}</span><span class="s2"> mod </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">alice_public</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-136" name="__codelineno-35-136" href="#__codelineno-35-136"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bob computes:   B = g^b mod p = </span><span class="si">{</span><span class="n">bob</span><span class="o">.</span><span class="n">g</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">bob_private</span><span class="si">}</span><span class="s2"> mod </span><span class="si">{</span><span class="n">bob</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">bob_public</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-137" name="__codelineno-35-137" href="#__codelineno-35-137"></a>
<a id="__codelineno-35-138" name="__codelineno-35-138" href="#__codelineno-35-138"></a>    <span class="c1"># </span>
<a id="__codelineno-35-139" name="__codelineno-35-139" href="#__codelineno-35-139"></a>    <span class="c1"># STEP 4: Exchange Public Keys</span>
<a id="__codelineno-35-140" name="__codelineno-35-140" href="#__codelineno-35-140"></a>    <span class="c1"># </span>
<a id="__codelineno-35-141" name="__codelineno-35-141" href="#__codelineno-35-141"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 4: Exchange Public Keys (over insecure channel)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-142" name="__codelineno-35-142" href="#__codelineno-35-142"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-143" name="__codelineno-35-143" href="#__codelineno-35-143"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alice sends to Bob:  A = </span><span class="si">{</span><span class="n">alice_public</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-144" name="__codelineno-35-144" href="#__codelineno-35-144"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bob sends to Alice:  B = </span><span class="si">{</span><span class="n">bob_public</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-145" name="__codelineno-35-145" href="#__codelineno-35-145"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Attacker can intercept these values!&quot;</span><span class="p">)</span>
<a id="__codelineno-35-146" name="__codelineno-35-146" href="#__codelineno-35-146"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; But cannot derive private keys (discrete log problem)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-147" name="__codelineno-35-147" href="#__codelineno-35-147"></a>
<a id="__codelineno-35-148" name="__codelineno-35-148" href="#__codelineno-35-148"></a>    <span class="c1"># </span>
<a id="__codelineno-35-149" name="__codelineno-35-149" href="#__codelineno-35-149"></a>    <span class="c1"># STEP 5: Compute Shared Secret</span>
<a id="__codelineno-35-150" name="__codelineno-35-150" href="#__codelineno-35-150"></a>    <span class="c1"># </span>
<a id="__codelineno-35-151" name="__codelineno-35-151" href="#__codelineno-35-151"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 5: Compute Shared Secret (independently)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-152" name="__codelineno-35-152" href="#__codelineno-35-152"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-153" name="__codelineno-35-153" href="#__codelineno-35-153"></a>
<a id="__codelineno-35-154" name="__codelineno-35-154" href="#__codelineno-35-154"></a>    <span class="n">alice_shared</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">compute_shared_secret</span><span class="p">(</span><span class="n">bob_public</span><span class="p">)</span>
<a id="__codelineno-35-155" name="__codelineno-35-155" href="#__codelineno-35-155"></a>    <span class="n">bob_shared</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">compute_shared_secret</span><span class="p">(</span><span class="n">alice_public</span><span class="p">)</span>
<a id="__codelineno-35-156" name="__codelineno-35-156" href="#__codelineno-35-156"></a>
<a id="__codelineno-35-157" name="__codelineno-35-157" href="#__codelineno-35-157"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alice computes: s = B^a mod p = </span><span class="si">{</span><span class="n">bob_public</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">alice_private</span><span class="si">}</span><span class="s2"> mod </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">alice_shared</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-158" name="__codelineno-35-158" href="#__codelineno-35-158"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bob computes:   s = A^b mod p = </span><span class="si">{</span><span class="n">alice_public</span><span class="si">}</span><span class="s2">^</span><span class="si">{</span><span class="n">bob_private</span><span class="si">}</span><span class="s2"> mod </span><span class="si">{</span><span class="n">bob</span><span class="o">.</span><span class="n">p</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">bob_shared</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-159" name="__codelineno-35-159" href="#__codelineno-35-159"></a>
<a id="__codelineno-35-160" name="__codelineno-35-160" href="#__codelineno-35-160"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> SUCCESS: Both computed the same secret!&quot;</span><span class="p">)</span>
<a id="__codelineno-35-161" name="__codelineno-35-161" href="#__codelineno-35-161"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Alice&#39;s shared secret: </span><span class="si">{</span><span class="n">alice_shared</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-162" name="__codelineno-35-162" href="#__codelineno-35-162"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Bob&#39;s shared secret:   </span><span class="si">{</span><span class="n">bob_shared</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-163" name="__codelineno-35-163" href="#__codelineno-35-163"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Secrets match: </span><span class="si">{</span><span class="n">alice_shared</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bob_shared</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
<a id="__codelineno-35-164" name="__codelineno-35-164" href="#__codelineno-35-164"></a>
<a id="__codelineno-35-165" name="__codelineno-35-165" href="#__codelineno-35-165"></a>    <span class="c1"># </span>
<a id="__codelineno-35-166" name="__codelineno-35-166" href="#__codelineno-35-166"></a>    <span class="c1"># STEP 6: Derive Encryption Key</span>
<a id="__codelineno-35-167" name="__codelineno-35-167" href="#__codelineno-35-167"></a>    <span class="c1"># </span>
<a id="__codelineno-35-168" name="__codelineno-35-168" href="#__codelineno-35-168"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 6: Derive AES Encryption Key&quot;</span><span class="p">)</span>
<a id="__codelineno-35-169" name="__codelineno-35-169" href="#__codelineno-35-169"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-170" name="__codelineno-35-170" href="#__codelineno-35-170"></a>
<a id="__codelineno-35-171" name="__codelineno-35-171" href="#__codelineno-35-171"></a>    <span class="n">alice_aes_key</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">derive_key</span><span class="p">()</span>
<a id="__codelineno-35-172" name="__codelineno-35-172" href="#__codelineno-35-172"></a>    <span class="n">bob_aes_key</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">derive_key</span><span class="p">()</span>
<a id="__codelineno-35-173" name="__codelineno-35-173" href="#__codelineno-35-173"></a>
<a id="__codelineno-35-174" name="__codelineno-35-174" href="#__codelineno-35-174"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alice derives AES key: </span><span class="si">{</span><span class="n">alice_aes_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-35-175" name="__codelineno-35-175" href="#__codelineno-35-175"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bob derives AES key:   </span><span class="si">{</span><span class="n">bob_aes_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-35-176" name="__codelineno-35-176" href="#__codelineno-35-176"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Keys match: </span><span class="si">{</span><span class="n">alice_aes_key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bob_aes_key</span><span class="si">}</span><span class="s2"> &quot;</span><span class="p">)</span>
<a id="__codelineno-35-177" name="__codelineno-35-177" href="#__codelineno-35-177"></a>
<a id="__codelineno-35-178" name="__codelineno-35-178" href="#__codelineno-35-178"></a>    <span class="c1"># </span>
<a id="__codelineno-35-179" name="__codelineno-35-179" href="#__codelineno-35-179"></a>    <span class="c1"># STEP 7: Secure Communication with AES</span>
<a id="__codelineno-35-180" name="__codelineno-35-180" href="#__codelineno-35-180"></a>    <span class="c1"># </span>
<a id="__codelineno-35-181" name="__codelineno-35-181" href="#__codelineno-35-181"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> STEP 7: Secure Communication (using shared AES key)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-182" name="__codelineno-35-182" href="#__codelineno-35-182"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-183" name="__codelineno-35-183" href="#__codelineno-35-183"></a>
<a id="__codelineno-35-184" name="__codelineno-35-184" href="#__codelineno-35-184"></a>    <span class="c1"># Alice encrypts message</span>
<a id="__codelineno-35-185" name="__codelineno-35-185" href="#__codelineno-35-185"></a>    <span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Hello Bob! This is a secret message.&quot;</span>
<a id="__codelineno-35-186" name="__codelineno-35-186" href="#__codelineno-35-186"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Alice&#39;s plaintext: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-187" name="__codelineno-35-187" href="#__codelineno-35-187"></a>
<a id="__codelineno-35-188" name="__codelineno-35-188" href="#__codelineno-35-188"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">alice_aes_key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">)</span>
<a id="__codelineno-35-189" name="__codelineno-35-189" href="#__codelineno-35-189"></a>    <span class="n">ciphertext</span><span class="p">,</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">encrypt_and_digest</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a id="__codelineno-35-190" name="__codelineno-35-190" href="#__codelineno-35-190"></a>    <span class="n">nonce</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">nonce</span>
<a id="__codelineno-35-191" name="__codelineno-35-191" href="#__codelineno-35-191"></a>
<a id="__codelineno-35-192" name="__codelineno-35-192" href="#__codelineno-35-192"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted: </span><span class="si">{</span><span class="n">ciphertext</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-35-193" name="__codelineno-35-193" href="#__codelineno-35-193"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Nonce:     </span><span class="si">{</span><span class="n">nonce</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-194" name="__codelineno-35-194" href="#__codelineno-35-194"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tag:       </span><span class="si">{</span><span class="n">tag</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-195" name="__codelineno-35-195" href="#__codelineno-35-195"></a>
<a id="__codelineno-35-196" name="__codelineno-35-196" href="#__codelineno-35-196"></a>    <span class="c1"># Bob decrypts message</span>
<a id="__codelineno-35-197" name="__codelineno-35-197" href="#__codelineno-35-197"></a>    <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">bob_aes_key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_GCM</span><span class="p">,</span> <span class="n">nonce</span><span class="o">=</span><span class="n">nonce</span><span class="p">)</span>
<a id="__codelineno-35-198" name="__codelineno-35-198" href="#__codelineno-35-198"></a>    <span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt_and_verify</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
<a id="__codelineno-35-199" name="__codelineno-35-199" href="#__codelineno-35-199"></a>
<a id="__codelineno-35-200" name="__codelineno-35-200" href="#__codelineno-35-200"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bob decrypts: </span><span class="si">{</span><span class="n">decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-201" name="__codelineno-35-201" href="#__codelineno-35-201"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Message successfully exchanged over insecure channel!&quot;</span><span class="p">)</span>
<a id="__codelineno-35-202" name="__codelineno-35-202" href="#__codelineno-35-202"></a>
<a id="__codelineno-35-203" name="__codelineno-35-203" href="#__codelineno-35-203"></a>    <span class="c1"># </span>
<a id="__codelineno-35-204" name="__codelineno-35-204" href="#__codelineno-35-204"></a>    <span class="c1"># Security Analysis</span>
<a id="__codelineno-35-205" name="__codelineno-35-205" href="#__codelineno-35-205"></a>    <span class="c1"># </span>
<a id="__codelineno-35-206" name="__codelineno-35-206" href="#__codelineno-35-206"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-207" name="__codelineno-35-207" href="#__codelineno-35-207"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SECURITY ANALYSIS&quot;</span><span class="p">)</span>
<a id="__codelineno-35-208" name="__codelineno-35-208" href="#__codelineno-35-208"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-209" name="__codelineno-35-209" href="#__codelineno-35-209"></a>
<a id="__codelineno-35-210" name="__codelineno-35-210" href="#__codelineno-35-210"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-35-211" name="__codelineno-35-211" href="#__codelineno-35-211"></a><span class="s2">    WHAT ATTACKER KNOWS:</span>
<a id="__codelineno-35-212" name="__codelineno-35-212" href="#__codelineno-35-212"></a><span class="s2">     Prime (p): </span><span class="si">{p}</span>
<a id="__codelineno-35-213" name="__codelineno-35-213" href="#__codelineno-35-213"></a><span class="s2">     Generator (g): </span><span class="si">{g}</span>
<a id="__codelineno-35-214" name="__codelineno-35-214" href="#__codelineno-35-214"></a><span class="s2">     Alice&#39;s public (A): </span><span class="si">{A}</span>
<a id="__codelineno-35-215" name="__codelineno-35-215" href="#__codelineno-35-215"></a><span class="s2">     Bob&#39;s public (B): </span><span class="si">{B}</span>
<a id="__codelineno-35-216" name="__codelineno-35-216" href="#__codelineno-35-216"></a>
<a id="__codelineno-35-217" name="__codelineno-35-217" href="#__codelineno-35-217"></a><span class="s2">    WHAT ATTACKER NEEDS:</span>
<a id="__codelineno-35-218" name="__codelineno-35-218" href="#__codelineno-35-218"></a><span class="s2">     Alice&#39;s private (a) OR Bob&#39;s private (b)</span>
<a id="__codelineno-35-219" name="__codelineno-35-219" href="#__codelineno-35-219"></a>
<a id="__codelineno-35-220" name="__codelineno-35-220" href="#__codelineno-35-220"></a><span class="s2">    THE CHALLENGE:</span>
<a id="__codelineno-35-221" name="__codelineno-35-221" href="#__codelineno-35-221"></a><span class="s2">    Given: A = g^a mod p</span>
<a id="__codelineno-35-222" name="__codelineno-35-222" href="#__codelineno-35-222"></a><span class="s2">    Find: a</span>
<a id="__codelineno-35-223" name="__codelineno-35-223" href="#__codelineno-35-223"></a>
<a id="__codelineno-35-224" name="__codelineno-35-224" href="#__codelineno-35-224"></a><span class="s2">    For small numbers (p=23): Easy to brute force</span>
<a id="__codelineno-35-225" name="__codelineno-35-225" href="#__codelineno-35-225"></a><span class="s2">    For large numbers (2048-bit p): Computationally infeasible!</span>
<a id="__codelineno-35-226" name="__codelineno-35-226" href="#__codelineno-35-226"></a>
<a id="__codelineno-35-227" name="__codelineno-35-227" href="#__codelineno-35-227"></a><span class="s2">    Time to crack 2048-bit DH: Millions of years with current technology</span>
<a id="__codelineno-35-228" name="__codelineno-35-228" href="#__codelineno-35-228"></a><span class="s2">    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">alice</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">alice</span><span class="o">.</span><span class="n">g</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">alice_public</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">bob_public</span><span class="p">))</span>
<a id="__codelineno-35-229" name="__codelineno-35-229" href="#__codelineno-35-229"></a>
<a id="__codelineno-35-230" name="__codelineno-35-230" href="#__codelineno-35-230"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-231" name="__codelineno-35-231" href="#__codelineno-35-231"></a>
<a id="__codelineno-35-232" name="__codelineno-35-232" href="#__codelineno-35-232"></a>
<a id="__codelineno-35-233" name="__codelineno-35-233" href="#__codelineno-35-233"></a><span class="k">def</span><span class="w"> </span><span class="nf">production_example</span><span class="p">():</span>
<a id="__codelineno-35-234" name="__codelineno-35-234" href="#__codelineno-35-234"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-35-235" name="__codelineno-35-235" href="#__codelineno-35-235"></a><span class="sd">    Production-ready Diffie-Hellman with 2048-bit keys</span>
<a id="__codelineno-35-236" name="__codelineno-35-236" href="#__codelineno-35-236"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-35-237" name="__codelineno-35-237" href="#__codelineno-35-237"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-238" name="__codelineno-35-238" href="#__codelineno-35-238"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PRODUCTION EXAMPLE (2048-bit keys)&quot;</span><span class="p">)</span>
<a id="__codelineno-35-239" name="__codelineno-35-239" href="#__codelineno-35-239"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-35-240" name="__codelineno-35-240" href="#__codelineno-35-240"></a>
<a id="__codelineno-35-241" name="__codelineno-35-241" href="#__codelineno-35-241"></a>    <span class="c1"># Use secure 2048-bit parameters</span>
<a id="__codelineno-35-242" name="__codelineno-35-242" href="#__codelineno-35-242"></a>    <span class="n">alice</span> <span class="o">=</span> <span class="n">DiffieHellman</span><span class="p">(</span><span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
<a id="__codelineno-35-243" name="__codelineno-35-243" href="#__codelineno-35-243"></a>    <span class="n">bob</span> <span class="o">=</span> <span class="n">DiffieHellman</span><span class="p">(</span><span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">)</span>
<a id="__codelineno-35-244" name="__codelineno-35-244" href="#__codelineno-35-244"></a>
<a id="__codelineno-35-245" name="__codelineno-35-245" href="#__codelineno-35-245"></a>    <span class="c1"># Generate keys</span>
<a id="__codelineno-35-246" name="__codelineno-35-246" href="#__codelineno-35-246"></a>    <span class="n">alice</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-35-247" name="__codelineno-35-247" href="#__codelineno-35-247"></a>    <span class="n">alice</span><span class="o">.</span><span class="n">generate_public_key</span><span class="p">()</span>
<a id="__codelineno-35-248" name="__codelineno-35-248" href="#__codelineno-35-248"></a>
<a id="__codelineno-35-249" name="__codelineno-35-249" href="#__codelineno-35-249"></a>    <span class="n">bob</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">()</span>
<a id="__codelineno-35-250" name="__codelineno-35-250" href="#__codelineno-35-250"></a>    <span class="n">bob</span><span class="o">.</span><span class="n">generate_public_key</span><span class="p">()</span>
<a id="__codelineno-35-251" name="__codelineno-35-251" href="#__codelineno-35-251"></a>
<a id="__codelineno-35-252" name="__codelineno-35-252" href="#__codelineno-35-252"></a>    <span class="c1"># Exchange and compute shared secret</span>
<a id="__codelineno-35-253" name="__codelineno-35-253" href="#__codelineno-35-253"></a>    <span class="n">alice</span><span class="o">.</span><span class="n">compute_shared_secret</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-35-254" name="__codelineno-35-254" href="#__codelineno-35-254"></a>    <span class="n">bob</span><span class="o">.</span><span class="n">compute_shared_secret</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">public_key</span><span class="p">)</span>
<a id="__codelineno-35-255" name="__codelineno-35-255" href="#__codelineno-35-255"></a>
<a id="__codelineno-35-256" name="__codelineno-35-256" href="#__codelineno-35-256"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Secure 2048-bit Diffie-Hellman key exchange complete&quot;</span><span class="p">)</span>
<a id="__codelineno-35-257" name="__codelineno-35-257" href="#__codelineno-35-257"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Prime size: </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>
<a id="__codelineno-35-258" name="__codelineno-35-258" href="#__codelineno-35-258"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Shared secret size: </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">shared_secret</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>
<a id="__codelineno-35-259" name="__codelineno-35-259" href="#__codelineno-35-259"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Secrets match: </span><span class="si">{</span><span class="n">alice</span><span class="o">.</span><span class="n">shared_secret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bob</span><span class="o">.</span><span class="n">shared_secret</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-35-260" name="__codelineno-35-260" href="#__codelineno-35-260"></a>
<a id="__codelineno-35-261" name="__codelineno-35-261" href="#__codelineno-35-261"></a>    <span class="c1"># Derive AES key</span>
<a id="__codelineno-35-262" name="__codelineno-35-262" href="#__codelineno-35-262"></a>    <span class="n">aes_key</span> <span class="o">=</span> <span class="n">alice</span><span class="o">.</span><span class="n">derive_key</span><span class="p">()</span>
<a id="__codelineno-35-263" name="__codelineno-35-263" href="#__codelineno-35-263"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   AES-256 key: </span><span class="si">{</span><span class="n">aes_key</span><span class="o">.</span><span class="n">hex</span><span class="p">()[:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-35-264" name="__codelineno-35-264" href="#__codelineno-35-264"></a>
<a id="__codelineno-35-265" name="__codelineno-35-265" href="#__codelineno-35-265"></a>
<a id="__codelineno-35-266" name="__codelineno-35-266" href="#__codelineno-35-266"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-35-267" name="__codelineno-35-267" href="#__codelineno-35-267"></a>    <span class="c1"># Run demonstration</span>
<a id="__codelineno-35-268" name="__codelineno-35-268" href="#__codelineno-35-268"></a>    <span class="n">demonstrate_diffie_hellman</span><span class="p">()</span>
<a id="__codelineno-35-269" name="__codelineno-35-269" href="#__codelineno-35-269"></a>
<a id="__codelineno-35-270" name="__codelineno-35-270" href="#__codelineno-35-270"></a>    <span class="c1"># Show production example</span>
<a id="__codelineno-35-271" name="__codelineno-35-271" href="#__codelineno-35-271"></a>    <span class="n">production_example</span><span class="p">()</span>
</code></pre></div>
<p><strong>Output:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>======================================================================
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>DIFFIE-HELLMAN KEY EXCHANGE DEMONSTRATION
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>======================================================================
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a> STEP 1: Public Parameters (known to everyone)
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>Prime (p):     23
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>Generator (g): 5
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>  These are PUBLIC - even attackers know them!
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a> STEP 2: Generate Private Keys (SECRET - never shared)
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>Alice&#39;s private key (a): 6 (SECRET!)
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>Bob&#39;s private key (b):   15 (SECRET!)
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a> STEP 3: Compute Public Keys (safe to share)
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>Alice computes: A = g^a mod p = 5^6 mod 23 = 8
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>Bob computes:   B = g^b mod p = 5^15 mod 23 = 19
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a> STEP 4: Exchange Public Keys (over insecure channel)
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>Alice sends to Bob:  A = 8
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>Bob sends to Alice:  B = 19
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a>  Attacker can intercept these values!
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a> But cannot derive private keys (discrete log problem)
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a> STEP 5: Compute Shared Secret (independently)
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a>
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a>Alice computes: s = B^a mod p = 19^6 mod 23 = 2
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a>Bob computes:   s = A^b mod p = 8^15 mod 23 = 2
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a> SUCCESS: Both computed the same secret!
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a>   Alice&#39;s shared secret: 2
<a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a>   Bob&#39;s shared secret:   2
<a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a>   Secrets match: True 
<a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a>
<a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a> STEP 6: Derive AES Encryption Key
<a id="__codelineno-36-39" name="__codelineno-36-39" href="#__codelineno-36-39"></a>
<a id="__codelineno-36-40" name="__codelineno-36-40" href="#__codelineno-36-40"></a>Alice derives AES key: f2ca1bb6c7e907d06dafe4687e579fce76b37e...
<a id="__codelineno-36-41" name="__codelineno-36-41" href="#__codelineno-36-41"></a>Bob derives AES key:   f2ca1bb6c7e907d06dafe4687e579fce76b37e...
<a id="__codelineno-36-42" name="__codelineno-36-42" href="#__codelineno-36-42"></a>Keys match: True 
<a id="__codelineno-36-43" name="__codelineno-36-43" href="#__codelineno-36-43"></a>
<a id="__codelineno-36-44" name="__codelineno-36-44" href="#__codelineno-36-44"></a> STEP 7: Secure Communication (using shared AES key)
<a id="__codelineno-36-45" name="__codelineno-36-45" href="#__codelineno-36-45"></a>
<a id="__codelineno-36-46" name="__codelineno-36-46" href="#__codelineno-36-46"></a>Alice&#39;s plaintext: Hello Bob! This is a secret message.
<a id="__codelineno-36-47" name="__codelineno-36-47" href="#__codelineno-36-47"></a>Encrypted: 7f8e3a2d9c1b4f6a8e5d3c7b2a9f1e4d8c6b5a...
<a id="__codelineno-36-48" name="__codelineno-36-48" href="#__codelineno-36-48"></a>Nonce:     a3f2e1d9c8b7a6f5
<a id="__codelineno-36-49" name="__codelineno-36-49" href="#__codelineno-36-49"></a>Tag:       9e2d4c7a1b8f6e3d
<a id="__codelineno-36-50" name="__codelineno-36-50" href="#__codelineno-36-50"></a>
<a id="__codelineno-36-51" name="__codelineno-36-51" href="#__codelineno-36-51"></a>Bob decrypts: Hello Bob! This is a secret message.
<a id="__codelineno-36-52" name="__codelineno-36-52" href="#__codelineno-36-52"></a> Message successfully exchanged over insecure channel!
</code></pre></div></p>
<p><strong>Key Takeaways:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a> DIFFIE-HELLMAN SOLVES:
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>1. Key Distribution Problem
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>    No need to share secret key beforehand
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>    Works over completely insecure channels
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>2. Perfect Forward Secrecy
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>    Each session uses ephemeral (temporary) keys
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>    Compromising one session doesn&#39;t affect others
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>3. Enables Hybrid Encryption
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>    DH: Slow, establishes shared secret
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a>    AES: Fast, encrypts actual data
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>    Best of both worlds!
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a>  IMPORTANT NOTES:
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a>
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a>1. Vulnerable to Man-in-the-Middle (MITM) attacks
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a>    Solution: Combine with authentication (digital signatures)
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a>    Example: TLS uses DH + certificates
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a>
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a>2. Not an Encryption Algorithm
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a>    Only for key exchange
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a>    Must use with symmetric cipher (AES)
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a>
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a>3. Quantum Threat
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a>    Shor&#39;s algorithm can break DH on quantum computers
<a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a>    Post-quantum alternatives being developed
<a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a>
<a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a> REAL-WORLD USAGE:
<a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a>
<a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a> TLS/HTTPS: Every secure website
<a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a> SSH: Secure remote access
<a id="__codelineno-37-34" name="__codelineno-37-34" href="#__codelineno-37-34"></a> VPN: IPSec, WireGuard
<a id="__codelineno-37-35" name="__codelineno-37-35" href="#__codelineno-37-35"></a> Signal/WhatsApp: End-to-end encryption
<a id="__codelineno-37-36" name="__codelineno-37-36" href="#__codelineno-37-36"></a> Bitcoin/Blockchain: Key agreement
</code></pre></div>
<h3 id="asymmetric-encryption-public-key-cryptography">Asymmetric Encryption (Public Key Cryptography)</h3>
<p><strong>Definition</strong>: Encryption method that uses <strong>two different keys</strong>: a public key (for encryption) and a private key (for decryption).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>              Asymmetric Encryption                           
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>                    RECEIVER GENERATES KEY PAIR
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>                    
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>                    
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>                        Key Generator     
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>                    
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>                               
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>                
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>                                             
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>                       
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>            Public                    Private    
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>             Key                        Key      
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>          (Share)                   (Keep Secret)
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>                       
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>                                            
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a>                 Shared publicly             Never shared
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a>                                            
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a>                                            
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a>                   
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>      SENDER                               
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>                                           
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a>  Plaintext: &quot;Hello&quot;                       
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a>       +                                   
<a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a>  Public Key (Receiver)                    
<a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a>                                          
<a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a>  Encryption Algorithm                     
<a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a>                                          
<a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a>  Ciphertext:&quot;xK9#mP2$&quot;                    
<a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a>                   
<a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a>                                            
<a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a>             Send ciphertext                
<a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a>                                            
<a id="__codelineno-38-36" name="__codelineno-38-36" href="#__codelineno-38-36"></a>            
<a id="__codelineno-38-37" name="__codelineno-38-37" href="#__codelineno-38-37"></a>                         
<a id="__codelineno-38-38" name="__codelineno-38-38" href="#__codelineno-38-38"></a>                
<a id="__codelineno-38-39" name="__codelineno-38-39" href="#__codelineno-38-39"></a>                    TRANSMISSION     
<a id="__codelineno-38-40" name="__codelineno-38-40" href="#__codelineno-38-40"></a>                   (Over Network)    
<a id="__codelineno-38-41" name="__codelineno-38-41" href="#__codelineno-38-41"></a>                
<a id="__codelineno-38-42" name="__codelineno-38-42" href="#__codelineno-38-42"></a>                         
<a id="__codelineno-38-43" name="__codelineno-38-43" href="#__codelineno-38-43"></a>            
<a id="__codelineno-38-44" name="__codelineno-38-44" href="#__codelineno-38-44"></a>                    RECEIVER             
<a id="__codelineno-38-45" name="__codelineno-38-45" href="#__codelineno-38-45"></a>                                         
<a id="__codelineno-38-46" name="__codelineno-38-46" href="#__codelineno-38-46"></a>              Ciphertext: &quot;xK9#mP2$&quot;     
<a id="__codelineno-38-47" name="__codelineno-38-47" href="#__codelineno-38-47"></a>                     +                   
<a id="__codelineno-38-48" name="__codelineno-38-48" href="#__codelineno-38-48"></a>              Private Key (Receiver)     
<a id="__codelineno-38-49" name="__codelineno-38-49" href="#__codelineno-38-49"></a>                                        
<a id="__codelineno-38-50" name="__codelineno-38-50" href="#__codelineno-38-50"></a>              Decryption Algorithm       
<a id="__codelineno-38-51" name="__codelineno-38-51" href="#__codelineno-38-51"></a>                                        
<a id="__codelineno-38-52" name="__codelineno-38-52" href="#__codelineno-38-52"></a>              Plaintext: &quot;Hello&quot;         
<a id="__codelineno-38-53" name="__codelineno-38-53" href="#__codelineno-38-53"></a>            
<a id="__codelineno-38-54" name="__codelineno-38-54" href="#__codelineno-38-54"></a>
<a id="__codelineno-38-55" name="__codelineno-38-55" href="#__codelineno-38-55"></a>KEY CHARACTERISTICS:
<a id="__codelineno-38-56" name="__codelineno-38-56" href="#__codelineno-38-56"></a>
<a id="__codelineno-38-57" name="__codelineno-38-57" href="#__codelineno-38-57"></a> Public Key: Can be shared with anyone
<a id="__codelineno-38-58" name="__codelineno-38-58" href="#__codelineno-38-58"></a> Private Key: Must be kept secret
<a id="__codelineno-38-59" name="__codelineno-38-59" href="#__codelineno-38-59"></a> Data encrypted with public key can ONLY be decrypted with private key
<a id="__codelineno-38-60" name="__codelineno-38-60" href="#__codelineno-38-60"></a> Mathematically related but computationally infeasible to derive private from public
</code></pre></div>
<h4 id="asymmetric-encryption-algorithms">Asymmetric Encryption Algorithms</h4>
<p><strong>Evolution and Improvements:</strong></p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Key Size</th>
<th>Year</th>
<th>Based On</th>
<th>Status</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>RSA</strong></td>
<td>1024-4096 bit</td>
<td>1977</td>
<td>Factorization</td>
<td> Current Standard</td>
<td>Encryption, Signatures</td>
</tr>
<tr>
<td><strong>DSA</strong></td>
<td>1024-3072 bit</td>
<td>1991</td>
<td>Discrete Log</td>
<td> Digital Signatures</td>
<td>Signatures only</td>
</tr>
<tr>
<td><strong>Diffie-Hellman</strong></td>
<td>2048+ bit</td>
<td>1976</td>
<td>Discrete Log</td>
<td> Key Exchange</td>
<td>Key agreement</td>
</tr>
<tr>
<td><strong>ECC (Elliptic Curve)</strong></td>
<td>256-521 bit</td>
<td>1985</td>
<td>Elliptic Curves</td>
<td> Modern Standard</td>
<td>Encryption, Signatures</td>
</tr>
<tr>
<td><strong>ECDSA</strong></td>
<td>256-521 bit</td>
<td>1992</td>
<td>ECC</td>
<td> Modern</td>
<td>Digital Signatures</td>
</tr>
<tr>
<td><strong>EdDSA</strong></td>
<td>255 bit</td>
<td>2011</td>
<td>ECC</td>
<td> Best Performance</td>
<td>Modern Signatures</td>
</tr>
<tr>
<td><strong>El Gamal</strong></td>
<td>1024+ bit</td>
<td>1985</td>
<td>Discrete Log</td>
<td> Less Common</td>
<td>Encryption</td>
</tr>
</tbody>
</table>
<p><strong>Modern Algorithm: ECC (Elliptic Curve Cryptography)</strong></p>
<p><strong>Advantages of ECC over RSA:</strong>
-  <strong>Smaller Keys</strong>: 256-bit ECC  3072-bit RSA (same security)
-  <strong>Faster</strong>: Quicker key generation and signing
-  <strong>Less Bandwidth</strong>: Smaller certificates and signatures
-  <strong>Mobile Friendly</strong>: Lower CPU and power consumption
-  <strong>Future Proof</strong>: Better resistance to quantum attacks (relatively)
-  <strong>NSA Approved</strong>: Suite B cryptography</p>
<p><strong>Key Size Comparison:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Security Level:    80-bit   112-bit   128-bit   192-bit   256-bit
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>RSA Key Size:      1024     2048      3072      7680      15360
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>ECC Key Size:      160      224       256       384       512
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>DH Key Size:       1024     2048      3072      7680      15360
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>Example: Same security, much smaller!
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>   RSA-3072:   (3072 bits)
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>   ECC-256:    (256 bits)
</code></pre></div></p>
<p><strong>Modern Algorithms:</strong>
- <strong>Ed25519</strong> (EdDSA): Modern, fast, secure signatures (SSH, TLS 1.3)
- <strong>X25519</strong> (ECDH): Modern key exchange (Signal, WhatsApp)
- <strong>P-256</strong> (NIST): Widely supported ECC curve
- <strong>RSA-2048/4096</strong>: Still widely used, reliable</p>
<h4 id="asymmetric-encryption-use-cases">Asymmetric Encryption Use Cases</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a> RECOMMENDED USE CASES:
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>1. SECURE KEY EXCHANGE
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>                             
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>     Alice     Encrypt session key        Bob    
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>                       
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>               using Bob&#39;s public key            
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>                             
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a>   Problem: How to share symmetric key securely?
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>   Solution: Encrypt symmetric key with public key!
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>2. DIGITAL SIGNATURES
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a>   
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>      Document   
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a>         +             Prove authenticity
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a>    Private Key        Non-repudiation
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a>                      Verify with public key
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a>     Signature   
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a>   
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a>3. SSL/TLS HANDSHAKE
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a>   Client  Server
<a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a>          Request server&#39;s public key
<a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a>   Client  Server
<a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a>          Send public key (in certificate)
<a id="__codelineno-40-28" name="__codelineno-40-28" href="#__codelineno-40-28"></a>   Client  Server
<a id="__codelineno-40-29" name="__codelineno-40-29" href="#__codelineno-40-29"></a>          Send encrypted session key
<a id="__codelineno-40-30" name="__codelineno-40-30" href="#__codelineno-40-30"></a>
<a id="__codelineno-40-31" name="__codelineno-40-31" href="#__codelineno-40-31"></a>4. EMAIL ENCRYPTION (PGP/S/MIME)
<a id="__codelineno-40-32" name="__codelineno-40-32" href="#__codelineno-40-32"></a>   Sender  Encrypt with recipient&#39;s public key
<a id="__codelineno-40-33" name="__codelineno-40-33" href="#__codelineno-40-33"></a>           Send encrypted email
<a id="__codelineno-40-34" name="__codelineno-40-34" href="#__codelineno-40-34"></a>   Recipient  Decrypt with own private key
<a id="__codelineno-40-35" name="__codelineno-40-35" href="#__codelineno-40-35"></a>
<a id="__codelineno-40-36" name="__codelineno-40-36" href="#__codelineno-40-36"></a>5. CODE SIGNING
<a id="__codelineno-40-37" name="__codelineno-40-37" href="#__codelineno-40-37"></a>   Developer  Sign software with private key
<a id="__codelineno-40-38" name="__codelineno-40-38" href="#__codelineno-40-38"></a>   User  Verify with developer&#39;s public key
<a id="__codelineno-40-39" name="__codelineno-40-39" href="#__codelineno-40-39"></a>
<a id="__codelineno-40-40" name="__codelineno-40-40" href="#__codelineno-40-40"></a>6. CRYPTOCURRENCY
<a id="__codelineno-40-41" name="__codelineno-40-41" href="#__codelineno-40-41"></a>   Private Key  Sign transactions
<a id="__codelineno-40-42" name="__codelineno-40-42" href="#__codelineno-40-42"></a>   Public Key  Verify ownership (wallet address)
</code></pre></div>
<p><strong>Advantages:</strong>
-  <strong>Key Distribution</strong>: No need to share secret keys
-  <strong>Scalability</strong>: Each user needs only one key pair
-  <strong>Digital Signatures</strong>: Provides authentication and non-repudiation
-  <strong>Security</strong>: Private key never needs to be transmitted</p>
<p><strong>Disadvantages:</strong>
-  <strong>Slow</strong>: 100-1000x slower than symmetric encryption
-  <strong>Resource Intensive</strong>: Higher CPU usage
-  <strong>Limited Data</strong>: Not suitable for bulk data encryption
-  <strong>Key Size</strong>: Larger keys needed for same security level (RSA)</p>
<h3 id="comparison-symmetric-vs-asymmetric">Comparison: Symmetric vs Asymmetric</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>         Symmetric vs Asymmetric Encryption                   
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>Feature             Symmetric           Asymmetric
<a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>
<a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>Keys                1 (shared)          2 (public + private)
<a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>Speed                Very Fast          Slow (100-1000x)
<a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>Key Size            128-256 bits        2048-4096 bits (RSA)
<a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>                                        256-521 bits (ECC)
<a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a>Key Distribution     Difficult          Easy
<a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>Use Case            Bulk data           Key exchange, signatures
<a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a>Examples            AES, ChaCha20       RSA, ECC, Ed25519
<a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>Scalability          Poor (n keys)     Good (2n keys)
<a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a>Security            Strong with         Strong, math-based
<a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>                    large key
<a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>CPU Usage           Low                 High
<a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>Power               Efficient           Power-hungry
<a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a>
<a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a>HYBRID APPROACH (Best Practice):
<a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a>
<a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a>1. Use asymmetric encryption to exchange symmetric key
<a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a>2. Use symmetric encryption for actual data
<a id="__codelineno-41-24" name="__codelineno-41-24" href="#__codelineno-41-24"></a>3. Get benefits of both: Security + Performance
</code></pre></div>
<h3 id="https-secure-http">HTTPS: Secure HTTP</h3>
<p><strong>What is HTTPS?</strong></p>
<p>HTTPS (Hypertext Transfer Protocol Secure) is HTTP with encryption, authentication, and integrity protection. It uses <strong>TLS (Transport Layer Security)</strong>, formerly SSL, to secure the connection.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>                HTTP vs HTTPS                                 
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>HTTP (Insecure):
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>Browser                          Server
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>                                   
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>     GET /login.html (plaintext)  
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>   
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>                                   
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>     username=alice&amp;pass=123       
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a>   
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a>         (Visible to attackers!)   
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a>    No Encryption
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a>    No Authentication
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a>    No Integrity
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a>HTTPS (Secure):
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a>Browser                          Server
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a>                                   
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a>     1. TLS Handshake              
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a>   
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a>        (Establish encrypted       
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a>         connection)               
<a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a>                                   
<a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a>     2. Encrypted Request          
<a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a>               
<a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a>   
<a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a>                                   
<a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a>     3. Encrypted Response         
<a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a>               
<a id="__codelineno-42-35" name="__codelineno-42-35" href="#__codelineno-42-35"></a>   
<a id="__codelineno-42-36" name="__codelineno-42-36" href="#__codelineno-42-36"></a>
<a id="__codelineno-42-37" name="__codelineno-42-37" href="#__codelineno-42-37"></a>    Encryption (Confidentiality)
<a id="__codelineno-42-38" name="__codelineno-42-38" href="#__codelineno-42-38"></a>    Authentication (Server identity)
<a id="__codelineno-42-39" name="__codelineno-42-39" href="#__codelineno-42-39"></a>    Integrity (Tamper detection)
</code></pre></div>
<h4 id="https-security-features">HTTPS Security Features</h4>
<p><strong>Three Pillars of HTTPS:</strong></p>
<ol>
<li><strong>Encryption (Confidentiality)</strong></li>
<li>Data is encrypted during transmission</li>
<li>Attackers cannot read the content</li>
<li>
<p>Uses symmetric encryption (AES)</p>
</li>
<li>
<p><strong>Authentication</strong></p>
</li>
<li>Verify server's identity</li>
<li>Prevent man-in-the-middle attacks</li>
<li>
<p>Uses digital certificates</p>
</li>
<li>
<p><strong>Integrity</strong></p>
</li>
<li>Detect if data was tampered</li>
<li>Uses MAC (Message Authentication Code)</li>
<li>Ensures data arrives unchanged</li>
</ol>
<h4 id="tls-handshake-process">TLS Handshake Process</h4>
<p>The TLS handshake establishes a secure connection using both asymmetric and symmetric encryption:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>
<a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>          TLS Handshake (How HTTPS Works)                    
<a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>
<a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>
<a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>CLIENT (Browser)                         SERVER (Web Server)
<a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>                        
<a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
<a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>Step 1: Client Hello
<a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>
<a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a> ClientHello                              
<a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a> - TLS version: 1.3                       
<a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a> - Cipher suites supported                
<a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a> - Random number (Client Random)          
<a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
<a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>                                            
<a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>Step 2: Server Hello                       
<a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>
<a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>                                            ServerHello
<a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a>                                            - TLS version: 1.3
<a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>                                            - Chosen cipher
<a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a>                                            - Random (Server Random)
<a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a>
<a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a>                                           
<a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a>Step 3: Server Certificate                 
<a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a>
<a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a>                                            Certificate
<a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a>                                            
<a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a>                                             Server Cert     
<a id="__codelineno-43-29" name="__codelineno-43-29" href="#__codelineno-43-29"></a>                                             - Domain name   
<a id="__codelineno-43-30" name="__codelineno-43-30" href="#__codelineno-43-30"></a>                                             - Public Key    
<a id="__codelineno-43-31" name="__codelineno-43-31" href="#__codelineno-43-31"></a>  - CA Signature  
<a id="__codelineno-43-32" name="__codelineno-43-32" href="#__codelineno-43-32"></a>                                            
<a id="__codelineno-43-33" name="__codelineno-43-33" href="#__codelineno-43-33"></a> Verify Certificate:                       
<a id="__codelineno-43-34" name="__codelineno-43-34" href="#__codelineno-43-34"></a>  Valid CA signature?                     
<a id="__codelineno-43-35" name="__codelineno-43-35" href="#__codelineno-43-35"></a>  Domain name matches?                    
<a id="__codelineno-43-36" name="__codelineno-43-36" href="#__codelineno-43-36"></a>  Not expired?                            
<a id="__codelineno-43-37" name="__codelineno-43-37" href="#__codelineno-43-37"></a>  Not revoked?                            
<a id="__codelineno-43-38" name="__codelineno-43-38" href="#__codelineno-43-38"></a>                                           
<a id="__codelineno-43-39" name="__codelineno-43-39" href="#__codelineno-43-39"></a>Step 4: Key Exchange (Asymmetric Encryption)
<a id="__codelineno-43-40" name="__codelineno-43-40" href="#__codelineno-43-40"></a>
<a id="__codelineno-43-41" name="__codelineno-43-41" href="#__codelineno-43-41"></a> Generate Pre-Master Secret                
<a id="__codelineno-43-42" name="__codelineno-43-42" href="#__codelineno-43-42"></a> Encrypt with Server&#39;s Public Key          
<a id="__codelineno-43-43" name="__codelineno-43-43" href="#__codelineno-43-43"></a> (from certificate)                         
<a id="__codelineno-43-44" name="__codelineno-43-44" href="#__codelineno-43-44"></a>                                           
<a id="__codelineno-43-45" name="__codelineno-43-45" href="#__codelineno-43-45"></a> Encrypted Pre-Master Secret               
<a id="__codelineno-43-46" name="__codelineno-43-46" href="#__codelineno-43-46"></a>
<a id="__codelineno-43-47" name="__codelineno-43-47" href="#__codelineno-43-47"></a>                                            Decrypt with Private Key
<a id="__codelineno-43-48" name="__codelineno-43-48" href="#__codelineno-43-48"></a>                                           
<a id="__codelineno-43-49" name="__codelineno-43-49" href="#__codelineno-43-49"></a>Both sides now compute Session Keys:       
<a id="__codelineno-43-50" name="__codelineno-43-50" href="#__codelineno-43-50"></a>
<a id="__codelineno-43-51" name="__codelineno-43-51" href="#__codelineno-43-51"></a> Session Key = f(                           Session Key = f(
<a id="__codelineno-43-52" name="__codelineno-43-52" href="#__codelineno-43-52"></a>   Pre-Master Secret,                         Pre-Master Secret,
<a id="__codelineno-43-53" name="__codelineno-43-53" href="#__codelineno-43-53"></a>   Client Random,                             Client Random,
<a id="__codelineno-43-54" name="__codelineno-43-54" href="#__codelineno-43-54"></a>   Server Random                              Server Random
<a id="__codelineno-43-55" name="__codelineno-43-55" href="#__codelineno-43-55"></a> )                                          )
<a id="__codelineno-43-56" name="__codelineno-43-56" href="#__codelineno-43-56"></a>                                           
<a id="__codelineno-43-57" name="__codelineno-43-57" href="#__codelineno-43-57"></a>Step 5: Finished (Switch to Symmetric)
<a id="__codelineno-43-58" name="__codelineno-43-58" href="#__codelineno-43-58"></a>
<a id="__codelineno-43-59" name="__codelineno-43-59" href="#__codelineno-43-59"></a> &quot;Finished&quot; (encrypted with Session Key)   
<a id="__codelineno-43-60" name="__codelineno-43-60" href="#__codelineno-43-60"></a>
<a id="__codelineno-43-61" name="__codelineno-43-61" href="#__codelineno-43-61"></a>                                            Verify
<a id="__codelineno-43-62" name="__codelineno-43-62" href="#__codelineno-43-62"></a>                                           
<a id="__codelineno-43-63" name="__codelineno-43-63" href="#__codelineno-43-63"></a>                                            &quot;Finished&quot;
<a id="__codelineno-43-64" name="__codelineno-43-64" href="#__codelineno-43-64"></a> (encrypted)
<a id="__codelineno-43-65" name="__codelineno-43-65" href="#__codelineno-43-65"></a> Verify                                    
<a id="__codelineno-43-66" name="__codelineno-43-66" href="#__codelineno-43-66"></a>                                           
<a id="__codelineno-43-67" name="__codelineno-43-67" href="#__codelineno-43-67"></a>Step 6: Secure Communication (Symmetric Encryption)
<a id="__codelineno-43-68" name="__codelineno-43-68" href="#__codelineno-43-68"></a>
<a id="__codelineno-43-69" name="__codelineno-43-69" href="#__codelineno-43-69"></a>                   
<a id="__codelineno-43-70" name="__codelineno-43-70" href="#__codelineno-43-70"></a> Application Data (AES Encrypted)          
<a id="__codelineno-43-71" name="__codelineno-43-71" href="#__codelineno-43-71"></a>
<a id="__codelineno-43-72" name="__codelineno-43-72" href="#__codelineno-43-72"></a>                                           
<a id="__codelineno-43-73" name="__codelineno-43-73" href="#__codelineno-43-73"></a>                                            
<a id="__codelineno-43-74" name="__codelineno-43-74" href="#__codelineno-43-74"></a> Response (AES)
<a id="__codelineno-43-75" name="__codelineno-43-75" href="#__codelineno-43-75"></a>                                           
<a id="__codelineno-43-76" name="__codelineno-43-76" href="#__codelineno-43-76"></a>
<a id="__codelineno-43-77" name="__codelineno-43-77" href="#__codelineno-43-77"></a>SUMMARY:
<a id="__codelineno-43-78" name="__codelineno-43-78" href="#__codelineno-43-78"></a>
<a id="__codelineno-43-79" name="__codelineno-43-79" href="#__codelineno-43-79"></a>1. Handshake uses ASYMMETRIC encryption (slow but secure key exchange)
<a id="__codelineno-43-80" name="__codelineno-43-80" href="#__codelineno-43-80"></a>   - Server sends public key in certificate
<a id="__codelineno-43-81" name="__codelineno-43-81" href="#__codelineno-43-81"></a>   - Client encrypts session key with server&#39;s public key
<a id="__codelineno-43-82" name="__codelineno-43-82" href="#__codelineno-43-82"></a>   - Server decrypts with private key
<a id="__codelineno-43-83" name="__codelineno-43-83" href="#__codelineno-43-83"></a>
<a id="__codelineno-43-84" name="__codelineno-43-84" href="#__codelineno-43-84"></a>2. Data transfer uses SYMMETRIC encryption (fast)
<a id="__codelineno-43-85" name="__codelineno-43-85" href="#__codelineno-43-85"></a>   - Both sides use the same session key (AES-256-GCM)
<a id="__codelineno-43-86" name="__codelineno-43-86" href="#__codelineno-43-86"></a>   - All application data encrypted with this key
<a id="__codelineno-43-87" name="__codelineno-43-87" href="#__codelineno-43-87"></a>   - Session key is temporary (only for this connection)
</code></pre></div>
<p><strong>Why Use Both Asymmetric and Symmetric?</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>ASYMMETRIC (RSA/ECC):
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>Purpose: Securely exchange the symmetric key
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>Used: Only during handshake
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>Advantage: No shared secret needed beforehand
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>Disadvantage: Too slow for bulk data
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>         Handshake Complete 
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>SYMMETRIC (AES):
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>Purpose: Encrypt actual data
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a>Used: All application data
<a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>Advantage: Very fast, efficient
<a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>Disadvantage: Both parties need the key
<a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a>
<a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>RESULT: Best of both worlds!
</code></pre></div>
<h3 id="digital-certificates-and-certificate-authorities">Digital Certificates and Certificate Authorities</h3>
<p><strong>What is a Digital Certificate?</strong></p>
<p>A <strong>digital certificate</strong> is an electronic document that proves the ownership of a public key. It's like a digital passport that verifies identity in the online world.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>
<a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>              Digital Certificate Structure                   
<a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
<a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>
<a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>
<a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>                  X.509 Certificate                         
<a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>
<a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>                                                            
<a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a>  Certificate Information:                                  
<a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a>   
<a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a>   Version: 3                                            
<a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a>   Serial Number: 0x4f3a2e1d9c8b7a6f                     
<a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a>                                                         
<a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a>   SUBJECT (Certificate Owner):                          
<a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>    Common Name (CN): www.example.com                  
<a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a>    Organization (O): Example Corp                     
<a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a>    Country (C): US                                    
<a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a>                                                         
<a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a>   ISSUER (Who signed this):                             
<a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a>    Common Name (CN): DigiCert TLS RSA SHA256 CA      
<a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a>    Organization (O): DigiCert Inc                     
<a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>    Country (C): US                                    
<a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a>                                                         
<a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a>   VALIDITY PERIOD:                                      
<a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>    Not Before: 2025-01-01 00:00:00 UTC               
<a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a>    Not After:  2026-01-01 23:59:59 UTC               
<a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a>                                                         
<a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a>   PUBLIC KEY INFO:                                      
<a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a>    Algorithm: RSA                                     
<a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a>    Key Size: 2048 bits                               
<a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a>    Public Key: 30 82 01 0a 02 82 01 01 00 b4...     
<a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a>                                                         
<a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a>   EXTENSIONS:                                           
<a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a>    Subject Alternative Names:                         
<a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a>      www.example.com                                 
<a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a>      example.com                                     
<a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a>      *.example.com                                   
<a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a>    Key Usage: Digital Signature, Key Encipherment    
<a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a>    Extended Key Usage: TLS Web Server Auth           
<a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a>   
<a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a>                                                            
<a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a>  SIGNATURE (by CA):                                        
<a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a>   
<a id="__codelineno-45-44" name="__codelineno-45-44" href="#__codelineno-45-44"></a>   Signature Algorithm: sha256WithRSAEncryption          
<a id="__codelineno-45-45" name="__codelineno-45-45" href="#__codelineno-45-45"></a>   Signature Value:                                      
<a id="__codelineno-45-46" name="__codelineno-45-46" href="#__codelineno-45-46"></a>   5f:3a:2e:1d:9c:8b:7a:6f:4e:3d:2c:1b:9a:8f:7e:6d...  
<a id="__codelineno-45-47" name="__codelineno-45-47" href="#__codelineno-45-47"></a>   (CA&#39;s private key encrypted hash of certificate)     
<a id="__codelineno-45-48" name="__codelineno-45-48" href="#__codelineno-45-48"></a>   
<a id="__codelineno-45-49" name="__codelineno-45-49" href="#__codelineno-45-49"></a>
<a id="__codelineno-45-50" name="__codelineno-45-50" href="#__codelineno-45-50"></a>
<a id="__codelineno-45-51" name="__codelineno-45-51" href="#__codelineno-45-51"></a>PURPOSE:
<a id="__codelineno-45-52" name="__codelineno-45-52" href="#__codelineno-45-52"></a>
<a id="__codelineno-45-53" name="__codelineno-45-53" href="#__codelineno-45-53"></a> Proves server owns the public key
<a id="__codelineno-45-54" name="__codelineno-45-54" href="#__codelineno-45-54"></a> Binds public key to domain name (www.example.com)
<a id="__codelineno-45-55" name="__codelineno-45-55" href="#__codelineno-45-55"></a> Signed by trusted Certificate Authority (CA)
<a id="__codelineno-45-56" name="__codelineno-45-56" href="#__codelineno-45-56"></a> Prevents man-in-the-middle attacks
</code></pre></div>
<h4 id="certificate-chain-of-trust">Certificate Chain of Trust</h4>
<p><strong>How Trust Works:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>              Certificate Chain of Trust                      
<a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>
<a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>
<a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>LEVEL 1: Root CA (Top of Trust Hierarchy)
<a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>
<a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>
<a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>      ROOT CERTIFICATE AUTHORITY            
<a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>                                            
<a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>  Name: DigiCert Global Root CA             
<a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>  Status: Self-Signed (trust anchor)        
<a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>  Validity: 30+ years                       
<a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>  Location: Pre-installed in browsers/OS    
<a id="__codelineno-46-14" name="__codelineno-46-14" href="#__codelineno-46-14"></a>                                            
<a id="__codelineno-46-15" name="__codelineno-46-15" href="#__codelineno-46-15"></a>       
<a id="__codelineno-46-16" name="__codelineno-46-16" href="#__codelineno-46-16"></a>   Private Key (Ultra Secure)            
<a id="__codelineno-46-17" name="__codelineno-46-17" href="#__codelineno-46-17"></a>   - Kept offline in HSM                 
<a id="__codelineno-46-18" name="__codelineno-46-18" href="#__codelineno-46-18"></a>   - Physical security                   
<a id="__codelineno-46-19" name="__codelineno-46-19" href="#__codelineno-46-19"></a>   - Rarely used                         
<a id="__codelineno-46-20" name="__codelineno-46-20" href="#__codelineno-46-20"></a>       
<a id="__codelineno-46-21" name="__codelineno-46-21" href="#__codelineno-46-21"></a>
<a id="__codelineno-46-22" name="__codelineno-46-22" href="#__codelineno-46-22"></a>                   Signs 
<a id="__codelineno-46-23" name="__codelineno-46-23" href="#__codelineno-46-23"></a>                  
<a id="__codelineno-46-24" name="__codelineno-46-24" href="#__codelineno-46-24"></a>LEVEL 2: Intermediate CA (Middle Layer)
<a id="__codelineno-46-25" name="__codelineno-46-25" href="#__codelineno-46-25"></a>
<a id="__codelineno-46-26" name="__codelineno-46-26" href="#__codelineno-46-26"></a>
<a id="__codelineno-46-27" name="__codelineno-46-27" href="#__codelineno-46-27"></a>    INTERMEDIATE CERTIFICATE                
<a id="__codelineno-46-28" name="__codelineno-46-28" href="#__codelineno-46-28"></a>                                            
<a id="__codelineno-46-29" name="__codelineno-46-29" href="#__codelineno-46-29"></a>  Name: DigiCert TLS RSA SHA256 2020 CA1    
<a id="__codelineno-46-30" name="__codelineno-46-30" href="#__codelineno-46-30"></a>  Signed by: DigiCert Global Root CA        
<a id="__codelineno-46-31" name="__codelineno-46-31" href="#__codelineno-46-31"></a>  Validity: 5-10 years                      
<a id="__codelineno-46-32" name="__codelineno-46-32" href="#__codelineno-46-32"></a>  Purpose: Issues end-entity certificates   
<a id="__codelineno-46-33" name="__codelineno-46-33" href="#__codelineno-46-33"></a>                                            
<a id="__codelineno-46-34" name="__codelineno-46-34" href="#__codelineno-46-34"></a>  Why Intermediate?                         
<a id="__codelineno-46-35" name="__codelineno-46-35" href="#__codelineno-46-35"></a>   Protects root CA private key            
<a id="__codelineno-46-36" name="__codelineno-46-36" href="#__codelineno-46-36"></a>   Can be revoked if compromised           
<a id="__codelineno-46-37" name="__codelineno-46-37" href="#__codelineno-46-37"></a>   Easier to manage/rotate                 
<a id="__codelineno-46-38" name="__codelineno-46-38" href="#__codelineno-46-38"></a>
<a id="__codelineno-46-39" name="__codelineno-46-39" href="#__codelineno-46-39"></a>                   Signs 
<a id="__codelineno-46-40" name="__codelineno-46-40" href="#__codelineno-46-40"></a>                  
<a id="__codelineno-46-41" name="__codelineno-46-41" href="#__codelineno-46-41"></a>LEVEL 3: End-Entity (Server Certificate)
<a id="__codelineno-46-42" name="__codelineno-46-42" href="#__codelineno-46-42"></a>
<a id="__codelineno-46-43" name="__codelineno-46-43" href="#__codelineno-46-43"></a>
<a id="__codelineno-46-44" name="__codelineno-46-44" href="#__codelineno-46-44"></a>      SERVER CERTIFICATE                    
<a id="__codelineno-46-45" name="__codelineno-46-45" href="#__codelineno-46-45"></a>                                            
<a id="__codelineno-46-46" name="__codelineno-46-46" href="#__codelineno-46-46"></a>  Domain: www.example.com                   
<a id="__codelineno-46-47" name="__codelineno-46-47" href="#__codelineno-46-47"></a>  Signed by: DigiCert TLS RSA SHA256 CA     
<a id="__codelineno-46-48" name="__codelineno-46-48" href="#__codelineno-46-48"></a>  Validity: 1 year (typically)              
<a id="__codelineno-46-49" name="__codelineno-46-49" href="#__codelineno-46-49"></a>  Contains: Server&#39;s public key             
<a id="__codelineno-46-50" name="__codelineno-46-50" href="#__codelineno-46-50"></a>                                            
<a id="__codelineno-46-51" name="__codelineno-46-51" href="#__codelineno-46-51"></a>  Used for:                                 
<a id="__codelineno-46-52" name="__codelineno-46-52" href="#__codelineno-46-52"></a>   TLS/HTTPS connections                   
<a id="__codelineno-46-53" name="__codelineno-46-53" href="#__codelineno-46-53"></a>   Proving server identity                 
<a id="__codelineno-46-54" name="__codelineno-46-54" href="#__codelineno-46-54"></a>   Encrypting session keys                 
<a id="__codelineno-46-55" name="__codelineno-46-55" href="#__codelineno-46-55"></a>
<a id="__codelineno-46-56" name="__codelineno-46-56" href="#__codelineno-46-56"></a>
<a id="__codelineno-46-57" name="__codelineno-46-57" href="#__codelineno-46-57"></a>VERIFICATION FLOW:
<a id="__codelineno-46-58" name="__codelineno-46-58" href="#__codelineno-46-58"></a>
<a id="__codelineno-46-59" name="__codelineno-46-59" href="#__codelineno-46-59"></a>
<a id="__codelineno-46-60" name="__codelineno-46-60" href="#__codelineno-46-60"></a>Browser receives Server Certificate
<a id="__codelineno-46-61" name="__codelineno-46-61" href="#__codelineno-46-61"></a>         
<a id="__codelineno-46-62" name="__codelineno-46-62" href="#__codelineno-46-62"></a>    
<a id="__codelineno-46-63" name="__codelineno-46-63" href="#__codelineno-46-63"></a>     Is it signed by     
<a id="__codelineno-46-64" name="__codelineno-46-64" href="#__codelineno-46-64"></a>     trusted Intermediate?  Check signature
<a id="__codelineno-46-65" name="__codelineno-46-65" href="#__codelineno-46-65"></a>    
<a id="__codelineno-46-66" name="__codelineno-46-66" href="#__codelineno-46-66"></a>            YES
<a id="__codelineno-46-67" name="__codelineno-46-67" href="#__codelineno-46-67"></a>           
<a id="__codelineno-46-68" name="__codelineno-46-68" href="#__codelineno-46-68"></a>    
<a id="__codelineno-46-69" name="__codelineno-46-69" href="#__codelineno-46-69"></a>     Is Intermediate     
<a id="__codelineno-46-70" name="__codelineno-46-70" href="#__codelineno-46-70"></a>     signed by             Check signature
<a id="__codelineno-46-71" name="__codelineno-46-71" href="#__codelineno-46-71"></a>     trusted Root CA?    
<a id="__codelineno-46-72" name="__codelineno-46-72" href="#__codelineno-46-72"></a>    
<a id="__codelineno-46-73" name="__codelineno-46-73" href="#__codelineno-46-73"></a>            YES
<a id="__codelineno-46-74" name="__codelineno-46-74" href="#__codelineno-46-74"></a>           
<a id="__codelineno-46-75" name="__codelineno-46-75" href="#__codelineno-46-75"></a>    
<a id="__codelineno-46-76" name="__codelineno-46-76" href="#__codelineno-46-76"></a>     Is Root CA in       
<a id="__codelineno-46-77" name="__codelineno-46-77" href="#__codelineno-46-77"></a>     browser&#39;s trust       Check trust store
<a id="__codelineno-46-78" name="__codelineno-46-78" href="#__codelineno-46-78"></a>     store?              
<a id="__codelineno-46-79" name="__codelineno-46-79" href="#__codelineno-46-79"></a>    
<a id="__codelineno-46-80" name="__codelineno-46-80" href="#__codelineno-46-80"></a>            YES
<a id="__codelineno-46-81" name="__codelineno-46-81" href="#__codelineno-46-81"></a>           
<a id="__codelineno-46-82" name="__codelineno-46-82" href="#__codelineno-46-82"></a>     CERTIFICATE TRUSTED!
<a id="__codelineno-46-83" name="__codelineno-46-83" href="#__codelineno-46-83"></a>
<a id="__codelineno-46-84" name="__codelineno-46-84" href="#__codelineno-46-84"></a>If any step fails   WARNING: Untrusted Certificate!
</code></pre></div>
<h4 id="types-of-certificates">Types of Certificates</h4>
<p><strong>1. Root CA Certificate</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>
<a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>                  ROOT CA CERTIFICATE                         
<a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>
<a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a>
<a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>CHARACTERISTICS:
<a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>
<a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a> Self-signed (signs itself)
<a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a> Pre-installed in browsers, OS, devices
<a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a> Extremely long validity (20-30 years)
<a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a> Private key stored offline in Hardware Security Module (HSM)
<a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a> Highest level of trust
<a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>
<a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a>EXAMPLES:
<a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a>
<a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a> DigiCert Global Root CA
<a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a> GlobalSign Root CA
<a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a> Let&#39;s Encrypt Root CA (ISRG Root X1)
<a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a> VeriSign/Symantec roots
<a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a>
<a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a>WHERE STORED:
<a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a>
<a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a> Windows: Certificate Manager (certmgr.msc)
<a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a> macOS: Keychain Access  System Roots
<a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a> Linux: /etc/ssl/certs/
<a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a> Browsers: Firefox has own trust store
<a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a>
<a id="__codelineno-47-27" name="__codelineno-47-27" href="#__codelineno-47-27"></a>USAGE:
<a id="__codelineno-47-28" name="__codelineno-47-28" href="#__codelineno-47-28"></a>
<a id="__codelineno-47-29" name="__codelineno-47-29" href="#__codelineno-47-29"></a> NOT used directly for TLS
<a id="__codelineno-47-30" name="__codelineno-47-30" href="#__codelineno-47-30"></a> Only signs intermediate CA certificates
<a id="__codelineno-47-31" name="__codelineno-47-31" href="#__codelineno-47-31"></a> Root of trust for entire chain
</code></pre></div>
<p><strong>2. Intermediate CA Certificate</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>              INTERMEDIATE CA CERTIFICATE                     
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>CHARACTERISTICS:
<a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>
<a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a> Signed by Root CA
<a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a> Signs end-entity certificates (server, client)
<a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a> Medium validity (5-10 years)
<a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a> Can be revoked without affecting root
<a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a> Multiple intermediates can exist
<a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a>
<a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a>WHY USE INTERMEDIATES?
<a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a>
<a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a>
<a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a>SECURITY:
<a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a>
<a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a> Root CA Private Key                  
<a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a>  Kept offline in secure facility   
<a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a>  Air-gapped from internet          
<a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a>  Physical security (vault)         
<a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a>  Used only to sign intermediates   
<a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a>
<a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a>              
<a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a>               Signs
<a id="__codelineno-48-26" name="__codelineno-48-26" href="#__codelineno-48-26"></a>
<a id="__codelineno-48-27" name="__codelineno-48-27" href="#__codelineno-48-27"></a> Intermediate CA Private Key          
<a id="__codelineno-48-28" name="__codelineno-48-28" href="#__codelineno-48-28"></a>  Online, can issue certificates    
<a id="__codelineno-48-29" name="__codelineno-48-29" href="#__codelineno-48-29"></a>  If compromised, revoke this CA    
<a id="__codelineno-48-30" name="__codelineno-48-30" href="#__codelineno-48-30"></a>  Root CA remains secure            
<a id="__codelineno-48-31" name="__codelineno-48-31" href="#__codelineno-48-31"></a>
<a id="__codelineno-48-32" name="__codelineno-48-32" href="#__codelineno-48-32"></a>
<a id="__codelineno-48-33" name="__codelineno-48-33" href="#__codelineno-48-33"></a>FLEXIBILITY:
<a id="__codelineno-48-34" name="__codelineno-48-34" href="#__codelineno-48-34"></a> Different intermediates for different purposes:
<a id="__codelineno-48-35" name="__codelineno-48-35" href="#__codelineno-48-35"></a>  - One for web servers
<a id="__codelineno-48-36" name="__codelineno-48-36" href="#__codelineno-48-36"></a>  - One for email
<a id="__codelineno-48-37" name="__codelineno-48-37" href="#__codelineno-48-37"></a>  - One for code signing
<a id="__codelineno-48-38" name="__codelineno-48-38" href="#__codelineno-48-38"></a> Easy to revoke and replace
<a id="__codelineno-48-39" name="__codelineno-48-39" href="#__codelineno-48-39"></a>
<a id="__codelineno-48-40" name="__codelineno-48-40" href="#__codelineno-48-40"></a>EXAMPLE CHAIN:
<a id="__codelineno-48-41" name="__codelineno-48-41" href="#__codelineno-48-41"></a>
<a id="__codelineno-48-42" name="__codelineno-48-42" href="#__codelineno-48-42"></a>DigiCert Global Root G2 (Root)
<a id="__codelineno-48-43" name="__codelineno-48-43" href="#__codelineno-48-43"></a>     DigiCert TLS RSA SHA256 2020 CA1 (Intermediate)
<a id="__codelineno-48-44" name="__codelineno-48-44" href="#__codelineno-48-44"></a>             www.example.com (Server)
</code></pre></div>
<p><strong>3. Server Certificate (TLS/SSL Certificate)</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>
<a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>                  SERVER CERTIFICATE                          
<a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>
<a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a>
<a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a>PURPOSE:
<a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a>
<a id="__codelineno-49-7" name="__codelineno-49-7" href="#__codelineno-49-7"></a>Proves web server&#39;s identity and encrypts traffic
<a id="__codelineno-49-8" name="__codelineno-49-8" href="#__codelineno-49-8"></a>
<a id="__codelineno-49-9" name="__codelineno-49-9" href="#__codelineno-49-9"></a>CONTAINS:
<a id="__codelineno-49-10" name="__codelineno-49-10" href="#__codelineno-49-10"></a>
<a id="__codelineno-49-11" name="__codelineno-49-11" href="#__codelineno-49-11"></a> Domain name(s): www.example.com, example.com
<a id="__codelineno-49-12" name="__codelineno-49-12" href="#__codelineno-49-12"></a> Server&#39;s public key (RSA or ECC)
<a id="__codelineno-49-13" name="__codelineno-49-13" href="#__codelineno-49-13"></a> Validity period (typically 90 days to 1 year)
<a id="__codelineno-49-14" name="__codelineno-49-14" href="#__codelineno-49-14"></a> Issuer (Intermediate CA)
<a id="__codelineno-49-15" name="__codelineno-49-15" href="#__codelineno-49-15"></a> Signature (signed by Intermediate CA)
<a id="__codelineno-49-16" name="__codelineno-49-16" href="#__codelineno-49-16"></a>
<a id="__codelineno-49-17" name="__codelineno-49-17" href="#__codelineno-49-17"></a>TYPES OF SERVER CERTIFICATES:
<a id="__codelineno-49-18" name="__codelineno-49-18" href="#__codelineno-49-18"></a>
<a id="__codelineno-49-19" name="__codelineno-49-19" href="#__codelineno-49-19"></a>
<a id="__codelineno-49-20" name="__codelineno-49-20" href="#__codelineno-49-20"></a>1. DOMAIN VALIDATED (DV) - Basic
<a id="__codelineno-49-21" name="__codelineno-49-21" href="#__codelineno-49-21"></a>   
<a id="__codelineno-49-22" name="__codelineno-49-22" href="#__codelineno-49-22"></a>    Validation: Domain control 
<a id="__codelineno-49-23" name="__codelineno-49-23" href="#__codelineno-49-23"></a>    Time: Minutes              
<a id="__codelineno-49-24" name="__codelineno-49-24" href="#__codelineno-49-24"></a>    Cost: Free - $50/year      
<a id="__codelineno-49-25" name="__codelineno-49-25" href="#__codelineno-49-25"></a>    Display: Padlock only      
<a id="__codelineno-49-26" name="__codelineno-49-26" href="#__codelineno-49-26"></a>    Example: Let&#39;s Encrypt     
<a id="__codelineno-49-27" name="__codelineno-49-27" href="#__codelineno-49-27"></a>   
<a id="__codelineno-49-28" name="__codelineno-49-28" href="#__codelineno-49-28"></a>
<a id="__codelineno-49-29" name="__codelineno-49-29" href="#__codelineno-49-29"></a>   Usage: Blogs, personal sites
<a id="__codelineno-49-30" name="__codelineno-49-30" href="#__codelineno-49-30"></a>   Verification: Email or DNS record
<a id="__codelineno-49-31" name="__codelineno-49-31" href="#__codelineno-49-31"></a>
<a id="__codelineno-49-32" name="__codelineno-49-32" href="#__codelineno-49-32"></a>2. ORGANIZATION VALIDATED (OV) - Medium
<a id="__codelineno-49-33" name="__codelineno-49-33" href="#__codelineno-49-33"></a>   
<a id="__codelineno-49-34" name="__codelineno-49-34" href="#__codelineno-49-34"></a>    Validation: Org identity   
<a id="__codelineno-49-35" name="__codelineno-49-35" href="#__codelineno-49-35"></a>    Time: 1-3 days             
<a id="__codelineno-49-36" name="__codelineno-49-36" href="#__codelineno-49-36"></a>    Cost: $50-$200/year        
<a id="__codelineno-49-37" name="__codelineno-49-37" href="#__codelineno-49-37"></a>    Display: Org name in cert  
<a id="__codelineno-49-38" name="__codelineno-49-38" href="#__codelineno-49-38"></a>    Example: DigiCert OV       
<a id="__codelineno-49-39" name="__codelineno-49-39" href="#__codelineno-49-39"></a>   
<a id="__codelineno-49-40" name="__codelineno-49-40" href="#__codelineno-49-40"></a>
<a id="__codelineno-49-41" name="__codelineno-49-41" href="#__codelineno-49-41"></a>   Usage: Business websites
<a id="__codelineno-49-42" name="__codelineno-49-42" href="#__codelineno-49-42"></a>   Verification: Business documents
<a id="__codelineno-49-43" name="__codelineno-49-43" href="#__codelineno-49-43"></a>
<a id="__codelineno-49-44" name="__codelineno-49-44" href="#__codelineno-49-44"></a>3. EXTENDED VALIDATION (EV) - Highest
<a id="__codelineno-49-45" name="__codelineno-49-45" href="#__codelineno-49-45"></a>   
<a id="__codelineno-49-46" name="__codelineno-49-46" href="#__codelineno-49-46"></a>    Validation: Extensive      
<a id="__codelineno-49-47" name="__codelineno-49-47" href="#__codelineno-49-47"></a>    Time: 1-2 weeks            
<a id="__codelineno-49-48" name="__codelineno-49-48" href="#__codelineno-49-48"></a>    Cost: $200-$1000/year      
<a id="__codelineno-49-49" name="__codelineno-49-49" href="#__codelineno-49-49"></a>    Display: Company name      
<a id="__codelineno-49-50" name="__codelineno-49-50" href="#__codelineno-49-50"></a>             (some browsers)   
<a id="__codelineno-49-51" name="__codelineno-49-51" href="#__codelineno-49-51"></a>   
<a id="__codelineno-49-52" name="__codelineno-49-52" href="#__codelineno-49-52"></a>
<a id="__codelineno-49-53" name="__codelineno-49-53" href="#__codelineno-49-53"></a>   Usage: Banks, e-commerce
<a id="__codelineno-49-54" name="__codelineno-49-54" href="#__codelineno-49-54"></a>   Verification: Legal docs, phone, physical address
<a id="__codelineno-49-55" name="__codelineno-49-55" href="#__codelineno-49-55"></a>
<a id="__codelineno-49-56" name="__codelineno-49-56" href="#__codelineno-49-56"></a>SINGLE vs MULTI-DOMAIN:
<a id="__codelineno-49-57" name="__codelineno-49-57" href="#__codelineno-49-57"></a>
<a id="__codelineno-49-58" name="__codelineno-49-58" href="#__codelineno-49-58"></a>
<a id="__codelineno-49-59" name="__codelineno-49-59" href="#__codelineno-49-59"></a>Single Domain:
<a id="__codelineno-49-60" name="__codelineno-49-60" href="#__codelineno-49-60"></a> Covers: www.example.com
<a id="__codelineno-49-61" name="__codelineno-49-61" href="#__codelineno-49-61"></a> Cost: Lower
<a id="__codelineno-49-62" name="__codelineno-49-62" href="#__codelineno-49-62"></a>
<a id="__codelineno-49-63" name="__codelineno-49-63" href="#__codelineno-49-63"></a>Wildcard:
<a id="__codelineno-49-64" name="__codelineno-49-64" href="#__codelineno-49-64"></a> Covers: *.example.com
<a id="__codelineno-49-65" name="__codelineno-49-65" href="#__codelineno-49-65"></a>          (blog.example.com, shop.example.com)
<a id="__codelineno-49-66" name="__codelineno-49-66" href="#__codelineno-49-66"></a> Cost: Medium
<a id="__codelineno-49-67" name="__codelineno-49-67" href="#__codelineno-49-67"></a>
<a id="__codelineno-49-68" name="__codelineno-49-68" href="#__codelineno-49-68"></a>Multi-Domain (SAN):
<a id="__codelineno-49-69" name="__codelineno-49-69" href="#__codelineno-49-69"></a> Covers: example.com, example.net, example.org
<a id="__codelineno-49-70" name="__codelineno-49-70" href="#__codelineno-49-70"></a>          subdomain.example.com
<a id="__codelineno-49-71" name="__codelineno-49-71" href="#__codelineno-49-71"></a> Cost: Higher
<a id="__codelineno-49-72" name="__codelineno-49-72" href="#__codelineno-49-72"></a>
<a id="__codelineno-49-73" name="__codelineno-49-73" href="#__codelineno-49-73"></a>USAGE IN TLS:
<a id="__codelineno-49-74" name="__codelineno-49-74" href="#__codelineno-49-74"></a>
<a id="__codelineno-49-75" name="__codelineno-49-75" href="#__codelineno-49-75"></a>Server  Sends certificate to client during handshake
<a id="__codelineno-49-76" name="__codelineno-49-76" href="#__codelineno-49-76"></a>Client  Verifies certificate and domain match
<a id="__codelineno-49-77" name="__codelineno-49-77" href="#__codelineno-49-77"></a>Client  Extracts public key from certificate
<a id="__codelineno-49-78" name="__codelineno-49-78" href="#__codelineno-49-78"></a>Client  Encrypts session key with public key
<a id="__codelineno-49-79" name="__codelineno-49-79" href="#__codelineno-49-79"></a>Server  Decrypts with private key (not in certificate)
</code></pre></div>
<p><strong>4. Client Certificate</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>
<a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>                  CLIENT CERTIFICATE                          
<a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
<a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>
<a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>PURPOSE:
<a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
<a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>Proves client&#39;s (user&#39;s) identity to server
<a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>Mutual TLS authentication (mTLS)
<a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>
<a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>CHARACTERISTICS:
<a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>
<a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a> Issued to individual users or devices
<a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a> Contains user&#39;s public key
<a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a> Signed by organization&#39;s CA
<a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a> Used for strong authentication
<a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a>
<a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a>TYPICAL USE CASES:
<a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a>
<a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a>
<a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a>1. CORPORATE VPN ACCESS
<a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a>   Employee  Certificate on laptop
<a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a>   VPN Server  Verifies employee certificate
<a id="__codelineno-50-23" name="__codelineno-50-23" href="#__codelineno-50-23"></a>    Access granted only with valid certificate
<a id="__codelineno-50-24" name="__codelineno-50-24" href="#__codelineno-50-24"></a>
<a id="__codelineno-50-25" name="__codelineno-50-25" href="#__codelineno-50-25"></a>2. API AUTHENTICATION
<a id="__codelineno-50-26" name="__codelineno-50-26" href="#__codelineno-50-26"></a>   Service A  Client certificate
<a id="__codelineno-50-27" name="__codelineno-50-27" href="#__codelineno-50-27"></a>   Service B  Verifies certificate
<a id="__codelineno-50-28" name="__codelineno-50-28" href="#__codelineno-50-28"></a>    Machine-to-machine authentication
<a id="__codelineno-50-29" name="__codelineno-50-29" href="#__codelineno-50-29"></a>
<a id="__codelineno-50-30" name="__codelineno-50-30" href="#__codelineno-50-30"></a>3. EMAIL SIGNING/ENCRYPTION (S/MIME)
<a id="__codelineno-50-31" name="__codelineno-50-31" href="#__codelineno-50-31"></a>   User  Signs email with private key
<a id="__codelineno-50-32" name="__codelineno-50-32" href="#__codelineno-50-32"></a>   Recipient  Verifies with user&#39;s certificate
<a id="__codelineno-50-33" name="__codelineno-50-33" href="#__codelineno-50-33"></a>
<a id="__codelineno-50-34" name="__codelineno-50-34" href="#__codelineno-50-34"></a>4. SMART CARD LOGIN
<a id="__codelineno-50-35" name="__codelineno-50-35" href="#__codelineno-50-35"></a>   Employee  Inserts smart card
<a id="__codelineno-50-36" name="__codelineno-50-36" href="#__codelineno-50-36"></a>   Computer  Reads certificate from card
<a id="__codelineno-50-37" name="__codelineno-50-37" href="#__codelineno-50-37"></a>   Active Directory  Verifies certificate
<a id="__codelineno-50-38" name="__codelineno-50-38" href="#__codelineno-50-38"></a>
<a id="__codelineno-50-39" name="__codelineno-50-39" href="#__codelineno-50-39"></a>5. BANKING/FINANCE
<a id="__codelineno-50-40" name="__codelineno-50-40" href="#__codelineno-50-40"></a>   Customer  Certificate on USB token
<a id="__codelineno-50-41" name="__codelineno-50-41" href="#__codelineno-50-41"></a>   Bank  Requires certificate + password
<a id="__codelineno-50-42" name="__codelineno-50-42" href="#__codelineno-50-42"></a>    Two-factor authentication
<a id="__codelineno-50-43" name="__codelineno-50-43" href="#__codelineno-50-43"></a>
<a id="__codelineno-50-44" name="__codelineno-50-44" href="#__codelineno-50-44"></a>EXAMPLE - MUTUAL TLS (mTLS):
<a id="__codelineno-50-45" name="__codelineno-50-45" href="#__codelineno-50-45"></a>
<a id="__codelineno-50-46" name="__codelineno-50-46" href="#__codelineno-50-46"></a>
<a id="__codelineno-50-47" name="__codelineno-50-47" href="#__codelineno-50-47"></a>CLIENT                              SERVER
<a id="__codelineno-50-48" name="__codelineno-50-48" href="#__codelineno-50-48"></a>                            
<a id="__codelineno-50-49" name="__codelineno-50-49" href="#__codelineno-50-49"></a>
<a id="__codelineno-50-50" name="__codelineno-50-50" href="#__codelineno-50-50"></a>1. Client  ClientHello          Server
<a id="__codelineno-50-51" name="__codelineno-50-51" href="#__codelineno-50-51"></a>2. Client  ServerHello + Certificate
<a id="__codelineno-50-52" name="__codelineno-50-52" href="#__codelineno-50-52"></a>3. Client  Verify Server Cert
<a id="__codelineno-50-53" name="__codelineno-50-53" href="#__codelineno-50-53"></a>4. Client  Request Client Certificate   Server asks!
<a id="__codelineno-50-54" name="__codelineno-50-54" href="#__codelineno-50-54"></a>5. Client  Send Client Certificate      Client proves identity
<a id="__codelineno-50-55" name="__codelineno-50-55" href="#__codelineno-50-55"></a>6. Server  Verify Client Cert
<a id="__codelineno-50-56" name="__codelineno-50-56" href="#__codelineno-50-56"></a>7.  Both authenticated!
<a id="__codelineno-50-57" name="__codelineno-50-57" href="#__codelineno-50-57"></a>
<a id="__codelineno-50-58" name="__codelineno-50-58" href="#__codelineno-50-58"></a>DIFFERENCE from Normal TLS:
<a id="__codelineno-50-59" name="__codelineno-50-59" href="#__codelineno-50-59"></a>
<a id="__codelineno-50-60" name="__codelineno-50-60" href="#__codelineno-50-60"></a>Normal TLS:  Only server has certificate
<a id="__codelineno-50-61" name="__codelineno-50-61" href="#__codelineno-50-61"></a>Mutual TLS:  Both client AND server have certificates
<a id="__codelineno-50-62" name="__codelineno-50-62" href="#__codelineno-50-62"></a>             (Higher security, commonly used in zero-trust networks)
</code></pre></div>
<h4 id="complete-certificate-workflow">Complete Certificate Workflow</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>
<a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>        Complete Certificate Lifecycle Workflow               
<a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
<a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>
<a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>STEP 1: Generate Key Pair &amp; CSR
<a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>
<a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>Server Administrator:
<a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>
<a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a> 1. Generate Private Key (Keep Secret!)
<a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a>    openssl genrsa -out private.key 2048
<a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>                                        
<a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a> 2. Create CSR (Certificate Signing    
<a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a>    Request)                            
<a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a>    openssl req -new \                  
<a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a>      -key private.key \                
<a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a>      -out server.csr                   
<a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a>                                        
<a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a>    CSR Contains:                       
<a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a>     Domain: www.example.com           
<a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a>     Organization: Example Corp        
<a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a>     Public Key (derived from private) 
<a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a>     NOT the private key!              
<a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a>
<a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a>         
<a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a>          Submit CSR
<a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a>         
<a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a>STEP 2: CA Validates &amp; Signs
<a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a>
<a id="__codelineno-51-29" name="__codelineno-51-29" href="#__codelineno-51-29"></a>Certificate Authority (CA):
<a id="__codelineno-51-30" name="__codelineno-51-30" href="#__codelineno-51-30"></a>
<a id="__codelineno-51-31" name="__codelineno-51-31" href="#__codelineno-51-31"></a> 1. Validate domain ownership           
<a id="__codelineno-51-32" name="__codelineno-51-32" href="#__codelineno-51-32"></a>     Domain validation: DNS or HTTP    
<a id="__codelineno-51-33" name="__codelineno-51-33" href="#__codelineno-51-33"></a>     Organization validation: docs     
<a id="__codelineno-51-34" name="__codelineno-51-34" href="#__codelineno-51-34"></a>                                        
<a id="__codelineno-51-35" name="__codelineno-51-35" href="#__codelineno-51-35"></a> 2. Sign CSR with CA&#39;s private key      
<a id="__codelineno-51-36" name="__codelineno-51-36" href="#__codelineno-51-36"></a>    signature = sign(hash(CSR),         
<a id="__codelineno-51-37" name="__codelineno-51-37" href="#__codelineno-51-37"></a>                     CA_private_key)    
<a id="__codelineno-51-38" name="__codelineno-51-38" href="#__codelineno-51-38"></a>                                        
<a id="__codelineno-51-39" name="__codelineno-51-39" href="#__codelineno-51-39"></a> 3. Create Certificate                  
<a id="__codelineno-51-40" name="__codelineno-51-40" href="#__codelineno-51-40"></a>     CSR data + CA signature           
<a id="__codelineno-51-41" name="__codelineno-51-41" href="#__codelineno-51-41"></a>     Validity period (1 year)          
<a id="__codelineno-51-42" name="__codelineno-51-42" href="#__codelineno-51-42"></a>     Serial number                     
<a id="__codelineno-51-43" name="__codelineno-51-43" href="#__codelineno-51-43"></a>
<a id="__codelineno-51-44" name="__codelineno-51-44" href="#__codelineno-51-44"></a>         
<a id="__codelineno-51-45" name="__codelineno-51-45" href="#__codelineno-51-45"></a>          Return Certificate
<a id="__codelineno-51-46" name="__codelineno-51-46" href="#__codelineno-51-46"></a>         
<a id="__codelineno-51-47" name="__codelineno-51-47" href="#__codelineno-51-47"></a>STEP 3: Install on Server
<a id="__codelineno-51-48" name="__codelineno-51-48" href="#__codelineno-51-48"></a>
<a id="__codelineno-51-49" name="__codelineno-51-49" href="#__codelineno-51-49"></a>Server Administrator:
<a id="__codelineno-51-50" name="__codelineno-51-50" href="#__codelineno-51-50"></a>
<a id="__codelineno-51-51" name="__codelineno-51-51" href="#__codelineno-51-51"></a> 1. Receive certificate from CA         
<a id="__codelineno-51-52" name="__codelineno-51-52" href="#__codelineno-51-52"></a>     server.crt (certificate)          
<a id="__codelineno-51-53" name="__codelineno-51-53" href="#__codelineno-51-53"></a>     intermediate.crt (chain)          
<a id="__codelineno-51-54" name="__codelineno-51-54" href="#__codelineno-51-54"></a>                                        
<a id="__codelineno-51-55" name="__codelineno-51-55" href="#__codelineno-51-55"></a> 2. Install on web server               
<a id="__codelineno-51-56" name="__codelineno-51-56" href="#__codelineno-51-56"></a>     Certificate: server.crt           
<a id="__codelineno-51-57" name="__codelineno-51-57" href="#__codelineno-51-57"></a>     Private Key: private.key          
<a id="__codelineno-51-58" name="__codelineno-51-58" href="#__codelineno-51-58"></a>     Chain: intermediate.crt           
<a id="__codelineno-51-59" name="__codelineno-51-59" href="#__codelineno-51-59"></a>                                        
<a id="__codelineno-51-60" name="__codelineno-51-60" href="#__codelineno-51-60"></a> 3. Configure server (Apache/Nginx)     
<a id="__codelineno-51-61" name="__codelineno-51-61" href="#__codelineno-51-61"></a>
<a id="__codelineno-51-62" name="__codelineno-51-62" href="#__codelineno-51-62"></a>         
<a id="__codelineno-51-63" name="__codelineno-51-63" href="#__codelineno-51-63"></a>          Server Ready
<a id="__codelineno-51-64" name="__codelineno-51-64" href="#__codelineno-51-64"></a>         
<a id="__codelineno-51-65" name="__codelineno-51-65" href="#__codelineno-51-65"></a>STEP 4: TLS Handshake (Runtime)
<a id="__codelineno-51-66" name="__codelineno-51-66" href="#__codelineno-51-66"></a>
<a id="__codelineno-51-67" name="__codelineno-51-67" href="#__codelineno-51-67"></a>Browser  Server
<a id="__codelineno-51-68" name="__codelineno-51-68" href="#__codelineno-51-68"></a>
<a id="__codelineno-51-69" name="__codelineno-51-69" href="#__codelineno-51-69"></a>1. Browser  ClientHello
<a id="__codelineno-51-70" name="__codelineno-51-70" href="#__codelineno-51-70"></a>2. Server  Certificate Chain:
<a id="__codelineno-51-71" name="__codelineno-51-71" href="#__codelineno-51-71"></a>               Server Certificate
<a id="__codelineno-51-72" name="__codelineno-51-72" href="#__codelineno-51-72"></a>               Intermediate Certificate
<a id="__codelineno-51-73" name="__codelineno-51-73" href="#__codelineno-51-73"></a>              (Browser has Root CA)
<a id="__codelineno-51-74" name="__codelineno-51-74" href="#__codelineno-51-74"></a>
<a id="__codelineno-51-75" name="__codelineno-51-75" href="#__codelineno-51-75"></a>3. Browser Verification:
<a id="__codelineno-51-76" name="__codelineno-51-76" href="#__codelineno-51-76"></a>   
<a id="__codelineno-51-77" name="__codelineno-51-77" href="#__codelineno-51-77"></a>     Signature valid?             
<a id="__codelineno-51-78" name="__codelineno-51-78" href="#__codelineno-51-78"></a>       Verify with CA public key 
<a id="__codelineno-51-79" name="__codelineno-51-79" href="#__codelineno-51-79"></a>     Domain matches?              
<a id="__codelineno-51-80" name="__codelineno-51-80" href="#__codelineno-51-80"></a>       example.com == CN?        
<a id="__codelineno-51-81" name="__codelineno-51-81" href="#__codelineno-51-81"></a>     Not expired?                 
<a id="__codelineno-51-82" name="__codelineno-51-82" href="#__codelineno-51-82"></a>       Current date in validity? 
<a id="__codelineno-51-83" name="__codelineno-51-83" href="#__codelineno-51-83"></a>     Not revoked?                 
<a id="__codelineno-51-84" name="__codelineno-51-84" href="#__codelineno-51-84"></a>       Check CRL/OCSP            
<a id="__codelineno-51-85" name="__codelineno-51-85" href="#__codelineno-51-85"></a>     Chain valid?                 
<a id="__codelineno-51-86" name="__codelineno-51-86" href="#__codelineno-51-86"></a>       Root CA trusted?          
<a id="__codelineno-51-87" name="__codelineno-51-87" href="#__codelineno-51-87"></a>   
<a id="__codelineno-51-88" name="__codelineno-51-88" href="#__codelineno-51-88"></a>
<a id="__codelineno-51-89" name="__codelineno-51-89" href="#__codelineno-51-89"></a>4. If all checks pass:
<a id="__codelineno-51-90" name="__codelineno-51-90" href="#__codelineno-51-90"></a>    Extract public key from certificate
<a id="__codelineno-51-91" name="__codelineno-51-91" href="#__codelineno-51-91"></a>    Encrypt session key with public key
<a id="__codelineno-51-92" name="__codelineno-51-92" href="#__codelineno-51-92"></a>    Continue with encrypted communication
<a id="__codelineno-51-93" name="__codelineno-51-93" href="#__codelineno-51-93"></a>
<a id="__codelineno-51-94" name="__codelineno-51-94" href="#__codelineno-51-94"></a>5. If any check fails:
<a id="__codelineno-51-95" name="__codelineno-51-95" href="#__codelineno-51-95"></a>    Show security warning
<a id="__codelineno-51-96" name="__codelineno-51-96" href="#__codelineno-51-96"></a>    Block connection (or warn user)
</code></pre></div>
<h4 id="how-symmetric-asymmetric-encryption-work-together">How Symmetric &amp; Asymmetric Encryption Work Together</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>     Hybrid Encryption in HTTPS (Complete Flow)              
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>PHASE 1: ASYMMETRIC ENCRYPTION (Handshake - Slow but Secure)
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>CLIENT                                          SERVER
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>                                          
<a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>
<a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>                                        
<a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a>                                         Private Key      
<a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>                                         (Keep Secret!)   
<a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>                                        
<a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a>                                                 
<a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a>1. ClientHello 
<a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a>                                                 
<a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a>2. 
<a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a>                                        Certificate:
<a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a>                                        
<a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a>                                         Public Key       
<a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a>                                         CA Signature     
<a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a>                                         Domain Name      
<a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a>                                        
<a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a>
<a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a>3. Verify Certificate:                           
<a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a>    Valid signature?                          
<a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a>    Domain matches?                           
<a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a>    Not expired?                              
<a id="__codelineno-52-30" name="__codelineno-52-30" href="#__codelineno-52-30"></a>    Extract Public Key                         
<a id="__codelineno-52-31" name="__codelineno-52-31" href="#__codelineno-52-31"></a>                                                 
<a id="__codelineno-52-32" name="__codelineno-52-32" href="#__codelineno-52-32"></a>4. Generate Random Session Key:                  
<a id="__codelineno-52-33" name="__codelineno-52-33" href="#__codelineno-52-33"></a>   session_key = random(256 bits)                
<a id="__codelineno-52-34" name="__codelineno-52-34" href="#__codelineno-52-34"></a>   (This will be used for AES encryption)        
<a id="__codelineno-52-35" name="__codelineno-52-35" href="#__codelineno-52-35"></a>                                                 
<a id="__codelineno-52-36" name="__codelineno-52-36" href="#__codelineno-52-36"></a>5. Encrypt Session Key with                      
<a id="__codelineno-52-37" name="__codelineno-52-37" href="#__codelineno-52-37"></a>   Server&#39;s Public Key:                          
<a id="__codelineno-52-38" name="__codelineno-52-38" href="#__codelineno-52-38"></a>                                                 
<a id="__codelineno-52-39" name="__codelineno-52-39" href="#__codelineno-52-39"></a>   encrypted_session_key =                       
<a id="__codelineno-52-40" name="__codelineno-52-40" href="#__codelineno-52-40"></a>   RSA_encrypt(session_key,                      
<a id="__codelineno-52-41" name="__codelineno-52-41" href="#__codelineno-52-41"></a>               server_public_key)                
<a id="__codelineno-52-42" name="__codelineno-52-42" href="#__codelineno-52-42"></a>                                                 
<a id="__codelineno-52-43" name="__codelineno-52-43" href="#__codelineno-52-43"></a>6. 
<a id="__codelineno-52-44" name="__codelineno-52-44" href="#__codelineno-52-44"></a>   Send: encrypted_session_key                   
<a id="__codelineno-52-45" name="__codelineno-52-45" href="#__codelineno-52-45"></a>                                                 
<a id="__codelineno-52-46" name="__codelineno-52-46" href="#__codelineno-52-46"></a>                                    7. Decrypt with Private Key:
<a id="__codelineno-52-47" name="__codelineno-52-47" href="#__codelineno-52-47"></a>                                       session_key =
<a id="__codelineno-52-48" name="__codelineno-52-48" href="#__codelineno-52-48"></a>                                       RSA_decrypt(
<a id="__codelineno-52-49" name="__codelineno-52-49" href="#__codelineno-52-49"></a>                                         encrypted_session_key,
<a id="__codelineno-52-50" name="__codelineno-52-50" href="#__codelineno-52-50"></a>                                         server_private_key)
<a id="__codelineno-52-51" name="__codelineno-52-51" href="#__codelineno-52-51"></a>
<a id="__codelineno-52-52" name="__codelineno-52-52" href="#__codelineno-52-52"></a> Both sides now have the same session_key!
<a id="__codelineno-52-53" name="__codelineno-52-53" href="#__codelineno-52-53"></a>   Client generated it, server decrypted it
<a id="__codelineno-52-54" name="__codelineno-52-54" href="#__codelineno-52-54"></a>   Session key never transmitted in plaintext
<a id="__codelineno-52-55" name="__codelineno-52-55" href="#__codelineno-52-55"></a>
<a id="__codelineno-52-56" name="__codelineno-52-56" href="#__codelineno-52-56"></a>PHASE 2: SYMMETRIC ENCRYPTION (Data Transfer - Fast)
<a id="__codelineno-52-57" name="__codelineno-52-57" href="#__codelineno-52-57"></a>
<a id="__codelineno-52-58" name="__codelineno-52-58" href="#__codelineno-52-58"></a>
<a id="__codelineno-52-59" name="__codelineno-52-59" href="#__codelineno-52-59"></a>CLIENT                                          SERVER
<a id="__codelineno-52-60" name="__codelineno-52-60" href="#__codelineno-52-60"></a>                                          
<a id="__codelineno-52-61" name="__codelineno-52-61" href="#__codelineno-52-61"></a>
<a id="__codelineno-52-62" name="__codelineno-52-62" href="#__codelineno-52-62"></a>8. Encrypt HTTP Request with AES:               
<a id="__codelineno-52-63" name="__codelineno-52-63" href="#__codelineno-52-63"></a>   ciphertext = AES_encrypt(                    
<a id="__codelineno-52-64" name="__codelineno-52-64" href="#__codelineno-52-64"></a>     &quot;GET /api/data&quot;,                           
<a id="__codelineno-52-65" name="__codelineno-52-65" href="#__codelineno-52-65"></a>     session_key                                
<a id="__codelineno-52-66" name="__codelineno-52-66" href="#__codelineno-52-66"></a>   )                                            
<a id="__codelineno-52-67" name="__codelineno-52-67" href="#__codelineno-52-67"></a>                                                
<a id="__codelineno-52-68" name="__codelineno-52-68" href="#__codelineno-52-68"></a>9. 
<a id="__codelineno-52-69" name="__codelineno-52-69" href="#__codelineno-52-69"></a>   Send: AES_encrypted_data                     
<a id="__codelineno-52-70" name="__codelineno-52-70" href="#__codelineno-52-70"></a>                                                
<a id="__codelineno-52-71" name="__codelineno-52-71" href="#__codelineno-52-71"></a>                                    10. Decrypt with Session Key:
<a id="__codelineno-52-72" name="__codelineno-52-72" href="#__codelineno-52-72"></a>                                        plaintext = AES_decrypt(
<a id="__codelineno-52-73" name="__codelineno-52-73" href="#__codelineno-52-73"></a>                                          ciphertext,
<a id="__codelineno-52-74" name="__codelineno-52-74" href="#__codelineno-52-74"></a>                                          session_key)
<a id="__codelineno-52-75" name="__codelineno-52-75" href="#__codelineno-52-75"></a>
<a id="__codelineno-52-76" name="__codelineno-52-76" href="#__codelineno-52-76"></a>                                        Process request...
<a id="__codelineno-52-77" name="__codelineno-52-77" href="#__codelineno-52-77"></a>
<a id="__codelineno-52-78" name="__codelineno-52-78" href="#__codelineno-52-78"></a>                                    11. Encrypt response:
<a id="__codelineno-52-79" name="__codelineno-52-79" href="#__codelineno-52-79"></a>                                        response_encrypted =
<a id="__codelineno-52-80" name="__codelineno-52-80" href="#__codelineno-52-80"></a>                                        AES_encrypt(response,
<a id="__codelineno-52-81" name="__codelineno-52-81" href="#__codelineno-52-81"></a>                                                   session_key)
<a id="__codelineno-52-82" name="__codelineno-52-82" href="#__codelineno-52-82"></a>
<a id="__codelineno-52-83" name="__codelineno-52-83" href="#__codelineno-52-83"></a>12. 
<a id="__codelineno-52-84" name="__codelineno-52-84" href="#__codelineno-52-84"></a>    Receive: AES_encrypted_response              
<a id="__codelineno-52-85" name="__codelineno-52-85" href="#__codelineno-52-85"></a>                                                
<a id="__codelineno-52-86" name="__codelineno-52-86" href="#__codelineno-52-86"></a>13. Decrypt:                                     
<a id="__codelineno-52-87" name="__codelineno-52-87" href="#__codelineno-52-87"></a>    response = AES_decrypt(                      
<a id="__codelineno-52-88" name="__codelineno-52-88" href="#__codelineno-52-88"></a>      response_encrypted,                        
<a id="__codelineno-52-89" name="__codelineno-52-89" href="#__codelineno-52-89"></a>      session_key                                
<a id="__codelineno-52-90" name="__codelineno-52-90" href="#__codelineno-52-90"></a>    )                                            
<a id="__codelineno-52-91" name="__codelineno-52-91" href="#__codelineno-52-91"></a>
<a id="__codelineno-52-92" name="__codelineno-52-92" href="#__codelineno-52-92"></a> All application data encrypted with AES
<a id="__codelineno-52-93" name="__codelineno-52-93" href="#__codelineno-52-93"></a>   Fast, efficient, secure
<a id="__codelineno-52-94" name="__codelineno-52-94" href="#__codelineno-52-94"></a>
<a id="__codelineno-52-95" name="__codelineno-52-95" href="#__codelineno-52-95"></a>COMPARISON:
<a id="__codelineno-52-96" name="__codelineno-52-96" href="#__codelineno-52-96"></a>
<a id="__codelineno-52-97" name="__codelineno-52-97" href="#__codelineno-52-97"></a>
<a id="__codelineno-52-98" name="__codelineno-52-98" href="#__codelineno-52-98"></a>ASYMMETRIC (RSA):
<a id="__codelineno-52-99" name="__codelineno-52-99" href="#__codelineno-52-99"></a> When: Only during handshake
<a id="__codelineno-52-100" name="__codelineno-52-100" href="#__codelineno-52-100"></a> Purpose: Securely exchange session key
<a id="__codelineno-52-101" name="__codelineno-52-101" href="#__codelineno-52-101"></a> Speed: Slow (can encrypt ~245 bytes with 2048-bit key)
<a id="__codelineno-52-102" name="__codelineno-52-102" href="#__codelineno-52-102"></a> Data: Small (pre-master secret only)
<a id="__codelineno-52-103" name="__codelineno-52-103" href="#__codelineno-52-103"></a> Key: Public key in certificate
<a id="__codelineno-52-104" name="__codelineno-52-104" href="#__codelineno-52-104"></a>
<a id="__codelineno-52-105" name="__codelineno-52-105" href="#__codelineno-52-105"></a>SYMMETRIC (AES):
<a id="__codelineno-52-106" name="__codelineno-52-106" href="#__codelineno-52-106"></a> When: All application data
<a id="__codelineno-52-107" name="__codelineno-52-107" href="#__codelineno-52-107"></a> Purpose: Encrypt actual messages
<a id="__codelineno-52-108" name="__codelineno-52-108" href="#__codelineno-52-108"></a> Speed: Fast (gigabytes per second)
<a id="__codelineno-52-109" name="__codelineno-52-109" href="#__codelineno-52-109"></a> Data: Unlimited
<a id="__codelineno-52-110" name="__codelineno-52-110" href="#__codelineno-52-110"></a> Key: Session key (established via asymmetric)
<a id="__codelineno-52-111" name="__codelineno-52-111" href="#__codelineno-52-111"></a>
<a id="__codelineno-52-112" name="__codelineno-52-112" href="#__codelineno-52-112"></a>WHY BOTH?
<a id="__codelineno-52-113" name="__codelineno-52-113" href="#__codelineno-52-113"></a>
<a id="__codelineno-52-114" name="__codelineno-52-114" href="#__codelineno-52-114"></a> Security: Asymmetric solves key distribution
<a id="__codelineno-52-115" name="__codelineno-52-115" href="#__codelineno-52-115"></a> Performance: Symmetric is fast for bulk data
<a id="__codelineno-52-116" name="__codelineno-52-116" href="#__codelineno-52-116"></a> Perfect Combination: Get benefits of both
</code></pre></div>
<h4 id="certificate-implementation-examples">Certificate Implementation Examples</h4>
<p><strong>Python Code - Working with Certificates:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">ssl</span>
<a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography</span><span class="w"> </span><span class="kn">import</span> <span class="n">x509</span>
<a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_backend</span>
<a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.asymmetric</span><span class="w"> </span><span class="kn">import</span> <span class="n">rsa</span>
<a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">serialization</span>
<a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.x509.oid</span><span class="w"> </span><span class="kn">import</span> <span class="n">NameOID</span><span class="p">,</span> <span class="n">ExtensionOID</span>
<a id="__codelineno-53-10" name="__codelineno-53-10" href="#__codelineno-53-10"></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<a id="__codelineno-53-11" name="__codelineno-53-11" href="#__codelineno-53-11"></a>
<a id="__codelineno-53-12" name="__codelineno-53-12" href="#__codelineno-53-12"></a><span class="c1"># </span>
<a id="__codelineno-53-13" name="__codelineno-53-13" href="#__codelineno-53-13"></a><span class="c1"># Example 1: Retrieve and Inspect Server Certificate</span>
<a id="__codelineno-53-14" name="__codelineno-53-14" href="#__codelineno-53-14"></a><span class="c1"># </span>
<a id="__codelineno-53-15" name="__codelineno-53-15" href="#__codelineno-53-15"></a>
<a id="__codelineno-53-16" name="__codelineno-53-16" href="#__codelineno-53-16"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_server_certificate</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">443</span><span class="p">):</span>
<a id="__codelineno-53-17" name="__codelineno-53-17" href="#__codelineno-53-17"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-53-18" name="__codelineno-53-18" href="#__codelineno-53-18"></a><span class="sd">    Retrieve server certificate and display information</span>
<a id="__codelineno-53-19" name="__codelineno-53-19" href="#__codelineno-53-19"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-53-20" name="__codelineno-53-20" href="#__codelineno-53-20"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-21" name="__codelineno-53-21" href="#__codelineno-53-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieving Certificate for: </span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-22" name="__codelineno-53-22" href="#__codelineno-53-22"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-23" name="__codelineno-53-23" href="#__codelineno-53-23"></a>
<a id="__codelineno-53-24" name="__codelineno-53-24" href="#__codelineno-53-24"></a>    <span class="c1"># Create SSL context</span>
<a id="__codelineno-53-25" name="__codelineno-53-25" href="#__codelineno-53-25"></a>    <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<a id="__codelineno-53-26" name="__codelineno-53-26" href="#__codelineno-53-26"></a>
<a id="__codelineno-53-27" name="__codelineno-53-27" href="#__codelineno-53-27"></a>    <span class="c1"># Connect and get certificate</span>
<a id="__codelineno-53-28" name="__codelineno-53-28" href="#__codelineno-53-28"></a>    <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
<a id="__codelineno-53-29" name="__codelineno-53-29" href="#__codelineno-53-29"></a>        <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
<a id="__codelineno-53-30" name="__codelineno-53-30" href="#__codelineno-53-30"></a>            <span class="c1"># Get certificate in DER format</span>
<a id="__codelineno-53-31" name="__codelineno-53-31" href="#__codelineno-53-31"></a>            <span class="n">der_cert</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="n">binary_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-53-32" name="__codelineno-53-32" href="#__codelineno-53-32"></a>
<a id="__codelineno-53-33" name="__codelineno-53-33" href="#__codelineno-53-33"></a>            <span class="c1"># Get certificate info as dict</span>
<a id="__codelineno-53-34" name="__codelineno-53-34" href="#__codelineno-53-34"></a>            <span class="n">cert_dict</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">()</span>
<a id="__codelineno-53-35" name="__codelineno-53-35" href="#__codelineno-53-35"></a>
<a id="__codelineno-53-36" name="__codelineno-53-36" href="#__codelineno-53-36"></a>            <span class="c1"># Parse certificate</span>
<a id="__codelineno-53-37" name="__codelineno-53-37" href="#__codelineno-53-37"></a>            <span class="n">cert</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">load_der_x509_certificate</span><span class="p">(</span><span class="n">der_cert</span><span class="p">,</span> <span class="n">default_backend</span><span class="p">())</span>
<a id="__codelineno-53-38" name="__codelineno-53-38" href="#__codelineno-53-38"></a>
<a id="__codelineno-53-39" name="__codelineno-53-39" href="#__codelineno-53-39"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Certificate Information:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-40" name="__codelineno-53-40" href="#__codelineno-53-40"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-41" name="__codelineno-53-41" href="#__codelineno-53-41"></a>
<a id="__codelineno-53-42" name="__codelineno-53-42" href="#__codelineno-53-42"></a>            <span class="c1"># Subject (who the certificate is issued to)</span>
<a id="__codelineno-53-43" name="__codelineno-53-43" href="#__codelineno-53-43"></a>            <span class="n">subject</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject</span>
<a id="__codelineno-53-44" name="__codelineno-53-44" href="#__codelineno-53-44"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Subject:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-45" name="__codelineno-53-45" href="#__codelineno-53-45"></a>            <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">subject</span><span class="p">:</span>
<a id="__codelineno-53-46" name="__codelineno-53-46" href="#__codelineno-53-46"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">attribute</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">attribute</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-47" name="__codelineno-53-47" href="#__codelineno-53-47"></a>
<a id="__codelineno-53-48" name="__codelineno-53-48" href="#__codelineno-53-48"></a>            <span class="c1"># Issuer (who signed the certificate)</span>
<a id="__codelineno-53-49" name="__codelineno-53-49" href="#__codelineno-53-49"></a>            <span class="n">issuer</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer</span>
<a id="__codelineno-53-50" name="__codelineno-53-50" href="#__codelineno-53-50"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Issuer:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-51" name="__codelineno-53-51" href="#__codelineno-53-51"></a>            <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">issuer</span><span class="p">:</span>
<a id="__codelineno-53-52" name="__codelineno-53-52" href="#__codelineno-53-52"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">attribute</span><span class="o">.</span><span class="n">oid</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">attribute</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-53" name="__codelineno-53-53" href="#__codelineno-53-53"></a>
<a id="__codelineno-53-54" name="__codelineno-53-54" href="#__codelineno-53-54"></a>            <span class="c1"># Validity</span>
<a id="__codelineno-53-55" name="__codelineno-53-55" href="#__codelineno-53-55"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Validity:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-56" name="__codelineno-53-56" href="#__codelineno-53-56"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Not Before: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_before_utc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-57" name="__codelineno-53-57" href="#__codelineno-53-57"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Not After:  </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-58" name="__codelineno-53-58" href="#__codelineno-53-58"></a>
<a id="__codelineno-53-59" name="__codelineno-53-59" href="#__codelineno-53-59"></a>            <span class="c1"># Check if expired</span>
<a id="__codelineno-53-60" name="__codelineno-53-60" href="#__codelineno-53-60"></a>            <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<a id="__codelineno-53-61" name="__codelineno-53-61" href="#__codelineno-53-61"></a>            <span class="k">if</span> <span class="n">now</span> <span class="o">&lt;</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_valid_before_utc</span><span class="p">:</span>
<a id="__codelineno-53-62" name="__codelineno-53-62" href="#__codelineno-53-62"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Certificate not yet valid!&quot;</span><span class="p">)</span>
<a id="__codelineno-53-63" name="__codelineno-53-63" href="#__codelineno-53-63"></a>            <span class="k">elif</span> <span class="n">now</span> <span class="o">&gt;</span> <span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span><span class="p">:</span>
<a id="__codelineno-53-64" name="__codelineno-53-64" href="#__codelineno-53-64"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Certificate EXPIRED!&quot;</span><span class="p">)</span>
<a id="__codelineno-53-65" name="__codelineno-53-65" href="#__codelineno-53-65"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-53-66" name="__codelineno-53-66" href="#__codelineno-53-66"></a>                <span class="n">days_remaining</span> <span class="o">=</span> <span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">not_valid_after_utc</span> <span class="o">-</span> <span class="n">now</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>
<a id="__codelineno-53-67" name="__codelineno-53-67" href="#__codelineno-53-67"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Valid (</span><span class="si">{</span><span class="n">days_remaining</span><span class="si">}</span><span class="s2"> days remaining)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-68" name="__codelineno-53-68" href="#__codelineno-53-68"></a>
<a id="__codelineno-53-69" name="__codelineno-53-69" href="#__codelineno-53-69"></a>            <span class="c1"># Subject Alternative Names (SAN)</span>
<a id="__codelineno-53-70" name="__codelineno-53-70" href="#__codelineno-53-70"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-53-71" name="__codelineno-53-71" href="#__codelineno-53-71"></a>                <span class="n">san_ext</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">get_extension_for_oid</span><span class="p">(</span>
<a id="__codelineno-53-72" name="__codelineno-53-72" href="#__codelineno-53-72"></a>                    <span class="n">ExtensionOID</span><span class="o">.</span><span class="n">SUBJECT_ALTERNATIVE_NAME</span>
<a id="__codelineno-53-73" name="__codelineno-53-73" href="#__codelineno-53-73"></a>                <span class="p">)</span>
<a id="__codelineno-53-74" name="__codelineno-53-74" href="#__codelineno-53-74"></a>                <span class="n">san_list</span> <span class="o">=</span> <span class="n">san_ext</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">get_values_for_type</span><span class="p">(</span><span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">)</span>
<a id="__codelineno-53-75" name="__codelineno-53-75" href="#__codelineno-53-75"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Subject Alternative Names (SAN):&quot;</span><span class="p">)</span>
<a id="__codelineno-53-76" name="__codelineno-53-76" href="#__codelineno-53-76"></a>                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">san_list</span><span class="p">:</span>
<a id="__codelineno-53-77" name="__codelineno-53-77" href="#__codelineno-53-77"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-78" name="__codelineno-53-78" href="#__codelineno-53-78"></a>            <span class="k">except</span> <span class="n">x509</span><span class="o">.</span><span class="n">ExtensionNotFound</span><span class="p">:</span>
<a id="__codelineno-53-79" name="__codelineno-53-79" href="#__codelineno-53-79"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">No Subject Alternative Names found&quot;</span><span class="p">)</span>
<a id="__codelineno-53-80" name="__codelineno-53-80" href="#__codelineno-53-80"></a>
<a id="__codelineno-53-81" name="__codelineno-53-81" href="#__codelineno-53-81"></a>            <span class="c1"># Public Key Info</span>
<a id="__codelineno-53-82" name="__codelineno-53-82" href="#__codelineno-53-82"></a>            <span class="n">public_key</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<a id="__codelineno-53-83" name="__codelineno-53-83" href="#__codelineno-53-83"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">public_key</span><span class="p">,</span> <span class="n">rsa</span><span class="o">.</span><span class="n">RSAPublicKey</span><span class="p">):</span>
<a id="__codelineno-53-84" name="__codelineno-53-84" href="#__codelineno-53-84"></a>                <span class="n">key_size</span> <span class="o">=</span> <span class="n">public_key</span><span class="o">.</span><span class="n">key_size</span>
<a id="__codelineno-53-85" name="__codelineno-53-85" href="#__codelineno-53-85"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Public Key:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-86" name="__codelineno-53-86" href="#__codelineno-53-86"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Algorithm: RSA&quot;</span><span class="p">)</span>
<a id="__codelineno-53-87" name="__codelineno-53-87" href="#__codelineno-53-87"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Key Size: </span><span class="si">{</span><span class="n">key_size</span><span class="si">}</span><span class="s2"> bits&quot;</span><span class="p">)</span>
<a id="__codelineno-53-88" name="__codelineno-53-88" href="#__codelineno-53-88"></a>
<a id="__codelineno-53-89" name="__codelineno-53-89" href="#__codelineno-53-89"></a>            <span class="c1"># Signature Algorithm</span>
<a id="__codelineno-53-90" name="__codelineno-53-90" href="#__codelineno-53-90"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Signature Algorithm: </span><span class="si">{</span><span class="n">cert</span><span class="o">.</span><span class="n">signature_algorithm_oid</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-91" name="__codelineno-53-91" href="#__codelineno-53-91"></a>
<a id="__codelineno-53-92" name="__codelineno-53-92" href="#__codelineno-53-92"></a>            <span class="c1"># Serial Number</span>
<a id="__codelineno-53-93" name="__codelineno-53-93" href="#__codelineno-53-93"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Serial Number: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">serial_number</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-94" name="__codelineno-53-94" href="#__codelineno-53-94"></a>
<a id="__codelineno-53-95" name="__codelineno-53-95" href="#__codelineno-53-95"></a>            <span class="c1"># TLS Version</span>
<a id="__codelineno-53-96" name="__codelineno-53-96" href="#__codelineno-53-96"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">TLS Version: </span><span class="si">{</span><span class="n">ssock</span><span class="o">.</span><span class="n">version</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-97" name="__codelineno-53-97" href="#__codelineno-53-97"></a>
<a id="__codelineno-53-98" name="__codelineno-53-98" href="#__codelineno-53-98"></a>            <span class="c1"># Cipher</span>
<a id="__codelineno-53-99" name="__codelineno-53-99" href="#__codelineno-53-99"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cipher: </span><span class="si">{</span><span class="n">ssock</span><span class="o">.</span><span class="n">cipher</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-100" name="__codelineno-53-100" href="#__codelineno-53-100"></a>
<a id="__codelineno-53-101" name="__codelineno-53-101" href="#__codelineno-53-101"></a>            <span class="k">return</span> <span class="n">cert</span>
<a id="__codelineno-53-102" name="__codelineno-53-102" href="#__codelineno-53-102"></a>
<a id="__codelineno-53-103" name="__codelineno-53-103" href="#__codelineno-53-103"></a><span class="c1"># </span>
<a id="__codelineno-53-104" name="__codelineno-53-104" href="#__codelineno-53-104"></a><span class="c1"># Example 2: Verify Certificate Chain</span>
<a id="__codelineno-53-105" name="__codelineno-53-105" href="#__codelineno-53-105"></a><span class="c1"># </span>
<a id="__codelineno-53-106" name="__codelineno-53-106" href="#__codelineno-53-106"></a>
<a id="__codelineno-53-107" name="__codelineno-53-107" href="#__codelineno-53-107"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_certificate_chain</span><span class="p">(</span><span class="n">hostname</span><span class="p">):</span>
<a id="__codelineno-53-108" name="__codelineno-53-108" href="#__codelineno-53-108"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-53-109" name="__codelineno-53-109" href="#__codelineno-53-109"></a><span class="sd">    Verify complete certificate chain</span>
<a id="__codelineno-53-110" name="__codelineno-53-110" href="#__codelineno-53-110"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-53-111" name="__codelineno-53-111" href="#__codelineno-53-111"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-112" name="__codelineno-53-112" href="#__codelineno-53-112"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verifying Certificate Chain for: </span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-113" name="__codelineno-53-113" href="#__codelineno-53-113"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-114" name="__codelineno-53-114" href="#__codelineno-53-114"></a>
<a id="__codelineno-53-115" name="__codelineno-53-115" href="#__codelineno-53-115"></a>    <span class="c1"># Get certificate chain</span>
<a id="__codelineno-53-116" name="__codelineno-53-116" href="#__codelineno-53-116"></a>    <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
<a id="__codelineno-53-117" name="__codelineno-53-117" href="#__codelineno-53-117"></a>
<a id="__codelineno-53-118" name="__codelineno-53-118" href="#__codelineno-53-118"></a>    <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">hostname</span><span class="p">,</span> <span class="mi">443</span><span class="p">))</span> <span class="k">as</span> <span class="n">sock</span><span class="p">:</span>
<a id="__codelineno-53-119" name="__codelineno-53-119" href="#__codelineno-53-119"></a>        <span class="k">with</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="n">hostname</span><span class="p">)</span> <span class="k">as</span> <span class="n">ssock</span><span class="p">:</span>
<a id="__codelineno-53-120" name="__codelineno-53-120" href="#__codelineno-53-120"></a>            <span class="c1"># Get peer certificate chain</span>
<a id="__codelineno-53-121" name="__codelineno-53-121" href="#__codelineno-53-121"></a>            <span class="n">der_cert</span> <span class="o">=</span> <span class="n">ssock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="n">binary_form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-53-122" name="__codelineno-53-122" href="#__codelineno-53-122"></a>            <span class="n">cert</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">load_der_x509_certificate</span><span class="p">(</span><span class="n">der_cert</span><span class="p">,</span> <span class="n">default_backend</span><span class="p">())</span>
<a id="__codelineno-53-123" name="__codelineno-53-123" href="#__codelineno-53-123"></a>
<a id="__codelineno-53-124" name="__codelineno-53-124" href="#__codelineno-53-124"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Certificate Chain:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-125" name="__codelineno-53-125" href="#__codelineno-53-125"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-53-126" name="__codelineno-53-126" href="#__codelineno-53-126"></a>
<a id="__codelineno-53-127" name="__codelineno-53-127" href="#__codelineno-53-127"></a>            <span class="c1"># Server Certificate (end-entity)</span>
<a id="__codelineno-53-128" name="__codelineno-53-128" href="#__codelineno-53-128"></a>            <span class="n">subject_cn</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">subject</span><span class="o">.</span><span class="n">get_attributes_for_oid</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-53-129" name="__codelineno-53-129" href="#__codelineno-53-129"></a>            <span class="n">issuer_cn</span> <span class="o">=</span> <span class="n">cert</span><span class="o">.</span><span class="n">issuer</span><span class="o">.</span><span class="n">get_attributes_for_oid</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<a id="__codelineno-53-130" name="__codelineno-53-130" href="#__codelineno-53-130"></a>
<a id="__codelineno-53-131" name="__codelineno-53-131" href="#__codelineno-53-131"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Level 3: Server Certificate (End-Entity)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-132" name="__codelineno-53-132" href="#__codelineno-53-132"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Subject: </span><span class="si">{</span><span class="n">subject_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-133" name="__codelineno-53-133" href="#__codelineno-53-133"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Issuer:  </span><span class="si">{</span><span class="n">issuer_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-134" name="__codelineno-53-134" href="#__codelineno-53-134"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Purpose: TLS Server Authentication&quot;</span><span class="p">)</span>
<a id="__codelineno-53-135" name="__codelineno-53-135" href="#__codelineno-53-135"></a>
<a id="__codelineno-53-136" name="__codelineno-53-136" href="#__codelineno-53-136"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Level 2: Intermediate CA&quot;</span><span class="p">)</span>
<a id="__codelineno-53-137" name="__codelineno-53-137" href="#__codelineno-53-137"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Subject: </span><span class="si">{</span><span class="n">issuer_cn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-138" name="__codelineno-53-138" href="#__codelineno-53-138"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Purpose: Signs server certificates&quot;</span><span class="p">)</span>
<a id="__codelineno-53-139" name="__codelineno-53-139" href="#__codelineno-53-139"></a>
<a id="__codelineno-53-140" name="__codelineno-53-140" href="#__codelineno-53-140"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Level 1: Root CA&quot;</span><span class="p">)</span>
<a id="__codelineno-53-141" name="__codelineno-53-141" href="#__codelineno-53-141"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Purpose: Trust anchor (in browser/OS)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-142" name="__codelineno-53-142" href="#__codelineno-53-142"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Status: Self-signed&quot;</span><span class="p">)</span>
<a id="__codelineno-53-143" name="__codelineno-53-143" href="#__codelineno-53-143"></a>
<a id="__codelineno-53-144" name="__codelineno-53-144" href="#__codelineno-53-144"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Verification Result:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-145" name="__codelineno-53-145" href="#__codelineno-53-145"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Certificate chain is valid&quot;</span><span class="p">)</span>
<a id="__codelineno-53-146" name="__codelineno-53-146" href="#__codelineno-53-146"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    All signatures verified&quot;</span><span class="p">)</span>
<a id="__codelineno-53-147" name="__codelineno-53-147" href="#__codelineno-53-147"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Root CA is trusted&quot;</span><span class="p">)</span>
<a id="__codelineno-53-148" name="__codelineno-53-148" href="#__codelineno-53-148"></a>
<a id="__codelineno-53-149" name="__codelineno-53-149" href="#__codelineno-53-149"></a><span class="c1"># </span>
<a id="__codelineno-53-150" name="__codelineno-53-150" href="#__codelineno-53-150"></a><span class="c1"># Example 3: Generate Self-Signed Certificate (Testing)</span>
<a id="__codelineno-53-151" name="__codelineno-53-151" href="#__codelineno-53-151"></a><span class="c1"># </span>
<a id="__codelineno-53-152" name="__codelineno-53-152" href="#__codelineno-53-152"></a>
<a id="__codelineno-53-153" name="__codelineno-53-153" href="#__codelineno-53-153"></a><span class="k">def</span><span class="w"> </span><span class="nf">generate_self_signed_cert</span><span class="p">(</span><span class="n">common_name</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">):</span>
<a id="__codelineno-53-154" name="__codelineno-53-154" href="#__codelineno-53-154"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-53-155" name="__codelineno-53-155" href="#__codelineno-53-155"></a><span class="sd">    Generate self-signed certificate for testing</span>
<a id="__codelineno-53-156" name="__codelineno-53-156" href="#__codelineno-53-156"></a><span class="sd">      DO NOT use in production!</span>
<a id="__codelineno-53-157" name="__codelineno-53-157" href="#__codelineno-53-157"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-53-158" name="__codelineno-53-158" href="#__codelineno-53-158"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-159" name="__codelineno-53-159" href="#__codelineno-53-159"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating Self-Signed Certificate&quot;</span><span class="p">)</span>
<a id="__codelineno-53-160" name="__codelineno-53-160" href="#__codelineno-53-160"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-161" name="__codelineno-53-161" href="#__codelineno-53-161"></a>
<a id="__codelineno-53-162" name="__codelineno-53-162" href="#__codelineno-53-162"></a>    <span class="c1"># Generate private key</span>
<a id="__codelineno-53-163" name="__codelineno-53-163" href="#__codelineno-53-163"></a>    <span class="n">private_key</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">generate_private_key</span><span class="p">(</span>
<a id="__codelineno-53-164" name="__codelineno-53-164" href="#__codelineno-53-164"></a>        <span class="n">public_exponent</span><span class="o">=</span><span class="mi">65537</span><span class="p">,</span>
<a id="__codelineno-53-165" name="__codelineno-53-165" href="#__codelineno-53-165"></a>        <span class="n">key_size</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>
<a id="__codelineno-53-166" name="__codelineno-53-166" href="#__codelineno-53-166"></a>        <span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">()</span>
<a id="__codelineno-53-167" name="__codelineno-53-167" href="#__codelineno-53-167"></a>    <span class="p">)</span>
<a id="__codelineno-53-168" name="__codelineno-53-168" href="#__codelineno-53-168"></a>
<a id="__codelineno-53-169" name="__codelineno-53-169" href="#__codelineno-53-169"></a>    <span class="c1"># Create certificate</span>
<a id="__codelineno-53-170" name="__codelineno-53-170" href="#__codelineno-53-170"></a>    <span class="n">subject</span> <span class="o">=</span> <span class="n">issuer</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">Name</span><span class="p">([</span>
<a id="__codelineno-53-171" name="__codelineno-53-171" href="#__codelineno-53-171"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COUNTRY_NAME</span><span class="p">,</span> <span class="s2">&quot;US&quot;</span><span class="p">),</span>
<a id="__codelineno-53-172" name="__codelineno-53-172" href="#__codelineno-53-172"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">STATE_OR_PROVINCE_NAME</span><span class="p">,</span> <span class="s2">&quot;California&quot;</span><span class="p">),</span>
<a id="__codelineno-53-173" name="__codelineno-53-173" href="#__codelineno-53-173"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">LOCALITY_NAME</span><span class="p">,</span> <span class="s2">&quot;San Francisco&quot;</span><span class="p">),</span>
<a id="__codelineno-53-174" name="__codelineno-53-174" href="#__codelineno-53-174"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">ORGANIZATION_NAME</span><span class="p">,</span> <span class="s2">&quot;Test Org&quot;</span><span class="p">),</span>
<a id="__codelineno-53-175" name="__codelineno-53-175" href="#__codelineno-53-175"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">NameAttribute</span><span class="p">(</span><span class="n">NameOID</span><span class="o">.</span><span class="n">COMMON_NAME</span><span class="p">,</span> <span class="n">common_name</span><span class="p">),</span>
<a id="__codelineno-53-176" name="__codelineno-53-176" href="#__codelineno-53-176"></a>    <span class="p">])</span>
<a id="__codelineno-53-177" name="__codelineno-53-177" href="#__codelineno-53-177"></a>
<a id="__codelineno-53-178" name="__codelineno-53-178" href="#__codelineno-53-178"></a>    <span class="n">cert</span> <span class="o">=</span> <span class="n">x509</span><span class="o">.</span><span class="n">CertificateBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">subject_name</span><span class="p">(</span>
<a id="__codelineno-53-179" name="__codelineno-53-179" href="#__codelineno-53-179"></a>        <span class="n">subject</span>
<a id="__codelineno-53-180" name="__codelineno-53-180" href="#__codelineno-53-180"></a>    <span class="p">)</span><span class="o">.</span><span class="n">issuer_name</span><span class="p">(</span>
<a id="__codelineno-53-181" name="__codelineno-53-181" href="#__codelineno-53-181"></a>        <span class="n">issuer</span>
<a id="__codelineno-53-182" name="__codelineno-53-182" href="#__codelineno-53-182"></a>    <span class="p">)</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span>
<a id="__codelineno-53-183" name="__codelineno-53-183" href="#__codelineno-53-183"></a>        <span class="n">private_key</span><span class="o">.</span><span class="n">public_key</span><span class="p">()</span>
<a id="__codelineno-53-184" name="__codelineno-53-184" href="#__codelineno-53-184"></a>    <span class="p">)</span><span class="o">.</span><span class="n">serial_number</span><span class="p">(</span>
<a id="__codelineno-53-185" name="__codelineno-53-185" href="#__codelineno-53-185"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">random_serial_number</span><span class="p">()</span>
<a id="__codelineno-53-186" name="__codelineno-53-186" href="#__codelineno-53-186"></a>    <span class="p">)</span><span class="o">.</span><span class="n">not_valid_before</span><span class="p">(</span>
<a id="__codelineno-53-187" name="__codelineno-53-187" href="#__codelineno-53-187"></a>        <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
<a id="__codelineno-53-188" name="__codelineno-53-188" href="#__codelineno-53-188"></a>    <span class="p">)</span><span class="o">.</span><span class="n">not_valid_after</span><span class="p">(</span>
<a id="__codelineno-53-189" name="__codelineno-53-189" href="#__codelineno-53-189"></a>        <span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">365</span><span class="p">)</span>
<a id="__codelineno-53-190" name="__codelineno-53-190" href="#__codelineno-53-190"></a>    <span class="p">)</span><span class="o">.</span><span class="n">add_extension</span><span class="p">(</span>
<a id="__codelineno-53-191" name="__codelineno-53-191" href="#__codelineno-53-191"></a>        <span class="n">x509</span><span class="o">.</span><span class="n">SubjectAlternativeName</span><span class="p">([</span>
<a id="__codelineno-53-192" name="__codelineno-53-192" href="#__codelineno-53-192"></a>            <span class="n">x509</span><span class="o">.</span><span class="n">DNSName</span><span class="p">(</span><span class="n">common_name</span><span class="p">),</span>
<a id="__codelineno-53-193" name="__codelineno-53-193" href="#__codelineno-53-193"></a>        <span class="p">]),</span>
<a id="__codelineno-53-194" name="__codelineno-53-194" href="#__codelineno-53-194"></a>        <span class="n">critical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-53-195" name="__codelineno-53-195" href="#__codelineno-53-195"></a>    <span class="p">)</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">private_key</span><span class="p">,</span> <span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span> <span class="n">default_backend</span><span class="p">())</span>
<a id="__codelineno-53-196" name="__codelineno-53-196" href="#__codelineno-53-196"></a>
<a id="__codelineno-53-197" name="__codelineno-53-197" href="#__codelineno-53-197"></a>    <span class="c1"># Save private key</span>
<a id="__codelineno-53-198" name="__codelineno-53-198" href="#__codelineno-53-198"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test-private-key.pem&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-53-199" name="__codelineno-53-199" href="#__codelineno-53-199"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">private_key</span><span class="o">.</span><span class="n">private_bytes</span><span class="p">(</span>
<a id="__codelineno-53-200" name="__codelineno-53-200" href="#__codelineno-53-200"></a>            <span class="n">encoding</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">,</span>
<a id="__codelineno-53-201" name="__codelineno-53-201" href="#__codelineno-53-201"></a>            <span class="nb">format</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">PrivateFormat</span><span class="o">.</span><span class="n">TraditionalOpenSSL</span><span class="p">,</span>
<a id="__codelineno-53-202" name="__codelineno-53-202" href="#__codelineno-53-202"></a>            <span class="n">encryption_algorithm</span><span class="o">=</span><span class="n">serialization</span><span class="o">.</span><span class="n">NoEncryption</span><span class="p">()</span>
<a id="__codelineno-53-203" name="__codelineno-53-203" href="#__codelineno-53-203"></a>        <span class="p">))</span>
<a id="__codelineno-53-204" name="__codelineno-53-204" href="#__codelineno-53-204"></a>
<a id="__codelineno-53-205" name="__codelineno-53-205" href="#__codelineno-53-205"></a>    <span class="c1"># Save certificate</span>
<a id="__codelineno-53-206" name="__codelineno-53-206" href="#__codelineno-53-206"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test-certificate.pem&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<a id="__codelineno-53-207" name="__codelineno-53-207" href="#__codelineno-53-207"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cert</span><span class="o">.</span><span class="n">public_bytes</span><span class="p">(</span><span class="n">serialization</span><span class="o">.</span><span class="n">Encoding</span><span class="o">.</span><span class="n">PEM</span><span class="p">))</span>
<a id="__codelineno-53-208" name="__codelineno-53-208" href="#__codelineno-53-208"></a>
<a id="__codelineno-53-209" name="__codelineno-53-209" href="#__codelineno-53-209"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Generated:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-210" name="__codelineno-53-210" href="#__codelineno-53-210"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    test-private-key.pem (Private Key)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-211" name="__codelineno-53-211" href="#__codelineno-53-211"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    test-certificate.pem (Certificate)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-212" name="__codelineno-53-212" href="#__codelineno-53-212"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Self-signed certificate is for TESTING only!&quot;</span><span class="p">)</span>
<a id="__codelineno-53-213" name="__codelineno-53-213" href="#__codelineno-53-213"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;   Browsers will show security warnings.&quot;</span><span class="p">)</span>
<a id="__codelineno-53-214" name="__codelineno-53-214" href="#__codelineno-53-214"></a>
<a id="__codelineno-53-215" name="__codelineno-53-215" href="#__codelineno-53-215"></a><span class="c1"># </span>
<a id="__codelineno-53-216" name="__codelineno-53-216" href="#__codelineno-53-216"></a><span class="c1"># Example 4: Verify HTTPS Connection</span>
<a id="__codelineno-53-217" name="__codelineno-53-217" href="#__codelineno-53-217"></a><span class="c1"># </span>
<a id="__codelineno-53-218" name="__codelineno-53-218" href="#__codelineno-53-218"></a>
<a id="__codelineno-53-219" name="__codelineno-53-219" href="#__codelineno-53-219"></a><span class="k">def</span><span class="w"> </span><span class="nf">verify_https_connection</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
<a id="__codelineno-53-220" name="__codelineno-53-220" href="#__codelineno-53-220"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-53-221" name="__codelineno-53-221" href="#__codelineno-53-221"></a><span class="sd">    Make HTTPS request and verify certificate</span>
<a id="__codelineno-53-222" name="__codelineno-53-222" href="#__codelineno-53-222"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-53-223" name="__codelineno-53-223" href="#__codelineno-53-223"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-224" name="__codelineno-53-224" href="#__codelineno-53-224"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Verifying HTTPS Connection&quot;</span><span class="p">)</span>
<a id="__codelineno-53-225" name="__codelineno-53-225" href="#__codelineno-53-225"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-226" name="__codelineno-53-226" href="#__codelineno-53-226"></a>
<a id="__codelineno-53-227" name="__codelineno-53-227" href="#__codelineno-53-227"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-53-228" name="__codelineno-53-228" href="#__codelineno-53-228"></a>        <span class="c1"># Make request (verifies certificate automatically)</span>
<a id="__codelineno-53-229" name="__codelineno-53-229" href="#__codelineno-53-229"></a>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<a id="__codelineno-53-230" name="__codelineno-53-230" href="#__codelineno-53-230"></a>
<a id="__codelineno-53-231" name="__codelineno-53-231" href="#__codelineno-53-231"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; HTTPS Connection Successful&quot;</span><span class="p">)</span>
<a id="__codelineno-53-232" name="__codelineno-53-232" href="#__codelineno-53-232"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   URL: </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-233" name="__codelineno-53-233" href="#__codelineno-53-233"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Status: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-234" name="__codelineno-53-234" href="#__codelineno-53-234"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Certificate: Valid and Trusted&quot;</span><span class="p">)</span>
<a id="__codelineno-53-235" name="__codelineno-53-235" href="#__codelineno-53-235"></a>
<a id="__codelineno-53-236" name="__codelineno-53-236" href="#__codelineno-53-236"></a>    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">SSLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-53-237" name="__codelineno-53-237" href="#__codelineno-53-237"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; SSL Certificate Error!&quot;</span><span class="p">)</span>
<a id="__codelineno-53-238" name="__codelineno-53-238" href="#__codelineno-53-238"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-239" name="__codelineno-53-239" href="#__codelineno-53-239"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Possible causes:&quot;</span><span class="p">)</span>
<a id="__codelineno-53-240" name="__codelineno-53-240" href="#__codelineno-53-240"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Expired certificate&quot;</span><span class="p">)</span>
<a id="__codelineno-53-241" name="__codelineno-53-241" href="#__codelineno-53-241"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Self-signed certificate&quot;</span><span class="p">)</span>
<a id="__codelineno-53-242" name="__codelineno-53-242" href="#__codelineno-53-242"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Hostname mismatch&quot;</span><span class="p">)</span>
<a id="__codelineno-53-243" name="__codelineno-53-243" href="#__codelineno-53-243"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Untrusted CA&quot;</span><span class="p">)</span>
<a id="__codelineno-53-244" name="__codelineno-53-244" href="#__codelineno-53-244"></a>
<a id="__codelineno-53-245" name="__codelineno-53-245" href="#__codelineno-53-245"></a><span class="c1"># </span>
<a id="__codelineno-53-246" name="__codelineno-53-246" href="#__codelineno-53-246"></a><span class="c1"># Example 5: Compare HTTP vs HTTPS Security</span>
<a id="__codelineno-53-247" name="__codelineno-53-247" href="#__codelineno-53-247"></a><span class="c1"># </span>
<a id="__codelineno-53-248" name="__codelineno-53-248" href="#__codelineno-53-248"></a>
<a id="__codelineno-53-249" name="__codelineno-53-249" href="#__codelineno-53-249"></a><span class="k">def</span><span class="w"> </span><span class="nf">demonstrate_http_vs_https</span><span class="p">():</span>
<a id="__codelineno-53-250" name="__codelineno-53-250" href="#__codelineno-53-250"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-53-251" name="__codelineno-53-251" href="#__codelineno-53-251"></a><span class="sd">    Demonstrate difference between HTTP and HTTPS</span>
<a id="__codelineno-53-252" name="__codelineno-53-252" href="#__codelineno-53-252"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-53-253" name="__codelineno-53-253" href="#__codelineno-53-253"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-254" name="__codelineno-53-254" href="#__codelineno-53-254"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;HTTP vs HTTPS Security Demonstration&quot;</span><span class="p">)</span>
<a id="__codelineno-53-255" name="__codelineno-53-255" href="#__codelineno-53-255"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-256" name="__codelineno-53-256" href="#__codelineno-53-256"></a>
<a id="__codelineno-53-257" name="__codelineno-53-257" href="#__codelineno-53-257"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HTTP (Insecure):&quot;</span><span class="p">)</span>
<a id="__codelineno-53-258" name="__codelineno-53-258" href="#__codelineno-53-258"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-53-259" name="__codelineno-53-259" href="#__codelineno-53-259"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; No Encryption&quot;</span><span class="p">)</span>
<a id="__codelineno-53-260" name="__codelineno-53-260" href="#__codelineno-53-260"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Data sent in plaintext&quot;</span><span class="p">)</span>
<a id="__codelineno-53-261" name="__codelineno-53-261" href="#__codelineno-53-261"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Passwords visible to attackers&quot;</span><span class="p">)</span>
<a id="__codelineno-53-262" name="__codelineno-53-262" href="#__codelineno-53-262"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Subject to man-in-the-middle attacks&quot;</span><span class="p">)</span>
<a id="__codelineno-53-263" name="__codelineno-53-263" href="#__codelineno-53-263"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> No Authentication&quot;</span><span class="p">)</span>
<a id="__codelineno-53-264" name="__codelineno-53-264" href="#__codelineno-53-264"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Cannot verify server identity&quot;</span><span class="p">)</span>
<a id="__codelineno-53-265" name="__codelineno-53-265" href="#__codelineno-53-265"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Easy to impersonate&quot;</span><span class="p">)</span>
<a id="__codelineno-53-266" name="__codelineno-53-266" href="#__codelineno-53-266"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> No Integrity&quot;</span><span class="p">)</span>
<a id="__codelineno-53-267" name="__codelineno-53-267" href="#__codelineno-53-267"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Data can be modified in transit&quot;</span><span class="p">)</span>
<a id="__codelineno-53-268" name="__codelineno-53-268" href="#__codelineno-53-268"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    No tamper detection&quot;</span><span class="p">)</span>
<a id="__codelineno-53-269" name="__codelineno-53-269" href="#__codelineno-53-269"></a>
<a id="__codelineno-53-270" name="__codelineno-53-270" href="#__codelineno-53-270"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-271" name="__codelineno-53-271" href="#__codelineno-53-271"></a>
<a id="__codelineno-53-272" name="__codelineno-53-272" href="#__codelineno-53-272"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HTTPS (Secure):&quot;</span><span class="p">)</span>
<a id="__codelineno-53-273" name="__codelineno-53-273" href="#__codelineno-53-273"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">*</span><span class="mi">70</span><span class="p">)</span>
<a id="__codelineno-53-274" name="__codelineno-53-274" href="#__codelineno-53-274"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Encryption (TLS)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-275" name="__codelineno-53-275" href="#__codelineno-53-275"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    All data encrypted with AES-256&quot;</span><span class="p">)</span>
<a id="__codelineno-53-276" name="__codelineno-53-276" href="#__codelineno-53-276"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Passwords protected&quot;</span><span class="p">)</span>
<a id="__codelineno-53-277" name="__codelineno-53-277" href="#__codelineno-53-277"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Prevents eavesdropping&quot;</span><span class="p">)</span>
<a id="__codelineno-53-278" name="__codelineno-53-278" href="#__codelineno-53-278"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Authentication (Certificates)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-279" name="__codelineno-53-279" href="#__codelineno-53-279"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Server identity verified&quot;</span><span class="p">)</span>
<a id="__codelineno-53-280" name="__codelineno-53-280" href="#__codelineno-53-280"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Signed by trusted CA&quot;</span><span class="p">)</span>
<a id="__codelineno-53-281" name="__codelineno-53-281" href="#__codelineno-53-281"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Domain name validated&quot;</span><span class="p">)</span>
<a id="__codelineno-53-282" name="__codelineno-53-282" href="#__codelineno-53-282"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Integrity (HMAC)&quot;</span><span class="p">)</span>
<a id="__codelineno-53-283" name="__codelineno-53-283" href="#__codelineno-53-283"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Detects any modification&quot;</span><span class="p">)</span>
<a id="__codelineno-53-284" name="__codelineno-53-284" href="#__codelineno-53-284"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Message authentication code&quot;</span><span class="p">)</span>
<a id="__codelineno-53-285" name="__codelineno-53-285" href="#__codelineno-53-285"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Ensures data arrives unchanged&quot;</span><span class="p">)</span>
<a id="__codelineno-53-286" name="__codelineno-53-286" href="#__codelineno-53-286"></a>
<a id="__codelineno-53-287" name="__codelineno-53-287" href="#__codelineno-53-287"></a><span class="c1"># </span>
<a id="__codelineno-53-288" name="__codelineno-53-288" href="#__codelineno-53-288"></a><span class="c1"># Main Demonstration</span>
<a id="__codelineno-53-289" name="__codelineno-53-289" href="#__codelineno-53-289"></a><span class="c1"># </span>
<a id="__codelineno-53-290" name="__codelineno-53-290" href="#__codelineno-53-290"></a>
<a id="__codelineno-53-291" name="__codelineno-53-291" href="#__codelineno-53-291"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-53-292" name="__codelineno-53-292" href="#__codelineno-53-292"></a>    <span class="c1"># Example 1: Get certificate info</span>
<a id="__codelineno-53-293" name="__codelineno-53-293" href="#__codelineno-53-293"></a>    <span class="n">get_server_certificate</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
<a id="__codelineno-53-294" name="__codelineno-53-294" href="#__codelineno-53-294"></a>
<a id="__codelineno-53-295" name="__codelineno-53-295" href="#__codelineno-53-295"></a>    <span class="c1"># Example 2: Verify chain</span>
<a id="__codelineno-53-296" name="__codelineno-53-296" href="#__codelineno-53-296"></a>    <span class="n">verify_certificate_chain</span><span class="p">(</span><span class="s2">&quot;www.google.com&quot;</span><span class="p">)</span>
<a id="__codelineno-53-297" name="__codelineno-53-297" href="#__codelineno-53-297"></a>
<a id="__codelineno-53-298" name="__codelineno-53-298" href="#__codelineno-53-298"></a>    <span class="c1"># Example 3: Generate self-signed cert for testing</span>
<a id="__codelineno-53-299" name="__codelineno-53-299" href="#__codelineno-53-299"></a>    <span class="c1"># generate_self_signed_cert(&quot;localhost&quot;)</span>
<a id="__codelineno-53-300" name="__codelineno-53-300" href="#__codelineno-53-300"></a>
<a id="__codelineno-53-301" name="__codelineno-53-301" href="#__codelineno-53-301"></a>    <span class="c1"># Example 4: Verify HTTPS</span>
<a id="__codelineno-53-302" name="__codelineno-53-302" href="#__codelineno-53-302"></a>    <span class="n">verify_https_connection</span><span class="p">(</span><span class="s2">&quot;https://www.google.com&quot;</span><span class="p">)</span>
<a id="__codelineno-53-303" name="__codelineno-53-303" href="#__codelineno-53-303"></a>
<a id="__codelineno-53-304" name="__codelineno-53-304" href="#__codelineno-53-304"></a>    <span class="c1"># Example 5: HTTP vs HTTPS</span>
<a id="__codelineno-53-305" name="__codelineno-53-305" href="#__codelineno-53-305"></a>    <span class="n">demonstrate_http_vs_https</span><span class="p">()</span>
<a id="__codelineno-53-306" name="__codelineno-53-306" href="#__codelineno-53-306"></a>
<a id="__codelineno-53-307" name="__codelineno-53-307" href="#__codelineno-53-307"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-308" name="__codelineno-53-308" href="#__codelineno-53-308"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KEY TAKEAWAYS&quot;</span><span class="p">)</span>
<a id="__codelineno-53-309" name="__codelineno-53-309" href="#__codelineno-53-309"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">70</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-53-310" name="__codelineno-53-310" href="#__codelineno-53-310"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<a id="__codelineno-53-311" name="__codelineno-53-311" href="#__codelineno-53-311"></a><span class="s2">    CERTIFICATES PROVIDE:</span>
<a id="__codelineno-53-312" name="__codelineno-53-312" href="#__codelineno-53-312"></a><span class="s2">     Identity verification (who you&#39;re connecting to)</span>
<a id="__codelineno-53-313" name="__codelineno-53-313" href="#__codelineno-53-313"></a><span class="s2">     Public key distribution (how to encrypt)</span>
<a id="__codelineno-53-314" name="__codelineno-53-314" href="#__codelineno-53-314"></a><span class="s2">     Trust chain (why you should trust them)</span>
<a id="__codelineno-53-315" name="__codelineno-53-315" href="#__codelineno-53-315"></a>
<a id="__codelineno-53-316" name="__codelineno-53-316" href="#__codelineno-53-316"></a><span class="s2">    HTTPS USES:</span>
<a id="__codelineno-53-317" name="__codelineno-53-317" href="#__codelineno-53-317"></a><span class="s2">     Asymmetric encryption (handshake, key exchange)</span>
<a id="__codelineno-53-318" name="__codelineno-53-318" href="#__codelineno-53-318"></a><span class="s2">     Symmetric encryption (data transfer)</span>
<a id="__codelineno-53-319" name="__codelineno-53-319" href="#__codelineno-53-319"></a><span class="s2">     Digital certificates (authentication)</span>
<a id="__codelineno-53-320" name="__codelineno-53-320" href="#__codelineno-53-320"></a><span class="s2">     Best of all worlds!</span>
<a id="__codelineno-53-321" name="__codelineno-53-321" href="#__codelineno-53-321"></a>
<a id="__codelineno-53-322" name="__codelineno-53-322" href="#__codelineno-53-322"></a><span class="s2">    CERTIFICATE TYPES:</span>
<a id="__codelineno-53-323" name="__codelineno-53-323" href="#__codelineno-53-323"></a><span class="s2">     Root CA: Trust anchor, pre-installed</span>
<a id="__codelineno-53-324" name="__codelineno-53-324" href="#__codelineno-53-324"></a><span class="s2">     Intermediate CA: Issues certificates</span>
<a id="__codelineno-53-325" name="__codelineno-53-325" href="#__codelineno-53-325"></a><span class="s2">     Server: Proves website identity</span>
<a id="__codelineno-53-326" name="__codelineno-53-326" href="#__codelineno-53-326"></a><span class="s2">     Client: Proves user identity (mTLS)</span>
<a id="__codelineno-53-327" name="__codelineno-53-327" href="#__codelineno-53-327"></a><span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Key Concepts Summary:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>
<a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>                  CERTIFICATES SUMMARY                        
<a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a>
<a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a>
<a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a>ROOT CA CERTIFICATE:
<a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>
<a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a>Purpose: Trust anchor
<a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a>Location: Pre-installed in OS/browser
<a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a>Validity: 20-30 years
<a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a>Usage: Signs intermediate CAs only
<a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a>Example: DigiCert Global Root CA
<a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a>
<a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>INTERMEDIATE CA CERTIFICATE:
<a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a>
<a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a>Purpose: Issue end-entity certificates
<a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a>Location: Sent by server during TLS
<a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a>Validity: 5-10 years
<a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a>Usage: Signs server/client certificates
<a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a>Example: DigiCert TLS RSA SHA256 CA
<a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a>
<a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a>SERVER CERTIFICATE:
<a id="__codelineno-54-22" name="__codelineno-54-22" href="#__codelineno-54-22"></a>
<a id="__codelineno-54-23" name="__codelineno-54-23" href="#__codelineno-54-23"></a>Purpose: Prove server identity
<a id="__codelineno-54-24" name="__codelineno-54-24" href="#__codelineno-54-24"></a>Location: Installed on web server
<a id="__codelineno-54-25" name="__codelineno-54-25" href="#__codelineno-54-25"></a>Validity: 90 days - 1 year
<a id="__codelineno-54-26" name="__codelineno-54-26" href="#__codelineno-54-26"></a>Usage: TLS/HTTPS connections
<a id="__codelineno-54-27" name="__codelineno-54-27" href="#__codelineno-54-27"></a>Example: www.example.com certificate
<a id="__codelineno-54-28" name="__codelineno-54-28" href="#__codelineno-54-28"></a>
<a id="__codelineno-54-29" name="__codelineno-54-29" href="#__codelineno-54-29"></a>CLIENT CERTIFICATE:
<a id="__codelineno-54-30" name="__codelineno-54-30" href="#__codelineno-54-30"></a>
<a id="__codelineno-54-31" name="__codelineno-54-31" href="#__codelineno-54-31"></a>Purpose: Prove client identity
<a id="__codelineno-54-32" name="__codelineno-54-32" href="#__codelineno-54-32"></a>Location: On user&#39;s device
<a id="__codelineno-54-33" name="__codelineno-54-33" href="#__codelineno-54-33"></a>Validity: 1-3 years
<a id="__codelineno-54-34" name="__codelineno-54-34" href="#__codelineno-54-34"></a>Usage: Mutual TLS (mTLS), VPN
<a id="__codelineno-54-35" name="__codelineno-54-35" href="#__codelineno-54-35"></a>Example: Employee certificate
<a id="__codelineno-54-36" name="__codelineno-54-36" href="#__codelineno-54-36"></a>
<a id="__codelineno-54-37" name="__codelineno-54-37" href="#__codelineno-54-37"></a>HOW THEY WORK TOGETHER:
<a id="__codelineno-54-38" name="__codelineno-54-38" href="#__codelineno-54-38"></a>
<a id="__codelineno-54-39" name="__codelineno-54-39" href="#__codelineno-54-39"></a>1. Server sends: Server Cert + Intermediate Cert
<a id="__codelineno-54-40" name="__codelineno-54-40" href="#__codelineno-54-40"></a>2. Browser verifies: Chain up to Root CA
<a id="__codelineno-54-41" name="__codelineno-54-41" href="#__codelineno-54-41"></a>3. Browser trusts: Root CA in trust store
<a id="__codelineno-54-42" name="__codelineno-54-42" href="#__codelineno-54-42"></a>4. Result:  Trusted connection
<a id="__codelineno-54-43" name="__codelineno-54-43" href="#__codelineno-54-43"></a>5. Encryption: Asymmetric  Symmetric
<a id="__codelineno-54-44" name="__codelineno-54-44" href="#__codelineno-54-44"></a>6. Data transfer: Fast and secure!
</code></pre></div>
<h4 id="modern-tls-13-improvements">Modern TLS 1.3 Improvements</h4>
<p><strong>TLS 1.3 Handshake (Faster):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>TLS 1.2 (Old):                    TLS 1.3 (New):
<a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>                     
<a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>
<a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>2 Round Trips:                    1 Round Trip:
<a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>
<a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>Client  Hello                  Client  Hello + Key Share
<a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>        Hello, Cert, Key                Hello, Cert, Finished
<a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>Client  Key, Finished          
<a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>        Finished                Data (Encrypted)
<a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>
<a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a> Data (Encrypted)              50% faster connection!
<a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>
<a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a>Improvements:
<a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a> Faster handshake (1-RTT vs 2-RTT)
<a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a> Stronger ciphers only
<a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a> Perfect Forward Secrecy mandatory
<a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a> Removed insecure features
</code></pre></div>
<h3 id="digital-certificates-in-https">Digital Certificates in HTTPS</h3>
<p><strong>What is a Digital Certificate?</strong></p>
<p>A digital certificate is a <strong>digital identity card</strong> that proves the server's identity. It contains the server's public key and is signed by a trusted Certificate Authority (CA).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>
<a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>              Digital Certificate Structure                   
<a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>
<a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>
<a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>
<a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>           X.509 Certificate                            
<a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>
<a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>                                                        
<a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>  1. VERSION                                            
<a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>     Version: 3                                         
<a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a>                                                        
<a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>  2. SERIAL NUMBER                                      
<a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>     Serial: 04:3B:7F:23:A8:...                        
<a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a>                                                        
<a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a>  3. SIGNATURE ALGORITHM                                
<a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a>     Algorithm: sha256WithRSAEncryption                 
<a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a>                                                        
<a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a>  4. ISSUER (Certificate Authority)                     
<a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>     CN = DigiCert Global Root CA                       
<a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a>     O  = DigiCert Inc                                  
<a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a>     C  = US                                            
<a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a>                                                        
<a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a>  5. VALIDITY PERIOD                                    
<a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a>     Not Before: Jan 1 00:00:00 2024 GMT               
<a id="__codelineno-56-25" name="__codelineno-56-25" href="#__codelineno-56-25"></a>     Not After:  Jan 1 23:59:59 2025 GMT               
<a id="__codelineno-56-26" name="__codelineno-56-26" href="#__codelineno-56-26"></a>                                                        
<a id="__codelineno-56-27" name="__codelineno-56-27" href="#__codelineno-56-27"></a>  6. SUBJECT (Server Identity)                          
<a id="__codelineno-56-28" name="__codelineno-56-28" href="#__codelineno-56-28"></a>     CN = www.example.com                               
<a id="__codelineno-56-29" name="__codelineno-56-29" href="#__codelineno-56-29"></a>     O  = Example Corp                                  
<a id="__codelineno-56-30" name="__codelineno-56-30" href="#__codelineno-56-30"></a>     L  = San Francisco                                 
<a id="__codelineno-56-31" name="__codelineno-56-31" href="#__codelineno-56-31"></a>     ST = California                                    
<a id="__codelineno-56-32" name="__codelineno-56-32" href="#__codelineno-56-32"></a>     C  = US                                            
<a id="__codelineno-56-33" name="__codelineno-56-33" href="#__codelineno-56-33"></a>                                                        
<a id="__codelineno-56-34" name="__codelineno-56-34" href="#__codelineno-56-34"></a>  7. PUBLIC KEY INFO                                    
<a id="__codelineno-56-35" name="__codelineno-56-35" href="#__codelineno-56-35"></a>     Algorithm: RSA                                     
<a id="__codelineno-56-36" name="__codelineno-56-36" href="#__codelineno-56-36"></a>     Key Size: 2048 bits                                
<a id="__codelineno-56-37" name="__codelineno-56-37" href="#__codelineno-56-37"></a>     Public Key: 30:82:01:0A:02:82:01:01:00:...        
<a id="__codelineno-56-38" name="__codelineno-56-38" href="#__codelineno-56-38"></a>                                                        
<a id="__codelineno-56-39" name="__codelineno-56-39" href="#__codelineno-56-39"></a>  8. EXTENSIONS                                         
<a id="__codelineno-56-40" name="__codelineno-56-40" href="#__codelineno-56-40"></a>     a) Subject Alternative Names (SAN)                 
<a id="__codelineno-56-41" name="__codelineno-56-41" href="#__codelineno-56-41"></a>        DNS: www.example.com                            
<a id="__codelineno-56-42" name="__codelineno-56-42" href="#__codelineno-56-42"></a>        DNS: example.com                                
<a id="__codelineno-56-43" name="__codelineno-56-43" href="#__codelineno-56-43"></a>        DNS: *.example.com                              
<a id="__codelineno-56-44" name="__codelineno-56-44" href="#__codelineno-56-44"></a>                                                        
<a id="__codelineno-56-45" name="__codelineno-56-45" href="#__codelineno-56-45"></a>     b) Key Usage                                       
<a id="__codelineno-56-46" name="__codelineno-56-46" href="#__codelineno-56-46"></a>        Digital Signature, Key Encipherment             
<a id="__codelineno-56-47" name="__codelineno-56-47" href="#__codelineno-56-47"></a>                                                        
<a id="__codelineno-56-48" name="__codelineno-56-48" href="#__codelineno-56-48"></a>     c) Extended Key Usage                              
<a id="__codelineno-56-49" name="__codelineno-56-49" href="#__codelineno-56-49"></a>        TLS Web Server Authentication                   
<a id="__codelineno-56-50" name="__codelineno-56-50" href="#__codelineno-56-50"></a>                                                        
<a id="__codelineno-56-51" name="__codelineno-56-51" href="#__codelineno-56-51"></a>     d) Authority Key Identifier                        
<a id="__codelineno-56-52" name="__codelineno-56-52" href="#__codelineno-56-52"></a>        KeyID: 03:DE:50:35:56:D1:...                   
<a id="__codelineno-56-53" name="__codelineno-56-53" href="#__codelineno-56-53"></a>                                                        
<a id="__codelineno-56-54" name="__codelineno-56-54" href="#__codelineno-56-54"></a>  9. CA SIGNATURE                                       
<a id="__codelineno-56-55" name="__codelineno-56-55" href="#__codelineno-56-55"></a>     Signature: 8F:2A:B3:C4:...                        
<a id="__codelineno-56-56" name="__codelineno-56-56" href="#__codelineno-56-56"></a>     (Signed with CA&#39;s Private Key)                     
<a id="__codelineno-56-57" name="__codelineno-56-57" href="#__codelineno-56-57"></a>                                                        
<a id="__codelineno-56-58" name="__codelineno-56-58" href="#__codelineno-56-58"></a>
</code></pre></div>
<h4 id="certificate-components-explained">Certificate Components Explained</h4>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Version</strong></td>
<td>X.509 certificate version</td>
<td>v3 (most common)</td>
</tr>
<tr>
<td><strong>Serial Number</strong></td>
<td>Unique identifier for certificate</td>
<td>04:3B:7F:23:A8...</td>
</tr>
<tr>
<td><strong>Signature Algorithm</strong></td>
<td>Algorithm used by CA to sign</td>
<td>SHA-256 with RSA</td>
</tr>
<tr>
<td><strong>Issuer</strong></td>
<td>Certificate Authority that issued cert</td>
<td>DigiCert, Let's Encrypt</td>
</tr>
<tr>
<td><strong>Validity Period</strong></td>
<td>Start and end dates</td>
<td>Jan 1, 2024 - Jan 1, 2025</td>
</tr>
<tr>
<td><strong>Subject</strong></td>
<td>Entity the certificate identifies</td>
<td>www.example.com</td>
</tr>
<tr>
<td><strong>Public Key</strong></td>
<td>Server's public key</td>
<td>2048-bit RSA key</td>
</tr>
<tr>
<td><strong>Extensions</strong></td>
<td>Additional information</td>
<td>SANs, Key Usage, etc.</td>
</tr>
<tr>
<td><strong>CA Signature</strong></td>
<td>Digital signature by CA</td>
<td>Proves authenticity</td>
</tr>
</tbody>
</table>
<h4 id="certificate-trust-chain">Certificate Trust Chain</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>
<a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>           Certificate Trust Chain (PKI)                      
<a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>
<a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>
<a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>                  
<a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>                     ROOT CA            
<a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>                    (Self-Signed)       
<a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a>                                        
<a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a>                   &quot;DigiCert Root CA&quot;   
<a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a>                        
<a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a>                     Public Key       
<a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a>                     Private Key      
<a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a>                        
<a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a>                  
<a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a>                              Signs
<a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a>                              (with private key)
<a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a>                             
<a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a>                  
<a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a>                   INTERMEDIATE CA      
<a id="__codelineno-57-20" name="__codelineno-57-20" href="#__codelineno-57-20"></a>                                        
<a id="__codelineno-57-21" name="__codelineno-57-21" href="#__codelineno-57-21"></a>                   &quot;DigiCert SHA2       
<a id="__codelineno-57-22" name="__codelineno-57-22" href="#__codelineno-57-22"></a>                    Secure Server CA&quot;   
<a id="__codelineno-57-23" name="__codelineno-57-23" href="#__codelineno-57-23"></a>                        
<a id="__codelineno-57-24" name="__codelineno-57-24" href="#__codelineno-57-24"></a>                     Public Key       
<a id="__codelineno-57-25" name="__codelineno-57-25" href="#__codelineno-57-25"></a>                     Private Key      
<a id="__codelineno-57-26" name="__codelineno-57-26" href="#__codelineno-57-26"></a>                        
<a id="__codelineno-57-27" name="__codelineno-57-27" href="#__codelineno-57-27"></a>                  
<a id="__codelineno-57-28" name="__codelineno-57-28" href="#__codelineno-57-28"></a>                              Signs
<a id="__codelineno-57-29" name="__codelineno-57-29" href="#__codelineno-57-29"></a>                              (with private key)
<a id="__codelineno-57-30" name="__codelineno-57-30" href="#__codelineno-57-30"></a>                             
<a id="__codelineno-57-31" name="__codelineno-57-31" href="#__codelineno-57-31"></a>                  
<a id="__codelineno-57-32" name="__codelineno-57-32" href="#__codelineno-57-32"></a>                    SERVER CERTIFICATE  
<a id="__codelineno-57-33" name="__codelineno-57-33" href="#__codelineno-57-33"></a>                                        
<a id="__codelineno-57-34" name="__codelineno-57-34" href="#__codelineno-57-34"></a>                   &quot;www.example.com&quot;    
<a id="__codelineno-57-35" name="__codelineno-57-35" href="#__codelineno-57-35"></a>                        
<a id="__codelineno-57-36" name="__codelineno-57-36" href="#__codelineno-57-36"></a>                     Public Key       
<a id="__codelineno-57-37" name="__codelineno-57-37" href="#__codelineno-57-37"></a>                        
<a id="__codelineno-57-38" name="__codelineno-57-38" href="#__codelineno-57-38"></a>                  
<a id="__codelineno-57-39" name="__codelineno-57-39" href="#__codelineno-57-39"></a>
<a id="__codelineno-57-40" name="__codelineno-57-40" href="#__codelineno-57-40"></a>VERIFICATION PROCESS:
<a id="__codelineno-57-41" name="__codelineno-57-41" href="#__codelineno-57-41"></a>
<a id="__codelineno-57-42" name="__codelineno-57-42" href="#__codelineno-57-42"></a>
<a id="__codelineno-57-43" name="__codelineno-57-43" href="#__codelineno-57-43"></a>Browser receives:
<a id="__codelineno-57-44" name="__codelineno-57-44" href="#__codelineno-57-44"></a>
<a id="__codelineno-57-45" name="__codelineno-57-45" href="#__codelineno-57-45"></a> 1. Server Certificate (example.com) 
<a id="__codelineno-57-46" name="__codelineno-57-46" href="#__codelineno-57-46"></a> 2. Intermediate Certificate         
<a id="__codelineno-57-47" name="__codelineno-57-47" href="#__codelineno-57-47"></a> 3. (Root CA already trusted)        
<a id="__codelineno-57-48" name="__codelineno-57-48" href="#__codelineno-57-48"></a>
<a id="__codelineno-57-49" name="__codelineno-57-49" href="#__codelineno-57-49"></a>
<a id="__codelineno-57-50" name="__codelineno-57-50" href="#__codelineno-57-50"></a>Verification Steps:
<a id="__codelineno-57-51" name="__codelineno-57-51" href="#__codelineno-57-51"></a>
<a id="__codelineno-57-52" name="__codelineno-57-52" href="#__codelineno-57-52"></a>                                                          
<a id="__codelineno-57-53" name="__codelineno-57-53" href="#__codelineno-57-53"></a> Step 1: Verify Server Certificate                       
<a id="__codelineno-57-54" name="__codelineno-57-54" href="#__codelineno-57-54"></a>                          
<a id="__codelineno-57-55" name="__codelineno-57-55" href="#__codelineno-57-55"></a>  Get CA signature from server cert                      
<a id="__codelineno-57-56" name="__codelineno-57-56" href="#__codelineno-57-56"></a>  Get public key from intermediate cert                  
<a id="__codelineno-57-57" name="__codelineno-57-57" href="#__codelineno-57-57"></a>  Verify signature with public key                       
<a id="__codelineno-57-58" name="__codelineno-57-58" href="#__codelineno-57-58"></a>  Check: Domain name, expiry, revocation                 
<a id="__codelineno-57-59" name="__codelineno-57-59" href="#__codelineno-57-59"></a>    Valid!                                               
<a id="__codelineno-57-60" name="__codelineno-57-60" href="#__codelineno-57-60"></a>                                                          
<a id="__codelineno-57-61" name="__codelineno-57-61" href="#__codelineno-57-61"></a> Step 2: Verify Intermediate Certificate                 
<a id="__codelineno-57-62" name="__codelineno-57-62" href="#__codelineno-57-62"></a>                        
<a id="__codelineno-57-63" name="__codelineno-57-63" href="#__codelineno-57-63"></a>  Get CA signature from intermediate cert                
<a id="__codelineno-57-64" name="__codelineno-57-64" href="#__codelineno-57-64"></a>  Get public key from root cert (in browser)             
<a id="__codelineno-57-65" name="__codelineno-57-65" href="#__codelineno-57-65"></a>  Verify signature with public key                       
<a id="__codelineno-57-66" name="__codelineno-57-66" href="#__codelineno-57-66"></a>    Valid!                                               
<a id="__codelineno-57-67" name="__codelineno-57-67" href="#__codelineno-57-67"></a>                                                          
<a id="__codelineno-57-68" name="__codelineno-57-68" href="#__codelineno-57-68"></a> Step 3: Check Root Certificate                          
<a id="__codelineno-57-69" name="__codelineno-57-69" href="#__codelineno-57-69"></a>                             
<a id="__codelineno-57-70" name="__codelineno-57-70" href="#__codelineno-57-70"></a>  Is root CA in browser&#39;s trust store?                   
<a id="__codelineno-57-71" name="__codelineno-57-71" href="#__codelineno-57-71"></a>    Yes! (Pre-installed by browser/OS)                   
<a id="__codelineno-57-72" name="__codelineno-57-72" href="#__codelineno-57-72"></a>                                                          
<a id="__codelineno-57-73" name="__codelineno-57-73" href="#__codelineno-57-73"></a> RESULT: Trust established!                             
<a id="__codelineno-57-74" name="__codelineno-57-74" href="#__codelineno-57-74"></a>                                                          
<a id="__codelineno-57-75" name="__codelineno-57-75" href="#__codelineno-57-75"></a>
</code></pre></div>
<h4 id="how-certificates-are-used-in-https">How Certificates Are Used in HTTPS</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>
<a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>        Complete HTTPS Flow with Certificates                 
<a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>
<a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>
<a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>STEP 1: User Visits Website
<a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>
<a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>
<a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a> Browser  User types: https://example.com
<a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>
<a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>     
<a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>      (1) TCP Connection
<a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>     
<a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a>     
<a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a>
<a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a>  Server  
<a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a>
<a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a>
<a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>STEP 2: TLS Handshake Begins
<a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a>
<a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a>Browser  ClientHello
<a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a>            &quot;I support TLS 1.3, AES-256, etc.&quot;
<a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a>
<a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a>Server   ServerHello
<a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>            &quot;Let&#39;s use TLS 1.3 with AES-256-GCM&quot;
<a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a>
<a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a>STEP 3: Server Sends Certificate
<a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a>
<a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a>Server   Certificate Chain:
<a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a>            
<a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a>             example.com Certificate         
<a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a>             - CN: example.com               
<a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a>             - Public Key (RSA 2048)         
<a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a>             - Signed by: DigiCert CA        
<a id="__codelineno-58-34" name="__codelineno-58-34" href="#__codelineno-58-34"></a>            
<a id="__codelineno-58-35" name="__codelineno-58-35" href="#__codelineno-58-35"></a>            
<a id="__codelineno-58-36" name="__codelineno-58-36" href="#__codelineno-58-36"></a>             DigiCert Intermediate Cert      
<a id="__codelineno-58-37" name="__codelineno-58-37" href="#__codelineno-58-37"></a>             - Signed by: DigiCert Root CA   
<a id="__codelineno-58-38" name="__codelineno-58-38" href="#__codelineno-58-38"></a>            
<a id="__codelineno-58-39" name="__codelineno-58-39" href="#__codelineno-58-39"></a>
<a id="__codelineno-58-40" name="__codelineno-58-40" href="#__codelineno-58-40"></a>STEP 4: Browser Verifies Certificate
<a id="__codelineno-58-41" name="__codelineno-58-41" href="#__codelineno-58-41"></a>
<a id="__codelineno-58-42" name="__codelineno-58-42" href="#__codelineno-58-42"></a>Browser:
<a id="__codelineno-58-43" name="__codelineno-58-43" href="#__codelineno-58-43"></a>  
<a id="__codelineno-58-44" name="__codelineno-58-44" href="#__codelineno-58-44"></a>   Verification Checklist:              
<a id="__codelineno-58-45" name="__codelineno-58-45" href="#__codelineno-58-45"></a>                                        
<a id="__codelineno-58-46" name="__codelineno-58-46" href="#__codelineno-58-46"></a>    Domain name matches URL?           
<a id="__codelineno-58-47" name="__codelineno-58-47" href="#__codelineno-58-47"></a>     &quot;example.com&quot; == &quot;example.com&quot;    
<a id="__codelineno-58-48" name="__codelineno-58-48" href="#__codelineno-58-48"></a>                                        
<a id="__codelineno-58-49" name="__codelineno-58-49" href="#__codelineno-58-49"></a>    Certificate not expired?           
<a id="__codelineno-58-50" name="__codelineno-58-50" href="#__codelineno-58-50"></a>     Valid: Jan 1 - Dec 31, 2024       
<a id="__codelineno-58-51" name="__codelineno-58-51" href="#__codelineno-58-51"></a>                                        
<a id="__codelineno-58-52" name="__codelineno-58-52" href="#__codelineno-58-52"></a>    Signed by trusted CA?              
<a id="__codelineno-58-53" name="__codelineno-58-53" href="#__codelineno-58-53"></a>     DigiCert Root CA in trust store   
<a id="__codelineno-58-54" name="__codelineno-58-54" href="#__codelineno-58-54"></a>                                        
<a id="__codelineno-58-55" name="__codelineno-58-55" href="#__codelineno-58-55"></a>    Signature valid?                   
<a id="__codelineno-58-56" name="__codelineno-58-56" href="#__codelineno-58-56"></a>     Verify with CA&#39;s public key       
<a id="__codelineno-58-57" name="__codelineno-58-57" href="#__codelineno-58-57"></a>                                        
<a id="__codelineno-58-58" name="__codelineno-58-58" href="#__codelineno-58-58"></a>    Not revoked?                       
<a id="__codelineno-58-59" name="__codelineno-58-59" href="#__codelineno-58-59"></a>     Check CRL/OCSP                    
<a id="__codelineno-58-60" name="__codelineno-58-60" href="#__codelineno-58-60"></a>                                        
<a id="__codelineno-58-61" name="__codelineno-58-61" href="#__codelineno-58-61"></a>   ALL CHECKS PASSED!                  
<a id="__codelineno-58-62" name="__codelineno-58-62" href="#__codelineno-58-62"></a>  
<a id="__codelineno-58-63" name="__codelineno-58-63" href="#__codelineno-58-63"></a>
<a id="__codelineno-58-64" name="__codelineno-58-64" href="#__codelineno-58-64"></a>STEP 5: Key Exchange
<a id="__codelineno-58-65" name="__codelineno-58-65" href="#__codelineno-58-65"></a>
<a id="__codelineno-58-66" name="__codelineno-58-66" href="#__codelineno-58-66"></a>Browser:
<a id="__codelineno-58-67" name="__codelineno-58-67" href="#__codelineno-58-67"></a>  - Generates random &quot;Pre-Master Secret&quot;
<a id="__codelineno-58-68" name="__codelineno-58-68" href="#__codelineno-58-68"></a>  - Encrypts with server&#39;s PUBLIC KEY (from certificate)
<a id="__codelineno-58-69" name="__codelineno-58-69" href="#__codelineno-58-69"></a>  - Sends to server
<a id="__codelineno-58-70" name="__codelineno-58-70" href="#__codelineno-58-70"></a>
<a id="__codelineno-58-71" name="__codelineno-58-71" href="#__codelineno-58-71"></a>Browser  Encrypted Pre-Master Secret
<a id="__codelineno-58-72" name="__codelineno-58-72" href="#__codelineno-58-72"></a>            []  Encrypted with public key
<a id="__codelineno-58-73" name="__codelineno-58-73" href="#__codelineno-58-73"></a>
<a id="__codelineno-58-74" name="__codelineno-58-74" href="#__codelineno-58-74"></a>Server:
<a id="__codelineno-58-75" name="__codelineno-58-75" href="#__codelineno-58-75"></a>  - Receives encrypted pre-master secret
<a id="__codelineno-58-76" name="__codelineno-58-76" href="#__codelineno-58-76"></a>  - Decrypts with its PRIVATE KEY
<a id="__codelineno-58-77" name="__codelineno-58-77" href="#__codelineno-58-77"></a>  - Both sides compute Session Key
<a id="__codelineno-58-78" name="__codelineno-58-78" href="#__codelineno-58-78"></a>
<a id="__codelineno-58-79" name="__codelineno-58-79" href="#__codelineno-58-79"></a>STEP 6: Secure Communication
<a id="__codelineno-58-80" name="__codelineno-58-80" href="#__codelineno-58-80"></a>
<a id="__codelineno-58-81" name="__codelineno-58-81" href="#__codelineno-58-81"></a>Browser  Server
<a id="__codelineno-58-82" name="__codelineno-58-82" href="#__codelineno-58-82"></a>        All data encrypted with Session Key (AES-256)
<a id="__codelineno-58-83" name="__codelineno-58-83" href="#__codelineno-58-83"></a>
<a id="__codelineno-58-84" name="__codelineno-58-84" href="#__codelineno-58-84"></a>        GET /api/data []  Encrypted
<a id="__codelineno-58-85" name="__codelineno-58-85" href="#__codelineno-58-85"></a>        Response: []  Encrypted
<a id="__codelineno-58-86" name="__codelineno-58-86" href="#__codelineno-58-86"></a>
<a id="__codelineno-58-87" name="__codelineno-58-87" href="#__codelineno-58-87"></a>
<a id="__codelineno-58-88" name="__codelineno-58-88" href="#__codelineno-58-88"></a>  Browser Address Bar Shows:           
<a id="__codelineno-58-89" name="__codelineno-58-89" href="#__codelineno-58-89"></a>                                        
<a id="__codelineno-58-90" name="__codelineno-58-90" href="#__codelineno-58-90"></a>   https://example.com                
<a id="__codelineno-58-91" name="__codelineno-58-91" href="#__codelineno-58-91"></a>                                        
<a id="__codelineno-58-92" name="__codelineno-58-92" href="#__codelineno-58-92"></a>   Connection is secure               
<a id="__codelineno-58-93" name="__codelineno-58-93" href="#__codelineno-58-93"></a>   Certificate is valid               
<a id="__codelineno-58-94" name="__codelineno-58-94" href="#__codelineno-58-94"></a>   Issued by: DigiCert                
<a id="__codelineno-58-95" name="__codelineno-58-95" href="#__codelineno-58-95"></a>
</code></pre></div>
<h4 id="certificate-types">Certificate Types</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>DOMAIN VALIDATION (DV):
<a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>
<a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a> Validates domain ownership only
<a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a> Issued in minutes
<a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a> Free (Let&#39;s Encrypt) or cheap
<a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a> Shows:  in browser
<a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a> No company verification
<a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a>Use: Blogs, personal sites
<a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a>
<a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a>ORGANIZATION VALIDATION (OV):
<a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a>
<a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a> Validates domain + organization
<a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a> Issued in 1-3 days
<a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a> Manual verification process
<a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a> Shows:  + company name
<a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a> More trust
<a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a>Use: Business websites
<a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a>
<a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a>EXTENDED VALIDATION (EV):
<a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a>
<a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a> Highest validation level
<a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a> Thorough company verification
<a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a> Issued in 1-2 weeks
<a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a> Shows:  + Green bar + company name
<a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a> Maximum trust
<a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a>Use: Banks, e-commerce, high-security
<a id="__codelineno-59-27" name="__codelineno-59-27" href="#__codelineno-59-27"></a>
<a id="__codelineno-59-28" name="__codelineno-59-28" href="#__codelineno-59-28"></a>WILDCARD CERTIFICATES:
<a id="__codelineno-59-29" name="__codelineno-59-29" href="#__codelineno-59-29"></a>
<a id="__codelineno-59-30" name="__codelineno-59-30" href="#__codelineno-59-30"></a> Covers *.example.com
<a id="__codelineno-59-31" name="__codelineno-59-31" href="#__codelineno-59-31"></a> Secures all subdomains
<a id="__codelineno-59-32" name="__codelineno-59-32" href="#__codelineno-59-32"></a> Example: api.example.com, www.example.com
<a id="__codelineno-59-33" name="__codelineno-59-33" href="#__codelineno-59-33"></a>Use: Multiple subdomains
</code></pre></div>
<h3 id="jwt-json-web-token">JWT (JSON Web Token)</h3>
<p><strong>What is JWT?</strong></p>
<p>JWT is a compact, self-contained token format for securely transmitting information between parties as a JSON object. It's digitally signed, so it can be verified and trusted.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>
<a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a>                  JWT Structure                               
<a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a>
<a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a>
<a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a>COMPLETE JWT TOKEN:
<a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a>
<a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
<a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a>
<a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a>Split into 3 parts (separated by dots):
<a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a>
<a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a>
<a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a> HEADER 
<a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9
<a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a>
<a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a> Decoded:
<a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a> {
<a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a>   &quot;alg&quot;: &quot;HS256&quot;,         Algorithm
<a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a>   &quot;typ&quot;: &quot;JWT&quot;            Token type
<a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a> }
<a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a>
<a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a>                  .
<a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a> PAYLOAD 
<a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a> eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ
<a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a>
<a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a> Decoded:
<a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a> {
<a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a>   &quot;sub&quot;: &quot;1234567890&quot;,    Subject (user ID)
<a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a>   &quot;name&quot;: &quot;John Doe&quot;,     Custom claim
<a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a>   &quot;iat&quot;: 1516239022,      Issued at
<a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a>   &quot;exp&quot;: 1516242622       Expiration
<a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a> }
<a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a>
<a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a>                  .
<a id="__codelineno-60-34" name="__codelineno-60-34" href="#__codelineno-60-34"></a> SIGNATURE 
<a id="__codelineno-60-35" name="__codelineno-60-35" href="#__codelineno-60-35"></a> SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
<a id="__codelineno-60-36" name="__codelineno-60-36" href="#__codelineno-60-36"></a>
<a id="__codelineno-60-37" name="__codelineno-60-37" href="#__codelineno-60-37"></a> Created by:
<a id="__codelineno-60-38" name="__codelineno-60-38" href="#__codelineno-60-38"></a> HMACSHA256(
<a id="__codelineno-60-39" name="__codelineno-60-39" href="#__codelineno-60-39"></a>   base64UrlEncode(header) + &quot;.&quot; +
<a id="__codelineno-60-40" name="__codelineno-60-40" href="#__codelineno-60-40"></a>   base64UrlEncode(payload),
<a id="__codelineno-60-41" name="__codelineno-60-41" href="#__codelineno-60-41"></a>   secret_key
<a id="__codelineno-60-42" name="__codelineno-60-42" href="#__codelineno-60-42"></a> )
<a id="__codelineno-60-43" name="__codelineno-60-43" href="#__codelineno-60-43"></a>
</code></pre></div>
<h4 id="how-jwt-works">How JWT Works</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>
<a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>                JWT Authentication Flow                       
<a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>
<a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a>
<a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a>STEP 1: User Login
<a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a>
<a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a>                           
<a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a>  Client                               Server  
<a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a>                           
<a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a>                                           
<a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a>      POST /login                          
<a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a>      {username: &quot;john&quot;, password: &quot;***&quot;}  
<a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>     
<a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a>                                           
<a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a>                                            Verify credentials
<a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a>                                             Valid!
<a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a>                                           
<a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>                                            Generate JWT:
<a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a>                                            
<a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a>                                            Header:
<a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a>                                            {alg: HS256, typ: JWT}
<a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a>                                           
<a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a>                                            Payload:
<a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a>                                            {
<a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a>                                              sub: &quot;12345&quot;,
<a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a>                                              name: &quot;John Doe&quot;,
<a id="__codelineno-61-27" name="__codelineno-61-27" href="#__codelineno-61-27"></a>                                              role: &quot;admin&quot;,
<a id="__codelineno-61-28" name="__codelineno-61-28" href="#__codelineno-61-28"></a>                                              iat: 1234567890,
<a id="__codelineno-61-29" name="__codelineno-61-29" href="#__codelineno-61-29"></a>                                              exp: 1234571490
<a id="__codelineno-61-30" name="__codelineno-61-30" href="#__codelineno-61-30"></a>                                            }
<a id="__codelineno-61-31" name="__codelineno-61-31" href="#__codelineno-61-31"></a>                                           
<a id="__codelineno-61-32" name="__codelineno-61-32" href="#__codelineno-61-32"></a>                                            Sign with secret key
<a id="__codelineno-61-33" name="__codelineno-61-33" href="#__codelineno-61-33"></a>                                           
<a id="__codelineno-61-34" name="__codelineno-61-34" href="#__codelineno-61-34"></a>      Response: { token: &quot;eyJ...&quot; }        
<a id="__codelineno-61-35" name="__codelineno-61-35" href="#__codelineno-61-35"></a>     
<a id="__codelineno-61-36" name="__codelineno-61-36" href="#__codelineno-61-36"></a>                                           
<a id="__codelineno-61-37" name="__codelineno-61-37" href="#__codelineno-61-37"></a>      Store token (localStorage/cookie)    
<a id="__codelineno-61-38" name="__codelineno-61-38" href="#__codelineno-61-38"></a>                                           
<a id="__codelineno-61-39" name="__codelineno-61-39" href="#__codelineno-61-39"></a>
<a id="__codelineno-61-40" name="__codelineno-61-40" href="#__codelineno-61-40"></a>STEP 2: Access Protected Resource
<a id="__codelineno-61-41" name="__codelineno-61-41" href="#__codelineno-61-41"></a>
<a id="__codelineno-61-42" name="__codelineno-61-42" href="#__codelineno-61-42"></a>                                           
<a id="__codelineno-61-43" name="__codelineno-61-43" href="#__codelineno-61-43"></a>      GET /api/protected                   
<a id="__codelineno-61-44" name="__codelineno-61-44" href="#__codelineno-61-44"></a>      Authorization: Bearer eyJ...         
<a id="__codelineno-61-45" name="__codelineno-61-45" href="#__codelineno-61-45"></a>     
<a id="__codelineno-61-46" name="__codelineno-61-46" href="#__codelineno-61-46"></a>                                           
<a id="__codelineno-61-47" name="__codelineno-61-47" href="#__codelineno-61-47"></a>                                            Verify JWT:
<a id="__codelineno-61-48" name="__codelineno-61-48" href="#__codelineno-61-48"></a>                                            
<a id="__codelineno-61-49" name="__codelineno-61-49" href="#__codelineno-61-49"></a>                                            1. Extract token
<a id="__codelineno-61-50" name="__codelineno-61-50" href="#__codelineno-61-50"></a>                                            2. Verify signature
<a id="__codelineno-61-51" name="__codelineno-61-51" href="#__codelineno-61-51"></a>                                               using secret key
<a id="__codelineno-61-52" name="__codelineno-61-52" href="#__codelineno-61-52"></a>                                            3. Check expiration
<a id="__codelineno-61-53" name="__codelineno-61-53" href="#__codelineno-61-53"></a>                                            4. Validate claims
<a id="__codelineno-61-54" name="__codelineno-61-54" href="#__codelineno-61-54"></a>                                           
<a id="__codelineno-61-55" name="__codelineno-61-55" href="#__codelineno-61-55"></a>                                             Token valid!
<a id="__codelineno-61-56" name="__codelineno-61-56" href="#__codelineno-61-56"></a>                                           
<a id="__codelineno-61-57" name="__codelineno-61-57" href="#__codelineno-61-57"></a>                                            Extract user info
<a id="__codelineno-61-58" name="__codelineno-61-58" href="#__codelineno-61-58"></a>                                            from payload
<a id="__codelineno-61-59" name="__codelineno-61-59" href="#__codelineno-61-59"></a>                                           
<a id="__codelineno-61-60" name="__codelineno-61-60" href="#__codelineno-61-60"></a>      Response: { data: &quot;...&quot; }            
<a id="__codelineno-61-61" name="__codelineno-61-61" href="#__codelineno-61-61"></a>     
<a id="__codelineno-61-62" name="__codelineno-61-62" href="#__codelineno-61-62"></a>                                           
<a id="__codelineno-61-63" name="__codelineno-61-63" href="#__codelineno-61-63"></a>
<a id="__codelineno-61-64" name="__codelineno-61-64" href="#__codelineno-61-64"></a>STEP 3: Token Expired
<a id="__codelineno-61-65" name="__codelineno-61-65" href="#__codelineno-61-65"></a>
<a id="__codelineno-61-66" name="__codelineno-61-66" href="#__codelineno-61-66"></a>                                           
<a id="__codelineno-61-67" name="__codelineno-61-67" href="#__codelineno-61-67"></a>      GET /api/protected                   
<a id="__codelineno-61-68" name="__codelineno-61-68" href="#__codelineno-61-68"></a>      Authorization: Bearer eyJ... (old)   
<a id="__codelineno-61-69" name="__codelineno-61-69" href="#__codelineno-61-69"></a>     
<a id="__codelineno-61-70" name="__codelineno-61-70" href="#__codelineno-61-70"></a>                                           
<a id="__codelineno-61-71" name="__codelineno-61-71" href="#__codelineno-61-71"></a>                                            Verify JWT:
<a id="__codelineno-61-72" name="__codelineno-61-72" href="#__codelineno-61-72"></a>                                             Token expired!
<a id="__codelineno-61-73" name="__codelineno-61-73" href="#__codelineno-61-73"></a>                                           
<a id="__codelineno-61-74" name="__codelineno-61-74" href="#__codelineno-61-74"></a>      401 Unauthorized                     
<a id="__codelineno-61-75" name="__codelineno-61-75" href="#__codelineno-61-75"></a>      { error: &quot;Token expired&quot; }           
<a id="__codelineno-61-76" name="__codelineno-61-76" href="#__codelineno-61-76"></a>     
<a id="__codelineno-61-77" name="__codelineno-61-77" href="#__codelineno-61-77"></a>                                           
<a id="__codelineno-61-78" name="__codelineno-61-78" href="#__codelineno-61-78"></a>      User must login again                
<a id="__codelineno-61-79" name="__codelineno-61-79" href="#__codelineno-61-79"></a>      (or use refresh token)               
<a id="__codelineno-61-80" name="__codelineno-61-80" href="#__codelineno-61-80"></a>                                           
</code></pre></div>
<h4 id="jwt-vs-session-tokens">JWT vs Session Tokens</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>
<a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>              JWT vs Session Tokens                           
<a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>
<a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>
<a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>SESSION TOKENS (Server-side):
<a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>
<a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>                           
<a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>  Client                                  Server       
<a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>                               
<a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>                                          Session     
<a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>      Login                                Store      
<a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>                     
<a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a>                                         session123:  
<a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>      Session ID: &quot;session123&quot;           {user:john}  
<a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a>         
<a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a>                                                        
<a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a>      Request + Session ID                              
<a id="__codelineno-62-18" name="__codelineno-62-18" href="#__codelineno-62-18"></a>      Lookup in store  
<a id="__codelineno-62-19" name="__codelineno-62-19" href="#__codelineno-62-19"></a>                                        Found user     
<a id="__codelineno-62-20" name="__codelineno-62-20" href="#__codelineno-62-20"></a>      Response                                          
<a id="__codelineno-62-21" name="__codelineno-62-21" href="#__codelineno-62-21"></a>                       
<a id="__codelineno-62-22" name="__codelineno-62-22" href="#__codelineno-62-22"></a>     
<a id="__codelineno-62-23" name="__codelineno-62-23" href="#__codelineno-62-23"></a>
<a id="__codelineno-62-24" name="__codelineno-62-24" href="#__codelineno-62-24"></a> Can revoke immediately
<a id="__codelineno-62-25" name="__codelineno-62-25" href="#__codelineno-62-25"></a> Server has full control
<a id="__codelineno-62-26" name="__codelineno-62-26" href="#__codelineno-62-26"></a> Requires server-side storage
<a id="__codelineno-62-27" name="__codelineno-62-27" href="#__codelineno-62-27"></a> Harder to scale (session replication)
<a id="__codelineno-62-28" name="__codelineno-62-28" href="#__codelineno-62-28"></a> Not stateless
<a id="__codelineno-62-29" name="__codelineno-62-29" href="#__codelineno-62-29"></a>
<a id="__codelineno-62-30" name="__codelineno-62-30" href="#__codelineno-62-30"></a>JWT TOKENS (Stateless):
<a id="__codelineno-62-31" name="__codelineno-62-31" href="#__codelineno-62-31"></a>
<a id="__codelineno-62-32" name="__codelineno-62-32" href="#__codelineno-62-32"></a>                           
<a id="__codelineno-62-33" name="__codelineno-62-33" href="#__codelineno-62-33"></a>  Client                               Server  
<a id="__codelineno-62-34" name="__codelineno-62-34" href="#__codelineno-62-34"></a>                           
<a id="__codelineno-62-35" name="__codelineno-62-35" href="#__codelineno-62-35"></a>                                           
<a id="__codelineno-62-36" name="__codelineno-62-36" href="#__codelineno-62-36"></a>      Login                                
<a id="__codelineno-62-37" name="__codelineno-62-37" href="#__codelineno-62-37"></a>     
<a id="__codelineno-62-38" name="__codelineno-62-38" href="#__codelineno-62-38"></a>                                           
<a id="__codelineno-62-39" name="__codelineno-62-39" href="#__codelineno-62-39"></a>      JWT: &quot;eyJ...&quot; (contains user info)   
<a id="__codelineno-62-40" name="__codelineno-62-40" href="#__codelineno-62-40"></a>     
<a id="__codelineno-62-41" name="__codelineno-62-41" href="#__codelineno-62-41"></a>                                           
<a id="__codelineno-62-42" name="__codelineno-62-42" href="#__codelineno-62-42"></a>      Request + JWT                        
<a id="__codelineno-62-43" name="__codelineno-62-43" href="#__codelineno-62-43"></a>      Verify signature
<a id="__codelineno-62-44" name="__codelineno-62-44" href="#__codelineno-62-44"></a>                                            (no DB lookup!)
<a id="__codelineno-62-45" name="__codelineno-62-45" href="#__codelineno-62-45"></a>      Response                             
<a id="__codelineno-62-46" name="__codelineno-62-46" href="#__codelineno-62-46"></a>     
<a id="__codelineno-62-47" name="__codelineno-62-47" href="#__codelineno-62-47"></a>     
<a id="__codelineno-62-48" name="__codelineno-62-48" href="#__codelineno-62-48"></a>
<a id="__codelineno-62-49" name="__codelineno-62-49" href="#__codelineno-62-49"></a> Stateless (no server storage)
<a id="__codelineno-62-50" name="__codelineno-62-50" href="#__codelineno-62-50"></a> Easy to scale
<a id="__codelineno-62-51" name="__codelineno-62-51" href="#__codelineno-62-51"></a> Works across services (microservices)
<a id="__codelineno-62-52" name="__codelineno-62-52" href="#__codelineno-62-52"></a> Contains user info (no DB lookup)
<a id="__codelineno-62-53" name="__codelineno-62-53" href="#__codelineno-62-53"></a> Cannot revoke until expiration
<a id="__codelineno-62-54" name="__codelineno-62-54" href="#__codelineno-62-54"></a> Token size larger than session ID
<a id="__codelineno-62-55" name="__codelineno-62-55" href="#__codelineno-62-55"></a> Must keep tokens short-lived
</code></pre></div>
<h4 id="jwt-implementation-python">JWT Implementation (Python)</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">jwt</span>
<a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Optional</span>
<a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">hmac</span>
<a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a>
<a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a><span class="k">class</span><span class="w"> </span><span class="nc">JWTManager</span><span class="p">:</span>
<a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;JWT token generation and validation&quot;&quot;&quot;</span>
<a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a>
<a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;HS256&#39;</span><span class="p">):</span>
<a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a><span class="sd">        Initialize JWT manager</span>
<a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a>
<a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a><span class="sd">        Args:</span>
<a id="__codelineno-63-15" name="__codelineno-63-15" href="#__codelineno-63-15"></a><span class="sd">            secret_key: Secret key for signing tokens</span>
<a id="__codelineno-63-16" name="__codelineno-63-16" href="#__codelineno-63-16"></a><span class="sd">            algorithm: Signing algorithm (HS256, RS256, etc.)</span>
<a id="__codelineno-63-17" name="__codelineno-63-17" href="#__codelineno-63-17"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-63-18" name="__codelineno-63-18" href="#__codelineno-63-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span> <span class="o">=</span> <span class="n">secret_key</span>
<a id="__codelineno-63-19" name="__codelineno-63-19" href="#__codelineno-63-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span> <span class="o">=</span> <span class="n">algorithm</span>
<a id="__codelineno-63-20" name="__codelineno-63-20" href="#__codelineno-63-20"></a>
<a id="__codelineno-63-21" name="__codelineno-63-21" href="#__codelineno-63-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">generate_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
<a id="__codelineno-63-22" name="__codelineno-63-22" href="#__codelineno-63-22"></a>                      <span class="n">role</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="n">expires_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-63-23" name="__codelineno-63-23" href="#__codelineno-63-23"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-63-24" name="__codelineno-63-24" href="#__codelineno-63-24"></a><span class="sd">        Generate JWT token</span>
<a id="__codelineno-63-25" name="__codelineno-63-25" href="#__codelineno-63-25"></a>
<a id="__codelineno-63-26" name="__codelineno-63-26" href="#__codelineno-63-26"></a><span class="sd">        Args:</span>
<a id="__codelineno-63-27" name="__codelineno-63-27" href="#__codelineno-63-27"></a><span class="sd">            user_id: Unique user identifier</span>
<a id="__codelineno-63-28" name="__codelineno-63-28" href="#__codelineno-63-28"></a><span class="sd">            username: Username</span>
<a id="__codelineno-63-29" name="__codelineno-63-29" href="#__codelineno-63-29"></a><span class="sd">            role: User role (admin, user, etc.)</span>
<a id="__codelineno-63-30" name="__codelineno-63-30" href="#__codelineno-63-30"></a><span class="sd">            expires_in: Token validity in seconds (default 1 hour)</span>
<a id="__codelineno-63-31" name="__codelineno-63-31" href="#__codelineno-63-31"></a>
<a id="__codelineno-63-32" name="__codelineno-63-32" href="#__codelineno-63-32"></a><span class="sd">        Returns:</span>
<a id="__codelineno-63-33" name="__codelineno-63-33" href="#__codelineno-63-33"></a><span class="sd">            JWT token string</span>
<a id="__codelineno-63-34" name="__codelineno-63-34" href="#__codelineno-63-34"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-63-35" name="__codelineno-63-35" href="#__codelineno-63-35"></a>        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
<a id="__codelineno-63-36" name="__codelineno-63-36" href="#__codelineno-63-36"></a>
<a id="__codelineno-63-37" name="__codelineno-63-37" href="#__codelineno-63-37"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-63-38" name="__codelineno-63-38" href="#__codelineno-63-38"></a>            <span class="c1"># Standard claims</span>
<a id="__codelineno-63-39" name="__codelineno-63-39" href="#__codelineno-63-39"></a>            <span class="s1">&#39;sub&#39;</span><span class="p">:</span> <span class="n">user_id</span><span class="p">,</span>                    <span class="c1"># Subject (user ID)</span>
<a id="__codelineno-63-40" name="__codelineno-63-40" href="#__codelineno-63-40"></a>            <span class="s1">&#39;iat&#39;</span><span class="p">:</span> <span class="n">now</span><span class="p">,</span>                        <span class="c1"># Issued at</span>
<a id="__codelineno-63-41" name="__codelineno-63-41" href="#__codelineno-63-41"></a>            <span class="s1">&#39;exp&#39;</span><span class="p">:</span> <span class="n">now</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">expires_in</span><span class="p">),</span>  <span class="c1"># Expiration</span>
<a id="__codelineno-63-42" name="__codelineno-63-42" href="#__codelineno-63-42"></a>            <span class="s1">&#39;nbf&#39;</span><span class="p">:</span> <span class="n">now</span><span class="p">,</span>                        <span class="c1"># Not before</span>
<a id="__codelineno-63-43" name="__codelineno-63-43" href="#__codelineno-63-43"></a>
<a id="__codelineno-63-44" name="__codelineno-63-44" href="#__codelineno-63-44"></a>            <span class="c1"># Custom claims</span>
<a id="__codelineno-63-45" name="__codelineno-63-45" href="#__codelineno-63-45"></a>            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span>
<a id="__codelineno-63-46" name="__codelineno-63-46" href="#__codelineno-63-46"></a>            <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="n">role</span>
<a id="__codelineno-63-47" name="__codelineno-63-47" href="#__codelineno-63-47"></a>        <span class="p">}</span>
<a id="__codelineno-63-48" name="__codelineno-63-48" href="#__codelineno-63-48"></a>
<a id="__codelineno-63-49" name="__codelineno-63-49" href="#__codelineno-63-49"></a>        <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">)</span>
<a id="__codelineno-63-50" name="__codelineno-63-50" href="#__codelineno-63-50"></a>        <span class="k">return</span> <span class="n">token</span>
<a id="__codelineno-63-51" name="__codelineno-63-51" href="#__codelineno-63-51"></a>
<a id="__codelineno-63-52" name="__codelineno-63-52" href="#__codelineno-63-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">verify_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
<a id="__codelineno-63-53" name="__codelineno-63-53" href="#__codelineno-63-53"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-63-54" name="__codelineno-63-54" href="#__codelineno-63-54"></a><span class="sd">        Verify and decode JWT token</span>
<a id="__codelineno-63-55" name="__codelineno-63-55" href="#__codelineno-63-55"></a>
<a id="__codelineno-63-56" name="__codelineno-63-56" href="#__codelineno-63-56"></a><span class="sd">        Args:</span>
<a id="__codelineno-63-57" name="__codelineno-63-57" href="#__codelineno-63-57"></a><span class="sd">            token: JWT token string</span>
<a id="__codelineno-63-58" name="__codelineno-63-58" href="#__codelineno-63-58"></a>
<a id="__codelineno-63-59" name="__codelineno-63-59" href="#__codelineno-63-59"></a><span class="sd">        Returns:</span>
<a id="__codelineno-63-60" name="__codelineno-63-60" href="#__codelineno-63-60"></a><span class="sd">            Decoded payload if valid, None if invalid</span>
<a id="__codelineno-63-61" name="__codelineno-63-61" href="#__codelineno-63-61"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-63-62" name="__codelineno-63-62" href="#__codelineno-63-62"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-63-63" name="__codelineno-63-63" href="#__codelineno-63-63"></a>            <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span>
<a id="__codelineno-63-64" name="__codelineno-63-64" href="#__codelineno-63-64"></a>                <span class="n">token</span><span class="p">,</span> 
<a id="__codelineno-63-65" name="__codelineno-63-65" href="#__codelineno-63-65"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">secret_key</span><span class="p">,</span> 
<a id="__codelineno-63-66" name="__codelineno-63-66" href="#__codelineno-63-66"></a>                <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">algorithm</span><span class="p">]</span>
<a id="__codelineno-63-67" name="__codelineno-63-67" href="#__codelineno-63-67"></a>            <span class="p">)</span>
<a id="__codelineno-63-68" name="__codelineno-63-68" href="#__codelineno-63-68"></a>            <span class="k">return</span> <span class="n">payload</span>
<a id="__codelineno-63-69" name="__codelineno-63-69" href="#__codelineno-63-69"></a>        <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">ExpiredSignatureError</span><span class="p">:</span>
<a id="__codelineno-63-70" name="__codelineno-63-70" href="#__codelineno-63-70"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Token has expired&quot;</span><span class="p">)</span>
<a id="__codelineno-63-71" name="__codelineno-63-71" href="#__codelineno-63-71"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-63-72" name="__codelineno-63-72" href="#__codelineno-63-72"></a>        <span class="k">except</span> <span class="n">jwt</span><span class="o">.</span><span class="n">InvalidTokenError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-63-73" name="__codelineno-63-73" href="#__codelineno-63-73"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid token: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-63-74" name="__codelineno-63-74" href="#__codelineno-63-74"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-63-75" name="__codelineno-63-75" href="#__codelineno-63-75"></a>
<a id="__codelineno-63-76" name="__codelineno-63-76" href="#__codelineno-63-76"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">refresh_token</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expires_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-63-77" name="__codelineno-63-77" href="#__codelineno-63-77"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-63-78" name="__codelineno-63-78" href="#__codelineno-63-78"></a><span class="sd">        Generate new token from old token (refresh)</span>
<a id="__codelineno-63-79" name="__codelineno-63-79" href="#__codelineno-63-79"></a>
<a id="__codelineno-63-80" name="__codelineno-63-80" href="#__codelineno-63-80"></a><span class="sd">        Args:</span>
<a id="__codelineno-63-81" name="__codelineno-63-81" href="#__codelineno-63-81"></a><span class="sd">            old_token: Current JWT token</span>
<a id="__codelineno-63-82" name="__codelineno-63-82" href="#__codelineno-63-82"></a><span class="sd">            expires_in: New token validity in seconds</span>
<a id="__codelineno-63-83" name="__codelineno-63-83" href="#__codelineno-63-83"></a>
<a id="__codelineno-63-84" name="__codelineno-63-84" href="#__codelineno-63-84"></a><span class="sd">        Returns:</span>
<a id="__codelineno-63-85" name="__codelineno-63-85" href="#__codelineno-63-85"></a><span class="sd">            New JWT token or None if old token is invalid</span>
<a id="__codelineno-63-86" name="__codelineno-63-86" href="#__codelineno-63-86"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-63-87" name="__codelineno-63-87" href="#__codelineno-63-87"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verify_token</span><span class="p">(</span><span class="n">old_token</span><span class="p">)</span>
<a id="__codelineno-63-88" name="__codelineno-63-88" href="#__codelineno-63-88"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
<a id="__codelineno-63-89" name="__codelineno-63-89" href="#__codelineno-63-89"></a>            <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-63-90" name="__codelineno-63-90" href="#__codelineno-63-90"></a>
<a id="__codelineno-63-91" name="__codelineno-63-91" href="#__codelineno-63-91"></a>        <span class="c1"># Generate new token with same user info</span>
<a id="__codelineno-63-92" name="__codelineno-63-92" href="#__codelineno-63-92"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_token</span><span class="p">(</span>
<a id="__codelineno-63-93" name="__codelineno-63-93" href="#__codelineno-63-93"></a>            <span class="n">user_id</span><span class="o">=</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;sub&#39;</span><span class="p">],</span>
<a id="__codelineno-63-94" name="__codelineno-63-94" href="#__codelineno-63-94"></a>            <span class="n">username</span><span class="o">=</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">],</span>
<a id="__codelineno-63-95" name="__codelineno-63-95" href="#__codelineno-63-95"></a>            <span class="n">role</span><span class="o">=</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">],</span>
<a id="__codelineno-63-96" name="__codelineno-63-96" href="#__codelineno-63-96"></a>            <span class="n">expires_in</span><span class="o">=</span><span class="n">expires_in</span>
<a id="__codelineno-63-97" name="__codelineno-63-97" href="#__codelineno-63-97"></a>        <span class="p">)</span>
<a id="__codelineno-63-98" name="__codelineno-63-98" href="#__codelineno-63-98"></a>
<a id="__codelineno-63-99" name="__codelineno-63-99" href="#__codelineno-63-99"></a><span class="c1"># Flask API Example</span>
<a id="__codelineno-63-100" name="__codelineno-63-100" href="#__codelineno-63-100"></a><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">jsonify</span>
<a id="__codelineno-63-101" name="__codelineno-63-101" href="#__codelineno-63-101"></a><span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">wraps</span>
<a id="__codelineno-63-102" name="__codelineno-63-102" href="#__codelineno-63-102"></a>
<a id="__codelineno-63-103" name="__codelineno-63-103" href="#__codelineno-63-103"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-63-104" name="__codelineno-63-104" href="#__codelineno-63-104"></a><span class="n">jwt_manager</span> <span class="o">=</span> <span class="n">JWTManager</span><span class="p">(</span><span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;your-secret-key-keep-it-safe&#39;</span><span class="p">)</span>
<a id="__codelineno-63-105" name="__codelineno-63-105" href="#__codelineno-63-105"></a>
<a id="__codelineno-63-106" name="__codelineno-63-106" href="#__codelineno-63-106"></a><span class="k">def</span><span class="w"> </span><span class="nf">token_required</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
<a id="__codelineno-63-107" name="__codelineno-63-107" href="#__codelineno-63-107"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to protect routes with JWT authentication&quot;&quot;&quot;</span>
<a id="__codelineno-63-108" name="__codelineno-63-108" href="#__codelineno-63-108"></a>    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="__codelineno-63-109" name="__codelineno-63-109" href="#__codelineno-63-109"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">decorated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-63-110" name="__codelineno-63-110" href="#__codelineno-63-110"></a>        <span class="n">token</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-63-111" name="__codelineno-63-111" href="#__codelineno-63-111"></a>
<a id="__codelineno-63-112" name="__codelineno-63-112" href="#__codelineno-63-112"></a>        <span class="c1"># Get token from Authorization header</span>
<a id="__codelineno-63-113" name="__codelineno-63-113" href="#__codelineno-63-113"></a>        <span class="k">if</span> <span class="s1">&#39;Authorization&#39;</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
<a id="__codelineno-63-114" name="__codelineno-63-114" href="#__codelineno-63-114"></a>            <span class="n">auth_header</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Authorization&#39;</span><span class="p">]</span>
<a id="__codelineno-63-115" name="__codelineno-63-115" href="#__codelineno-63-115"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-63-116" name="__codelineno-63-116" href="#__codelineno-63-116"></a>                <span class="c1"># Format: &quot;Bearer &lt;token&gt;&quot;</span>
<a id="__codelineno-63-117" name="__codelineno-63-117" href="#__codelineno-63-117"></a>                <span class="n">token</span> <span class="o">=</span> <span class="n">auth_header</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-63-118" name="__codelineno-63-118" href="#__codelineno-63-118"></a>            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
<a id="__codelineno-63-119" name="__codelineno-63-119" href="#__codelineno-63-119"></a>                <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid authorization header&#39;</span><span class="p">}),</span> <span class="mi">401</span>
<a id="__codelineno-63-120" name="__codelineno-63-120" href="#__codelineno-63-120"></a>
<a id="__codelineno-63-121" name="__codelineno-63-121" href="#__codelineno-63-121"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span>
<a id="__codelineno-63-122" name="__codelineno-63-122" href="#__codelineno-63-122"></a>            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Token is missing&#39;</span><span class="p">}),</span> <span class="mi">401</span>
<a id="__codelineno-63-123" name="__codelineno-63-123" href="#__codelineno-63-123"></a>
<a id="__codelineno-63-124" name="__codelineno-63-124" href="#__codelineno-63-124"></a>        <span class="c1"># Verify token</span>
<a id="__codelineno-63-125" name="__codelineno-63-125" href="#__codelineno-63-125"></a>        <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt_manager</span><span class="o">.</span><span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-63-126" name="__codelineno-63-126" href="#__codelineno-63-126"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">payload</span><span class="p">:</span>
<a id="__codelineno-63-127" name="__codelineno-63-127" href="#__codelineno-63-127"></a>            <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Token is invalid or expired&#39;</span><span class="p">}),</span> <span class="mi">401</span>
<a id="__codelineno-63-128" name="__codelineno-63-128" href="#__codelineno-63-128"></a>
<a id="__codelineno-63-129" name="__codelineno-63-129" href="#__codelineno-63-129"></a>        <span class="c1"># Add user info to request context</span>
<a id="__codelineno-63-130" name="__codelineno-63-130" href="#__codelineno-63-130"></a>        <span class="n">request</span><span class="o">.</span><span class="n">current_user</span> <span class="o">=</span> <span class="n">payload</span>
<a id="__codelineno-63-131" name="__codelineno-63-131" href="#__codelineno-63-131"></a>
<a id="__codelineno-63-132" name="__codelineno-63-132" href="#__codelineno-63-132"></a>        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-63-133" name="__codelineno-63-133" href="#__codelineno-63-133"></a>
<a id="__codelineno-63-134" name="__codelineno-63-134" href="#__codelineno-63-134"></a>    <span class="k">return</span> <span class="n">decorated</span>
<a id="__codelineno-63-135" name="__codelineno-63-135" href="#__codelineno-63-135"></a>
<a id="__codelineno-63-136" name="__codelineno-63-136" href="#__codelineno-63-136"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-63-137" name="__codelineno-63-137" href="#__codelineno-63-137"></a><span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
<a id="__codelineno-63-138" name="__codelineno-63-138" href="#__codelineno-63-138"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Login endpoint - returns JWT token&quot;&quot;&quot;</span>
<a id="__codelineno-63-139" name="__codelineno-63-139" href="#__codelineno-63-139"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
<a id="__codelineno-63-140" name="__codelineno-63-140" href="#__codelineno-63-140"></a>    <span class="n">username</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<a id="__codelineno-63-141" name="__codelineno-63-141" href="#__codelineno-63-141"></a>    <span class="n">password</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
<a id="__codelineno-63-142" name="__codelineno-63-142" href="#__codelineno-63-142"></a>
<a id="__codelineno-63-143" name="__codelineno-63-143" href="#__codelineno-63-143"></a>    <span class="c1"># Verify credentials (in real app, check against database)</span>
<a id="__codelineno-63-144" name="__codelineno-63-144" href="#__codelineno-63-144"></a>    <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="s1">&#39;admin&#39;</span> <span class="ow">and</span> <span class="n">password</span> <span class="o">==</span> <span class="s1">&#39;password123&#39;</span><span class="p">:</span>
<a id="__codelineno-63-145" name="__codelineno-63-145" href="#__codelineno-63-145"></a>        <span class="c1"># Generate JWT token</span>
<a id="__codelineno-63-146" name="__codelineno-63-146" href="#__codelineno-63-146"></a>        <span class="n">token</span> <span class="o">=</span> <span class="n">jwt_manager</span><span class="o">.</span><span class="n">generate_token</span><span class="p">(</span>
<a id="__codelineno-63-147" name="__codelineno-63-147" href="#__codelineno-63-147"></a>            <span class="n">user_id</span><span class="o">=</span><span class="s1">&#39;12345&#39;</span><span class="p">,</span>
<a id="__codelineno-63-148" name="__codelineno-63-148" href="#__codelineno-63-148"></a>            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
<a id="__codelineno-63-149" name="__codelineno-63-149" href="#__codelineno-63-149"></a>            <span class="n">role</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span>
<a id="__codelineno-63-150" name="__codelineno-63-150" href="#__codelineno-63-150"></a>            <span class="n">expires_in</span><span class="o">=</span><span class="mi">3600</span>  <span class="c1"># 1 hour</span>
<a id="__codelineno-63-151" name="__codelineno-63-151" href="#__codelineno-63-151"></a>        <span class="p">)</span>
<a id="__codelineno-63-152" name="__codelineno-63-152" href="#__codelineno-63-152"></a>
<a id="__codelineno-63-153" name="__codelineno-63-153" href="#__codelineno-63-153"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
<a id="__codelineno-63-154" name="__codelineno-63-154" href="#__codelineno-63-154"></a>            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Login successful&#39;</span><span class="p">,</span>
<a id="__codelineno-63-155" name="__codelineno-63-155" href="#__codelineno-63-155"></a>            <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span>
<a id="__codelineno-63-156" name="__codelineno-63-156" href="#__codelineno-63-156"></a>            <span class="s1">&#39;expires_in&#39;</span><span class="p">:</span> <span class="mi">3600</span>
<a id="__codelineno-63-157" name="__codelineno-63-157" href="#__codelineno-63-157"></a>        <span class="p">}),</span> <span class="mi">200</span>
<a id="__codelineno-63-158" name="__codelineno-63-158" href="#__codelineno-63-158"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-63-159" name="__codelineno-63-159" href="#__codelineno-63-159"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid credentials&#39;</span><span class="p">}),</span> <span class="mi">401</span>
<a id="__codelineno-63-160" name="__codelineno-63-160" href="#__codelineno-63-160"></a>
<a id="__codelineno-63-161" name="__codelineno-63-161" href="#__codelineno-63-161"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/protected&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<a id="__codelineno-63-162" name="__codelineno-63-162" href="#__codelineno-63-162"></a><span class="nd">@token_required</span>
<a id="__codelineno-63-163" name="__codelineno-63-163" href="#__codelineno-63-163"></a><span class="k">def</span><span class="w"> </span><span class="nf">protected</span><span class="p">():</span>
<a id="__codelineno-63-164" name="__codelineno-63-164" href="#__codelineno-63-164"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Protected endpoint - requires valid JWT token&quot;&quot;&quot;</span>
<a id="__codelineno-63-165" name="__codelineno-63-165" href="#__codelineno-63-165"></a>    <span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">current_user</span>
<a id="__codelineno-63-166" name="__codelineno-63-166" href="#__codelineno-63-166"></a>
<a id="__codelineno-63-167" name="__codelineno-63-167" href="#__codelineno-63-167"></a>    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
<a id="__codelineno-63-168" name="__codelineno-63-168" href="#__codelineno-63-168"></a>        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Hello </span><span class="si">{</span><span class="n">user</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">!&#39;</span><span class="p">,</span>
<a id="__codelineno-63-169" name="__codelineno-63-169" href="#__codelineno-63-169"></a>        <span class="s1">&#39;user_id&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;sub&#39;</span><span class="p">],</span>
<a id="__codelineno-63-170" name="__codelineno-63-170" href="#__codelineno-63-170"></a>        <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span>
<a id="__codelineno-63-171" name="__codelineno-63-171" href="#__codelineno-63-171"></a>    <span class="p">}),</span> <span class="mi">200</span>
<a id="__codelineno-63-172" name="__codelineno-63-172" href="#__codelineno-63-172"></a>
<a id="__codelineno-63-173" name="__codelineno-63-173" href="#__codelineno-63-173"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/admin&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>
<a id="__codelineno-63-174" name="__codelineno-63-174" href="#__codelineno-63-174"></a><span class="nd">@token_required</span>
<a id="__codelineno-63-175" name="__codelineno-63-175" href="#__codelineno-63-175"></a><span class="k">def</span><span class="w"> </span><span class="nf">admin_only</span><span class="p">():</span>
<a id="__codelineno-63-176" name="__codelineno-63-176" href="#__codelineno-63-176"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Admin-only endpoint - checks role from JWT&quot;&quot;&quot;</span>
<a id="__codelineno-63-177" name="__codelineno-63-177" href="#__codelineno-63-177"></a>    <span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">current_user</span>
<a id="__codelineno-63-178" name="__codelineno-63-178" href="#__codelineno-63-178"></a>
<a id="__codelineno-63-179" name="__codelineno-63-179" href="#__codelineno-63-179"></a>    <span class="k">if</span> <span class="n">user</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;admin&#39;</span><span class="p">:</span>
<a id="__codelineno-63-180" name="__codelineno-63-180" href="#__codelineno-63-180"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Admin access required&#39;</span><span class="p">}),</span> <span class="mi">403</span>
<a id="__codelineno-63-181" name="__codelineno-63-181" href="#__codelineno-63-181"></a>
<a id="__codelineno-63-182" name="__codelineno-63-182" href="#__codelineno-63-182"></a>    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
<a id="__codelineno-63-183" name="__codelineno-63-183" href="#__codelineno-63-183"></a>        <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Welcome admin!&#39;</span><span class="p">,</span>
<a id="__codelineno-63-184" name="__codelineno-63-184" href="#__codelineno-63-184"></a>        <span class="s1">&#39;admin_data&#39;</span><span class="p">:</span> <span class="s1">&#39;sensitive information&#39;</span>
<a id="__codelineno-63-185" name="__codelineno-63-185" href="#__codelineno-63-185"></a>    <span class="p">}),</span> <span class="mi">200</span>
<a id="__codelineno-63-186" name="__codelineno-63-186" href="#__codelineno-63-186"></a>
<a id="__codelineno-63-187" name="__codelineno-63-187" href="#__codelineno-63-187"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/api/refresh&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-63-188" name="__codelineno-63-188" href="#__codelineno-63-188"></a><span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">():</span>
<a id="__codelineno-63-189" name="__codelineno-63-189" href="#__codelineno-63-189"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Refresh token endpoint&quot;&quot;&quot;</span>
<a id="__codelineno-63-190" name="__codelineno-63-190" href="#__codelineno-63-190"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
<a id="__codelineno-63-191" name="__codelineno-63-191" href="#__codelineno-63-191"></a>    <span class="n">old_token</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
<a id="__codelineno-63-192" name="__codelineno-63-192" href="#__codelineno-63-192"></a>
<a id="__codelineno-63-193" name="__codelineno-63-193" href="#__codelineno-63-193"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">old_token</span><span class="p">:</span>
<a id="__codelineno-63-194" name="__codelineno-63-194" href="#__codelineno-63-194"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Token is required&#39;</span><span class="p">}),</span> <span class="mi">400</span>
<a id="__codelineno-63-195" name="__codelineno-63-195" href="#__codelineno-63-195"></a>
<a id="__codelineno-63-196" name="__codelineno-63-196" href="#__codelineno-63-196"></a>    <span class="c1"># Generate new token from old one</span>
<a id="__codelineno-63-197" name="__codelineno-63-197" href="#__codelineno-63-197"></a>    <span class="n">new_token</span> <span class="o">=</span> <span class="n">jwt_manager</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">(</span><span class="n">old_token</span><span class="p">,</span> <span class="n">expires_in</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
<a id="__codelineno-63-198" name="__codelineno-63-198" href="#__codelineno-63-198"></a>
<a id="__codelineno-63-199" name="__codelineno-63-199" href="#__codelineno-63-199"></a>    <span class="k">if</span> <span class="n">new_token</span><span class="p">:</span>
<a id="__codelineno-63-200" name="__codelineno-63-200" href="#__codelineno-63-200"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span>
<a id="__codelineno-63-201" name="__codelineno-63-201" href="#__codelineno-63-201"></a>            <span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="s1">&#39;Token refreshed&#39;</span><span class="p">,</span>
<a id="__codelineno-63-202" name="__codelineno-63-202" href="#__codelineno-63-202"></a>            <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="n">new_token</span><span class="p">,</span>
<a id="__codelineno-63-203" name="__codelineno-63-203" href="#__codelineno-63-203"></a>            <span class="s1">&#39;expires_in&#39;</span><span class="p">:</span> <span class="mi">3600</span>
<a id="__codelineno-63-204" name="__codelineno-63-204" href="#__codelineno-63-204"></a>        <span class="p">}),</span> <span class="mi">200</span>
<a id="__codelineno-63-205" name="__codelineno-63-205" href="#__codelineno-63-205"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-63-206" name="__codelineno-63-206" href="#__codelineno-63-206"></a>        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;Invalid or expired token&#39;</span><span class="p">}),</span> <span class="mi">401</span>
<a id="__codelineno-63-207" name="__codelineno-63-207" href="#__codelineno-63-207"></a>
<a id="__codelineno-63-208" name="__codelineno-63-208" href="#__codelineno-63-208"></a><span class="c1"># Manual JWT Creation (Understanding the internals)</span>
<a id="__codelineno-63-209" name="__codelineno-63-209" href="#__codelineno-63-209"></a><span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<a id="__codelineno-63-210" name="__codelineno-63-210" href="#__codelineno-63-210"></a><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<a id="__codelineno-63-211" name="__codelineno-63-211" href="#__codelineno-63-211"></a>
<a id="__codelineno-63-212" name="__codelineno-63-212" href="#__codelineno-63-212"></a><span class="k">def</span><span class="w"> </span><span class="nf">manual_jwt_create</span><span class="p">(</span><span class="n">payload</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">secret</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-63-213" name="__codelineno-63-213" href="#__codelineno-63-213"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Manual JWT creation to understand the process&quot;&quot;&quot;</span>
<a id="__codelineno-63-214" name="__codelineno-63-214" href="#__codelineno-63-214"></a>
<a id="__codelineno-63-215" name="__codelineno-63-215" href="#__codelineno-63-215"></a>    <span class="c1"># 1. Create header</span>
<a id="__codelineno-63-216" name="__codelineno-63-216" href="#__codelineno-63-216"></a>    <span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-63-217" name="__codelineno-63-217" href="#__codelineno-63-217"></a>        <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;HS256&quot;</span><span class="p">,</span>
<a id="__codelineno-63-218" name="__codelineno-63-218" href="#__codelineno-63-218"></a>        <span class="s2">&quot;typ&quot;</span><span class="p">:</span> <span class="s2">&quot;JWT&quot;</span>
<a id="__codelineno-63-219" name="__codelineno-63-219" href="#__codelineno-63-219"></a>    <span class="p">}</span>
<a id="__codelineno-63-220" name="__codelineno-63-220" href="#__codelineno-63-220"></a>
<a id="__codelineno-63-221" name="__codelineno-63-221" href="#__codelineno-63-221"></a>    <span class="c1"># 2. Encode header and payload</span>
<a id="__codelineno-63-222" name="__codelineno-63-222" href="#__codelineno-63-222"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">base64url_encode</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-63-223" name="__codelineno-63-223" href="#__codelineno-63-223"></a>        <span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span>
<a id="__codelineno-63-224" name="__codelineno-63-224" href="#__codelineno-63-224"></a>        <span class="n">encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">json_str</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
<a id="__codelineno-63-225" name="__codelineno-63-225" href="#__codelineno-63-225"></a>        <span class="k">return</span> <span class="n">encoded</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>  <span class="c1"># Remove padding</span>
<a id="__codelineno-63-226" name="__codelineno-63-226" href="#__codelineno-63-226"></a>
<a id="__codelineno-63-227" name="__codelineno-63-227" href="#__codelineno-63-227"></a>    <span class="n">header_encoded</span> <span class="o">=</span> <span class="n">base64url_encode</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
<a id="__codelineno-63-228" name="__codelineno-63-228" href="#__codelineno-63-228"></a>    <span class="n">payload_encoded</span> <span class="o">=</span> <span class="n">base64url_encode</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
<a id="__codelineno-63-229" name="__codelineno-63-229" href="#__codelineno-63-229"></a>
<a id="__codelineno-63-230" name="__codelineno-63-230" href="#__codelineno-63-230"></a>    <span class="c1"># 3. Create signature</span>
<a id="__codelineno-63-231" name="__codelineno-63-231" href="#__codelineno-63-231"></a>    <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header_encoded</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">payload_encoded</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-63-232" name="__codelineno-63-232" href="#__codelineno-63-232"></a>    <span class="n">signature</span> <span class="o">=</span> <span class="n">hmac</span><span class="o">.</span><span class="n">new</span><span class="p">(</span>
<a id="__codelineno-63-233" name="__codelineno-63-233" href="#__codelineno-63-233"></a>        <span class="n">secret</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
<a id="__codelineno-63-234" name="__codelineno-63-234" href="#__codelineno-63-234"></a>        <span class="n">message</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span>
<a id="__codelineno-63-235" name="__codelineno-63-235" href="#__codelineno-63-235"></a>        <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span>
<a id="__codelineno-63-236" name="__codelineno-63-236" href="#__codelineno-63-236"></a>    <span class="p">)</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
<a id="__codelineno-63-237" name="__codelineno-63-237" href="#__codelineno-63-237"></a>    <span class="n">signature_encoded</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">signature</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
<a id="__codelineno-63-238" name="__codelineno-63-238" href="#__codelineno-63-238"></a>
<a id="__codelineno-63-239" name="__codelineno-63-239" href="#__codelineno-63-239"></a>    <span class="c1"># 4. Combine all parts</span>
<a id="__codelineno-63-240" name="__codelineno-63-240" href="#__codelineno-63-240"></a>    <span class="n">jwt_token</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">header_encoded</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">payload_encoded</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">signature_encoded</span><span class="si">}</span><span class="s2">&quot;</span>
<a id="__codelineno-63-241" name="__codelineno-63-241" href="#__codelineno-63-241"></a>
<a id="__codelineno-63-242" name="__codelineno-63-242" href="#__codelineno-63-242"></a>    <span class="k">return</span> <span class="n">jwt_token</span>
<a id="__codelineno-63-243" name="__codelineno-63-243" href="#__codelineno-63-243"></a>
<a id="__codelineno-63-244" name="__codelineno-63-244" href="#__codelineno-63-244"></a><span class="c1"># Usage Example</span>
<a id="__codelineno-63-245" name="__codelineno-63-245" href="#__codelineno-63-245"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-63-246" name="__codelineno-63-246" href="#__codelineno-63-246"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-63-247" name="__codelineno-63-247" href="#__codelineno-63-247"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JWT Authentication Example&quot;</span><span class="p">)</span>
<a id="__codelineno-63-248" name="__codelineno-63-248" href="#__codelineno-63-248"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<a id="__codelineno-63-249" name="__codelineno-63-249" href="#__codelineno-63-249"></a>
<a id="__codelineno-63-250" name="__codelineno-63-250" href="#__codelineno-63-250"></a>    <span class="c1"># Initialize JWT manager</span>
<a id="__codelineno-63-251" name="__codelineno-63-251" href="#__codelineno-63-251"></a>    <span class="n">jwt_mgr</span> <span class="o">=</span> <span class="n">JWTManager</span><span class="p">(</span><span class="n">secret_key</span><span class="o">=</span><span class="s1">&#39;my-super-secret-key&#39;</span><span class="p">)</span>
<a id="__codelineno-63-252" name="__codelineno-63-252" href="#__codelineno-63-252"></a>
<a id="__codelineno-63-253" name="__codelineno-63-253" href="#__codelineno-63-253"></a>    <span class="c1"># 1. Generate token</span>
<a id="__codelineno-63-254" name="__codelineno-63-254" href="#__codelineno-63-254"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">1. Generating JWT token...&quot;</span><span class="p">)</span>
<a id="__codelineno-63-255" name="__codelineno-63-255" href="#__codelineno-63-255"></a>    <span class="n">token</span> <span class="o">=</span> <span class="n">jwt_mgr</span><span class="o">.</span><span class="n">generate_token</span><span class="p">(</span>
<a id="__codelineno-63-256" name="__codelineno-63-256" href="#__codelineno-63-256"></a>        <span class="n">user_id</span><span class="o">=</span><span class="s1">&#39;user123&#39;</span><span class="p">,</span>
<a id="__codelineno-63-257" name="__codelineno-63-257" href="#__codelineno-63-257"></a>        <span class="n">username</span><span class="o">=</span><span class="s1">&#39;john_doe&#39;</span><span class="p">,</span>
<a id="__codelineno-63-258" name="__codelineno-63-258" href="#__codelineno-63-258"></a>        <span class="n">role</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span>
<a id="__codelineno-63-259" name="__codelineno-63-259" href="#__codelineno-63-259"></a>        <span class="n">expires_in</span><span class="o">=</span><span class="mi">3600</span>
<a id="__codelineno-63-260" name="__codelineno-63-260" href="#__codelineno-63-260"></a>    <span class="p">)</span>
<a id="__codelineno-63-261" name="__codelineno-63-261" href="#__codelineno-63-261"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Token: </span><span class="si">{</span><span class="n">token</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-63-262" name="__codelineno-63-262" href="#__codelineno-63-262"></a>
<a id="__codelineno-63-263" name="__codelineno-63-263" href="#__codelineno-63-263"></a>    <span class="c1"># 2. Verify token</span>
<a id="__codelineno-63-264" name="__codelineno-63-264" href="#__codelineno-63-264"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">2. Verifying token...&quot;</span><span class="p">)</span>
<a id="__codelineno-63-265" name="__codelineno-63-265" href="#__codelineno-63-265"></a>    <span class="n">payload</span> <span class="o">=</span> <span class="n">jwt_mgr</span><span class="o">.</span><span class="n">verify_token</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
<a id="__codelineno-63-266" name="__codelineno-63-266" href="#__codelineno-63-266"></a>    <span class="k">if</span> <span class="n">payload</span><span class="p">:</span>
<a id="__codelineno-63-267" name="__codelineno-63-267" href="#__codelineno-63-267"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Token is valid!&quot;</span><span class="p">)</span>
<a id="__codelineno-63-268" name="__codelineno-63-268" href="#__codelineno-63-268"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User ID: </span><span class="si">{</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;sub&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-63-269" name="__codelineno-63-269" href="#__codelineno-63-269"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Username: </span><span class="si">{</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-63-270" name="__codelineno-63-270" href="#__codelineno-63-270"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Role: </span><span class="si">{</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;role&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-63-271" name="__codelineno-63-271" href="#__codelineno-63-271"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expires: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">payload</span><span class="p">[</span><span class="s1">&#39;exp&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-63-272" name="__codelineno-63-272" href="#__codelineno-63-272"></a>
<a id="__codelineno-63-273" name="__codelineno-63-273" href="#__codelineno-63-273"></a>    <span class="c1"># 3. Manual JWT creation</span>
<a id="__codelineno-63-274" name="__codelineno-63-274" href="#__codelineno-63-274"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">3. Manual JWT creation (understanding internals)...&quot;</span><span class="p">)</span>
<a id="__codelineno-63-275" name="__codelineno-63-275" href="#__codelineno-63-275"></a>    <span class="n">manual_payload</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-63-276" name="__codelineno-63-276" href="#__codelineno-63-276"></a>        <span class="s1">&#39;sub&#39;</span><span class="p">:</span> <span class="s1">&#39;user123&#39;</span><span class="p">,</span>
<a id="__codelineno-63-277" name="__codelineno-63-277" href="#__codelineno-63-277"></a>        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;John Doe&#39;</span><span class="p">,</span>
<a id="__codelineno-63-278" name="__codelineno-63-278" href="#__codelineno-63-278"></a>        <span class="s1">&#39;iat&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">timestamp</span><span class="p">())</span>
<a id="__codelineno-63-279" name="__codelineno-63-279" href="#__codelineno-63-279"></a>    <span class="p">}</span>
<a id="__codelineno-63-280" name="__codelineno-63-280" href="#__codelineno-63-280"></a>    <span class="n">manual_token</span> <span class="o">=</span> <span class="n">manual_jwt_create</span><span class="p">(</span><span class="n">manual_payload</span><span class="p">,</span> <span class="s1">&#39;my-secret&#39;</span><span class="p">)</span>
<a id="__codelineno-63-281" name="__codelineno-63-281" href="#__codelineno-63-281"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Manual Token: </span><span class="si">{</span><span class="n">manual_token</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<a id="__codelineno-63-282" name="__codelineno-63-282" href="#__codelineno-63-282"></a>
<a id="__codelineno-63-283" name="__codelineno-63-283" href="#__codelineno-63-283"></a>    <span class="c1"># 4. Start Flask app</span>
<a id="__codelineno-63-284" name="__codelineno-63-284" href="#__codelineno-63-284"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">4. Starting Flask API server...&quot;</span><span class="p">)</span>
<a id="__codelineno-63-285" name="__codelineno-63-285" href="#__codelineno-63-285"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Endpoints:&quot;</span><span class="p">)</span>
<a id="__codelineno-63-286" name="__codelineno-63-286" href="#__codelineno-63-286"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  POST   /api/login      - Get JWT token&quot;</span><span class="p">)</span>
<a id="__codelineno-63-287" name="__codelineno-63-287" href="#__codelineno-63-287"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  GET    /api/protected  - Access with token&quot;</span><span class="p">)</span>
<a id="__codelineno-63-288" name="__codelineno-63-288" href="#__codelineno-63-288"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  GET    /api/admin      - Admin only&quot;</span><span class="p">)</span>
<a id="__codelineno-63-289" name="__codelineno-63-289" href="#__codelineno-63-289"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  POST   /api/refresh    - Refresh token&quot;</span><span class="p">)</span>
<a id="__codelineno-63-290" name="__codelineno-63-290" href="#__codelineno-63-290"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Example request:&quot;</span><span class="p">)</span>
<a id="__codelineno-63-291" name="__codelineno-63-291" href="#__codelineno-63-291"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  curl -X POST http://localhost:5000/api/login </span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-63-292" name="__codelineno-63-292" href="#__codelineno-63-292"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;       -H &quot;Content-Type: application/json&quot; </span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-63-293" name="__codelineno-63-293" href="#__codelineno-63-293"></a>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;       -d </span><span class="se">\&#39;</span><span class="s1">{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;password123&quot;}</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-63-294" name="__codelineno-63-294" href="#__codelineno-63-294"></a>
<a id="__codelineno-63-295" name="__codelineno-63-295" href="#__codelineno-63-295"></a>    <span class="c1"># app.run(debug=True, port=5000)</span>
</code></pre></div>
<h4 id="jwt-best-practices">JWT Best Practices</h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a> DO:
<a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>
<a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>1. Use HTTPS Only
<a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>   - Never send JWT over unencrypted connections
<a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>
<a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>2. Keep Tokens Short-Lived
<a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>   - Access token: 15 minutes - 1 hour
<a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>   - Use refresh tokens for longer sessions
<a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>
<a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>3. Use Strong Secret Keys
<a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>   - Minimum 256 bits for HS256
<a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a>   - Use cryptographically random values
<a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a>
<a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>4. Validate All Claims
<a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a>   - exp (expiration)
<a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a>   - iat (issued at)
<a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a>   - nbf (not before)
<a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a>   - aud (audience)
<a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a>   - iss (issuer)
<a id="__codelineno-64-20" name="__codelineno-64-20" href="#__codelineno-64-20"></a>
<a id="__codelineno-64-21" name="__codelineno-64-21" href="#__codelineno-64-21"></a>5. Use Appropriate Algorithm
<a id="__codelineno-64-22" name="__codelineno-64-22" href="#__codelineno-64-22"></a>   - HS256: Symmetric (shared secret)
<a id="__codelineno-64-23" name="__codelineno-64-23" href="#__codelineno-64-23"></a>   - RS256: Asymmetric (public/private key)
<a id="__codelineno-64-24" name="__codelineno-64-24" href="#__codelineno-64-24"></a>
<a id="__codelineno-64-25" name="__codelineno-64-25" href="#__codelineno-64-25"></a>6. Store Securely
<a id="__codelineno-64-26" name="__codelineno-64-26" href="#__codelineno-64-26"></a>   - HttpOnly cookies (XSS protection)
<a id="__codelineno-64-27" name="__codelineno-64-27" href="#__codelineno-64-27"></a>   - Or secure storage (not localStorage for sensitive data)
<a id="__codelineno-64-28" name="__codelineno-64-28" href="#__codelineno-64-28"></a>
<a id="__codelineno-64-29" name="__codelineno-64-29" href="#__codelineno-64-29"></a> DON&#39;T:
<a id="__codelineno-64-30" name="__codelineno-64-30" href="#__codelineno-64-30"></a>
<a id="__codelineno-64-31" name="__codelineno-64-31" href="#__codelineno-64-31"></a>1. Store Sensitive Data in Payload
<a id="__codelineno-64-32" name="__codelineno-64-32" href="#__codelineno-64-32"></a>   - JWT payload is NOT encrypted, only encoded
<a id="__codelineno-64-33" name="__codelineno-64-33" href="#__codelineno-64-33"></a>   - Anyone can decode and read it
<a id="__codelineno-64-34" name="__codelineno-64-34" href="#__codelineno-64-34"></a>
<a id="__codelineno-64-35" name="__codelineno-64-35" href="#__codelineno-64-35"></a>2. Use for Sessions with Immediate Revocation
<a id="__codelineno-64-36" name="__codelineno-64-36" href="#__codelineno-64-36"></a>   - Cannot revoke JWT until expiration
<a id="__codelineno-64-37" name="__codelineno-64-37" href="#__codelineno-64-37"></a>   - Use session tokens if need instant revocation
<a id="__codelineno-64-38" name="__codelineno-64-38" href="#__codelineno-64-38"></a>
<a id="__codelineno-64-39" name="__codelineno-64-39" href="#__codelineno-64-39"></a>3. Make Tokens Too Long-Lived
<a id="__codelineno-64-40" name="__codelineno-64-40" href="#__codelineno-64-40"></a>   - Higher risk if compromised
<a id="__codelineno-64-41" name="__codelineno-64-41" href="#__codelineno-64-41"></a>
<a id="__codelineno-64-42" name="__codelineno-64-42" href="#__codelineno-64-42"></a>4. Use Weak Secrets
<a id="__codelineno-64-43" name="__codelineno-64-43" href="#__codelineno-64-43"></a>   - &quot;secret&quot;, &quot;password123&quot;, etc.
<a id="__codelineno-64-44" name="__codelineno-64-44" href="#__codelineno-64-44"></a>
<a id="__codelineno-64-45" name="__codelineno-64-45" href="#__codelineno-64-45"></a>5. Ignore Token Validation
<a id="__codelineno-64-46" name="__codelineno-64-46" href="#__codelineno-64-46"></a>   - Always verify signature
<a id="__codelineno-64-47" name="__codelineno-64-47" href="#__codelineno-64-47"></a>   - Always check expiration
<a id="__codelineno-64-48" name="__codelineno-64-48" href="#__codelineno-64-48"></a>
<a id="__codelineno-64-49" name="__codelineno-64-49" href="#__codelineno-64-49"></a>6. Mix Authentication and Authorization Data
<a id="__codelineno-64-50" name="__codelineno-64-50" href="#__codelineno-64-50"></a>   - Keep JWTs focused
</code></pre></div>
<p><strong>JWT Security Considerations:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>COMMON VULNERABILITIES:
<a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>
<a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>
<a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>1. None Algorithm Attack
<a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>    {&quot;alg&quot;: &quot;none&quot;, &quot;typ&quot;: &quot;JWT&quot;}
<a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>    Always validate algorithm
<a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>
<a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>2. Algorithm Confusion
<a id="__codelineno-65-9" name="__codelineno-65-9" href="#__codelineno-65-9"></a>    Accepting both HS256 and RS256
<a id="__codelineno-65-10" name="__codelineno-65-10" href="#__codelineno-65-10"></a>    Enforce specific algorithm
<a id="__codelineno-65-11" name="__codelineno-65-11" href="#__codelineno-65-11"></a>
<a id="__codelineno-65-12" name="__codelineno-65-12" href="#__codelineno-65-12"></a>3. Weak Secret Keys
<a id="__codelineno-65-13" name="__codelineno-65-13" href="#__codelineno-65-13"></a>    &quot;secret&quot;, &quot;12345&quot;
<a id="__codelineno-65-14" name="__codelineno-65-14" href="#__codelineno-65-14"></a>    Use strong, random keys (256+ bits)
<a id="__codelineno-65-15" name="__codelineno-65-15" href="#__codelineno-65-15"></a>
<a id="__codelineno-65-16" name="__codelineno-65-16" href="#__codelineno-65-16"></a>4. No Expiration Validation
<a id="__codelineno-65-17" name="__codelineno-65-17" href="#__codelineno-65-17"></a>    Ignoring &#39;exp&#39; claim
<a id="__codelineno-65-18" name="__codelineno-65-18" href="#__codelineno-65-18"></a>    Always check expiration
<a id="__codelineno-65-19" name="__codelineno-65-19" href="#__codelineno-65-19"></a>
<a id="__codelineno-65-20" name="__codelineno-65-20" href="#__codelineno-65-20"></a>5. Token Leakage
<a id="__codelineno-65-21" name="__codelineno-65-21" href="#__codelineno-65-21"></a>    Logging tokens, storing in localStorage
<a id="__codelineno-65-22" name="__codelineno-65-22" href="#__codelineno-65-22"></a>    Use HttpOnly cookies, secure storage
<a id="__codelineno-65-23" name="__codelineno-65-23" href="#__codelineno-65-23"></a>
<a id="__codelineno-65-24" name="__codelineno-65-24" href="#__codelineno-65-24"></a>6. Replay Attacks
<a id="__codelineno-65-25" name="__codelineno-65-25" href="#__codelineno-65-25"></a>    No unique identifier per token
<a id="__codelineno-65-26" name="__codelineno-65-26" href="#__codelineno-65-26"></a>    Use &#39;jti&#39; (JWT ID) claim
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2025 <a href="https://github.com/abhishekghoshh"  target="_blank" rel="noopener">Abhishek Ghosh</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/abhishekghoshh" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/abhishek_ghoshh" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/abhishek-ghosh-220679132/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>